1
00:02:19,950 --> 00:02:29,710
so da bin ich omega pock ich bin ja ich will nach dem im ort nicht suchen weil

2
00:02:29,710 --> 00:02:34,270
im zweifelsfall gibt es das auch natürlich gibt es omega pock was was

3
00:02:34,270 --> 00:02:38,530
was denke ich mir selbstverständlich gibt es omega pock so ziemlich alle

4
00:02:38,530 --> 00:02:42,530
emotes die ich mir so kurz oder fly ausdenken kann ist schon jemand drauf

5
00:02:42,530 --> 00:02:56,270
gekommen omega pock ggg aktiviert auch ein sehr

6
00:02:56,270 --> 00:03:00,850
beliebtes im ort wir haben glaube ich ich wurde und

7
00:03:00,850 --> 00:03:06,030
scheiße wir haben so unglaublich viele keck emotes das hört gar nicht mehr aus

8
00:03:06,030 --> 00:03:10,590
der ist auch nicht schnell business business muss sagen die sind

9
00:03:10,590 --> 00:03:18,340
eigentlich alle gut javascript auch nichts

10
00:03:18,340 --> 00:03:23,860
vergessen und das ist der twitch versuch keck w nachzumachen das hat

11
00:03:23,860 --> 00:03:33,980
nicht wirklich geklappt naja so jetzt waren wir ja so ein bisschen

12
00:03:33,980 --> 00:03:38,000
riemen richtig angelaufen ist und dann zeige ich dann erst nicht zeigen auch

13
00:03:38,000 --> 00:03:42,800
aber dann erzähle ich euch mal was wir werden heute etwas was kleines machen

14
00:03:42,800 --> 00:03:46,100
nicht ganz so kompliziert hoffe ich zumindest dass es nicht ganz so

15
00:03:46,100 --> 00:03:58,120
kompliziert ist ein bisschen mal ein bisschen was anderes

16
00:03:58,120 --> 00:04:08,030
ja beach beach music das muss jetzt

17
00:04:08,030 --> 00:04:25,620
sein passt optimal exzellent passt exquisit und wie war das mit wärmster

18
00:04:25,620 --> 00:04:33,040
september aller zeiten november ja heute habe roxy gseto danke

19
00:04:33,040 --> 00:04:37,880
für den sab dr pro noob sport gar kein nur halb park ans trinken ich habe es

20
00:04:37,880 --> 00:04:42,280
wenn es ab eine subscription gewesen aber bisher noch subscribe trinken habe

21
00:04:42,280 --> 00:04:46,620
ich hier steht ich bin auch schlau ich habe mir hier neue wasserflasche trinken

22
00:04:46,620 --> 00:04:47,340
hier stehen aber ich bin auch schlau ich habe hier wasserflasche trinken hier stehen

23
00:04:47,340 --> 00:04:47,440
aber ich bin auch schlau ich habe hier wasserflasche trinken hier stehen aber

24
00:04:47,500 --> 00:04:51,000
ich habe kein glas mit gut muss ich also das ist eine plastikflasche trinkt

25
00:04:51,000 --> 00:04:54,880
ich ungern raus aber immerhin für heute geht es unter daniel wieder am start

26
00:04:54,880 --> 00:05:05,380
daniel lul lul hd 3d für die saps leute ja und zwar ich schalte mal ich schalte

27
00:05:05,380 --> 00:05:10,440
man die vm an das wird das wird etwas kurzes knackiges denke ich war es ist

28
00:05:10,440 --> 00:05:14,620
schon 20 23 10 uhr spätestens muss ich wieder pennen deswegen müssen wir als

29
00:05:14,620 --> 00:05:17,340
bastel champ machen ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja

30
00:05:17,340 --> 00:05:52,590
ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja

31
00:05:52,590 --> 00:06:00,450
dass die kategorie hier besser ist glaubt ich glaube die kategorie hier ist besser erst mal

32
00:06:00,450 --> 00:06:07,110
erst mal absehen ja also ich erzähle euch jetzt einfach was und zwar bei uns auf der arbeit wir

33
00:06:07,110 --> 00:06:13,890
machen ja in letzter zeit relativ viele hipster block chain zeug und jetzt haltet euch mal fest

34
00:06:13,890 --> 00:06:21,380
haltet euch mal fest ich weiß gar nicht wo ich am besten anfangen anfange zu erzählen also ich

35
00:06:21,380 --> 00:06:26,900
habe euch ja schon erzählt dass das selbst betreiben diverser crypto block chain notes

36
00:06:26,900 --> 00:06:34,940
ziemlich pain in gachi bus ist also das ziemlich ziemlich von arsch ist die software ist übelst

37
00:06:34,940 --> 00:06:42,800
buggy das kackt ab die so übelst langsam und gerade gerade polygon notes sind ganz abartig

38
00:06:42,800 --> 00:06:50,360
zumindest zumindest sie sind jetzt sie sind es auf die glorreiche idee gekommen bzw ich glaube

39
00:06:50,360 --> 00:06:51,360
gar nicht dass sie wirklich auch

40
00:06:51,360 --> 00:06:58,680
die idee gekommen sind ich glaube ein eine eine sehr gute wie heißt das wie nennen die sich sales

41
00:06:58,680 --> 00:07:04,500
abteilung oder die die leute was verkaufen wollen hat ihn versucht das aufzuschätzen und zwar haben

42
00:07:04,500 --> 00:07:13,530
sie sich überlegt ob sie sich ja block chain ist bei design langsam ist die frage bei was langsam

43
00:07:13,530 --> 00:07:22,410
ja bei was zumindest war irgend so eine tolle sales abteilung hat irgendwie war was vorgestellt

44
00:07:22,410 --> 00:07:24,250
starbucks danke für den start

45
00:07:24,270 --> 00:07:30,690
wir fangen wir fangen gleich an und irgendwie sind sie jetzt was ist denn cia mu wird sowieso

46
00:07:30,690 --> 00:07:37,550
das so gtk teams einpassen zumindest selbst jetzt auf die glorreiche idee gekommen sie wollen sich

47
00:07:37,550 --> 00:07:42,730
also weil das so schwierig ist eigene eigene chlorpoints zu betreiben und die immer mal

48
00:07:42,730 --> 00:07:48,030
probleme machen wollen sie sich jetzt eine block ist haltet euch halt euch fest leute halten kann

49
00:07:48,030 --> 00:07:50,190
ein block chain tour surveillance klagenвидet tier

50
00:07:50,190 --> 00:07:50,230
eine lok train load balancer pi ins kinday

51
00:07:50,230 --> 00:07:52,190
die euch aufketzten angst nicht die dust entertainment

52
00:07:52,190 --> 00:07:58,410
load balancer appliance kaufen von den herstellern sage ich euch nicht von dem

53
00:07:58,410 --> 00:08:02,630
hersteller hat niemand irgendwas gehört bisher die machen ansonsten nix

54
00:08:02,630 --> 00:08:08,590
wahrscheinlich irgendwie startup eine also quasi eine premium block chain load

55
00:08:08,590 --> 00:08:17,430
balancer appliance die irgendwie ab 50.000 euro losgeht so und und jetzt

56
00:08:17,430 --> 00:08:21,410
haltet euch mal fest für was sie die benutzen wollen es ist es ist es ist

57
00:08:21,410 --> 00:08:24,730
blödsinn deluxe aber jetzt haltet euch mal fest für für was sie die benutzen

58
00:08:24,730 --> 00:08:32,630
wollen es blickser danke für den sub die wollen man angenommen man hat ja 67 wie

59
00:08:32,630 --> 00:08:37,490
auch immer verschiedene nodes für eine spezielle block chain ist egal was es ist

60
00:08:37,490 --> 00:08:41,870
ja nehmen wir mal polygon weil polygon ist recht recht beliebt in der richtung

61
00:08:41,870 --> 00:08:47,530
da und jetzt kommt es ja vor dass manche nodes mal out of sync gehen weil die

62
00:08:47,530 --> 00:08:51,390
software scheiße ist und buggy ist ja mal out of sync gehen

63
00:08:51,390 --> 00:08:57,390
dass die das pudel给ena nick ist so verknüttelt dass sie das die nuts maar

64
00:08:57,390 --> 00:09:03,930
brechen dass man was bei maintenance neu gestartet werden muss umso was und jetzt

65
00:09:03,930 --> 00:09:08,610
könnte man ja einfach auf die idee komme man machte einen ganz normalen路

66
00:09:08,610 --> 00:09:13,190
balancer vor und der fackel das ganze ab was ein normaler load balancer

67
00:09:13,190 --> 00:09:20,510
allerdings nicht kann ist die ap endpunkte dieser notes abzufragen und zu

68
00:09:20,510 --> 00:09:26,810
welcher note der neueste ist weil wie gesagt die sünden sich alle und manche

69
00:09:26,810 --> 00:09:31,310
sind ein bisschen schneller gesunken als andere ja also einer der notes ist halt

70
00:09:31,310 --> 00:09:35,730
der der den aktuellsten stand hat oftmals oder unser mama sagen wir 123

71
00:09:35,730 --> 00:09:39,650
not sind relativ aktuell manche hinten dran und diese super krasse premium

72
00:09:39,650 --> 00:09:45,450
load balancer appliance die kann halt die api endpunkte abfragen und dort

73
00:09:45,450 --> 00:09:50,970
checken quasi wie weit welcher not gesünd ist und da habe ich gesagt leute

74
00:09:50,970 --> 00:10:00,010
ganz im ernst ob es laut irgendwie habe ich das leute ganz im ernst ja wenn wir

75
00:10:00,010 --> 00:10:05,350
sowas haben wollen da müssen wir uns doch keine 50.000 euro premium block

76
00:10:05,350 --> 00:10:10,390
chain load balancer appliance kaufen da stellen wir eine proxy hin machen drei

77
00:10:10,390 --> 00:10:19,080
zeilen best script als health check und dann funktioniert das auch und ich

78
00:10:19,080 --> 00:10:26,800
habe mir gedacht ich teste jetzt mal im stream ob an der aussage überhaupt was

79
00:10:26,800 --> 00:10:32,880
dran ist ob das wirklich nur drei zeilen best script sind okay da so wenn es 20

80
00:10:32,880 --> 00:10:38,560
zeilen best script sind ist auch okay und proxys und proxys konflikt schreibe

81
00:10:38,560 --> 00:10:40,960
ich jetzt auch nicht einfach runter macht zu selten was dafür

82
00:10:40,960 --> 00:10:45,520
das wollte ich mal ausbringen aber von der idee her von der idee her muss das

83
00:10:45,520 --> 00:10:48,680
super simpel sein wir machen und custom health check

84
00:10:48,680 --> 00:10:54,080
in dem custom health check fragen wir die api endpunkte das machen wir jetzt

85
00:10:54,080 --> 00:10:59,840
so quasi wir bauen jetzt keine block chain sachen auf wir machen ein paar endpunkte

86
00:10:59,840 --> 00:11:04,640
die unterschiedliche werte liefern und da gucken wir welche so der health check

87
00:11:04,640 --> 00:11:09,120
fragt einfach alle unterschiedlichen api endpunkte ab sortiert die nach dem

88
00:11:09,120 --> 00:11:15,240
höchsten block und die api response mit dem höchsten block die wird halt

89
00:11:15,240 --> 00:11:18,400
selected im health check für kriegt allen traffic

90
00:11:18,680 --> 00:11:22,480
wir können sogar so weit gehen wir können sogar super advanced sein wir

91
00:11:22,480 --> 00:11:27,720
können sogar mehrere aktivieren also und ich wie gesagt ich hab gesagt

92
00:11:27,720 --> 00:11:35,320
leute wir brauchen keine wir brauchen keine 50 ja ich weiß nicht ob ha proxy

93
00:11:35,320 --> 00:11:38,520
und zählzeilen best script business enterprise genug sind

94
00:11:38,520 --> 00:11:44,680
ganz ehrlich die sollen die 50.000 euro lieber mir geben oder zwischen den

95
00:11:44,680 --> 00:11:51,870
leuten die ein projekt auf mitarbeiten aufteilen anstatt sinnlose sinnlose

96
00:11:51,870 --> 00:11:58,650
appliance zu kaufen die können die können leute ich habe die

97
00:11:58,650 --> 00:12:04,290
idee die sollen mir die 50.000 euro überweisen und dann bezahle ich meine

98
00:12:04,290 --> 00:12:14,000
modgis da gibt es dann gibt es dann modgis gehalt da wirst du mal sehen wir

99
00:12:14,000 --> 00:12:17,300
haben ein paar mods teilweise die waren jetzt irgendwie gefühlt jahre nicht mehr

100
00:12:17,300 --> 00:12:20,600
da da wirst du sehen die spawnen auf einmal wieder sind auf einmal alle sind

101
00:12:20,600 --> 00:12:28,060
sie wieder da so aktuell sind sie immer so die gleichen 45 da kommt doch der

102
00:12:28,060 --> 00:12:31,760
separo wieder her

103
00:12:31,920 --> 00:12:38,500
hat er genug kohle dann da kann er seine referendar grills beeindrucken nicht

104
00:12:38,500 --> 00:12:43,200
trägt 69 lange für den subs blicks aufs blicks abbox aufs krebs studieren

105
00:12:43,200 --> 00:12:49,800
ja jetzt jetzt will ich bloß mal testen ob das ob meine aussage stimmt dass das

106
00:12:49,800 --> 00:12:53,460
ja eigentlich nur ha proxy und zählzeilen best script sind das werden

107
00:12:53,460 --> 00:12:57,660
wir jetzt mal ausprobieren also ziel ist ich ich rekapituliere das

108
00:12:57,660 --> 00:13:03,940
noch mal kurz für euch wir bauen exemplarisch quasi

109
00:13:04,060 --> 00:13:09,340
jetzt wir starten im prinzip drei web server alle drei web server liefern auf

110
00:13:09,340 --> 00:13:14,680
einem api endpunkt die die gleiche response nur mit unterschiedlichen ja

111
00:13:14,680 --> 00:13:23,480
unterschiedlichem stand und dann bauen wir paar zeilen best script health check

112
00:13:23,480 --> 00:13:28,420
in herr proxy der dann den richtigen das richtige back end selected irgendwie so

113
00:13:28,420 --> 00:13:31,380
ich weiß selbst noch nicht genau wie das man beide way wie ich sehe hast du auch

114
00:13:31,380 --> 00:13:35,540
windows 11 ja leider vielleicht kannst du mir helfen ich habe folgendes probleme

115
00:13:35,540 --> 00:13:35,680
vielleicht kannst du mir helfen ich habe folgendes problem ich habe folgendes problem

116
00:13:35,700 --> 00:13:40,260
mit windows 11 wenn die app im hintergrund läuft bzw kann fokus mit

117
00:13:40,260 --> 00:13:40,280
mit windows 11 wenn die app im hintergrund läuft bzw kann fokus mit

118
00:13:40,280 --> 00:13:41,800
mit windows 11 wenn die app im hintergrund läuft bzw kann fokus mit der maus drauf ist läuft die app

119
00:13:41,800 --> 00:13:41,820
der maus drauf ist läuft die app

120
00:13:41,820 --> 00:13:48,480
der maus drauf ist läuft die app nur auf vier von 16 kursen windows magic keine

121
00:13:48,480 --> 00:13:48,500
nur auf vier von 16 kursen windows magic keine

122
00:13:48,500 --> 00:13:51,460
nur auf vier von 16 kursen windows magic keine ahnung ich habe absolut nicht den

123
00:13:51,460 --> 00:13:51,480
ahnung ich habe absolut nicht den

124
00:13:51,480 --> 00:13:54,140
ahnung ich habe absolut nicht den leisen schon mal was da abgeht stimmt

125
00:13:54,140 --> 00:13:54,160
leisen schon mal was da abgeht stimmt

126
00:13:54,160 --> 00:13:56,380
leisen schon mal was da abgeht stimmt irgendwelche energiesparen ab was du

127
00:13:56,380 --> 00:13:56,400
irgendwelche energiesparen ab was du

128
00:13:56,400 --> 00:13:57,420
irgendwelche energiesparen ab was du machen kannst du kannst deine

129
00:13:57,420 --> 00:13:57,440
machen kannst du kannst deine

130
00:13:57,440 --> 00:13:58,940
Energiespar-Settings auf

131
00:13:58,940 --> 00:14:01,100
Performance und Unlimited stellen.

132
00:14:02,540 --> 00:14:04,100
Das müsste

133
00:14:04,100 --> 00:14:04,760
funzen, ja.

134
00:14:07,720 --> 00:14:09,380
Dann geht das wahrscheinlich.

135
00:14:10,680 --> 00:14:11,680
So, also heute

136
00:14:11,680 --> 00:14:13,880
kein krasser IDE-Progress-Stells,

137
00:14:14,340 --> 00:14:15,840
sondern Command-Line-WIM.

138
00:14:16,100 --> 00:14:17,360
Wir machen mal einen neuen Ordner.

139
00:14:17,360 --> 00:14:19,260
Nehmen wir mal Aproxy. Wir machen es auch nicht,

140
00:14:19,340 --> 00:14:20,680
Leute, wir machen es auch nicht

141
00:14:20,680 --> 00:14:22,880
vercontainerisiert. Wir machen das ganz simpel.

142
00:14:22,980 --> 00:14:24,060
Oh, guck mal, ich hab hier einen Snapshot.

143
00:14:24,920 --> 00:14:27,260
Snapshot von was auch immer genau.

144
00:14:27,780 --> 00:14:28,820
Also, ich weiß nicht,

145
00:14:28,820 --> 00:14:31,020
was das hier ist auf dem Vorschau-Bild.

146
00:14:31,840 --> 00:14:33,180
Es ist nicht das, was ihr

147
00:14:33,180 --> 00:14:34,560
eventuell denken könntet.

148
00:14:37,550 --> 00:14:39,890
Man könnte das Vorschau-Bild was reininterpretieren,

149
00:14:40,010 --> 00:14:40,850
aber das ist es nicht.

150
00:14:41,910 --> 00:14:42,550
Weil das

151
00:14:42,550 --> 00:14:45,070
ein Vorschau-Bild von meiner Streaming-VM ist.

152
00:14:45,190 --> 00:14:47,350
Und da geht's nur

153
00:14:49,920 --> 00:14:50,680
löblich zu.

154
00:14:52,680 --> 00:14:53,440
Erstmal löschen.

155
00:14:56,790 --> 00:14:57,450
Für was setzt du den

156
00:14:57,450 --> 00:14:59,290
Aproxy ein? Was ist das Ziel? Kann leider nicht

157
00:14:59,290 --> 00:15:00,590
zurückspulen. Okay.

158
00:15:03,190 --> 00:15:04,390
Ich erklär's nochmal kurz.

159
00:15:06,410 --> 00:15:06,550
Ich

160
00:15:06,550 --> 00:15:07,830
erklär's nochmal kurz.

161
00:15:08,990 --> 00:15:10,590
Ja, die Konfektion-Taxi ist ein bisschen kryptisch.

162
00:15:10,650 --> 00:15:12,050
Ich erklär's nochmal kurz. Also,

163
00:15:12,630 --> 00:15:14,610
bei mir auf der Arbeit wollen sie sich eine 50,

164
00:15:14,730 --> 00:15:16,990
mindestens, mindestens, 50.000

165
00:15:16,990 --> 00:15:17,950
Euro teure

166
00:15:17,950 --> 00:15:21,530
Premium-Blockchain-Loadbalancer-

167
00:15:21,530 --> 00:15:22,490
Appliance kaufen.

168
00:15:24,050 --> 00:15:25,150
Warum das so teuer ist?

169
00:15:25,150 --> 00:15:26,170
Ich hab keine Ahnung.

170
00:15:27,370 --> 00:15:29,610
Was das im Endeffekt macht, ist folgendes.

171
00:15:30,310 --> 00:15:31,370
Das ist ein Loadbalancer,

172
00:15:32,150 --> 00:15:33,090
der

173
00:15:33,090 --> 00:15:35,190
die

174
00:15:35,190 --> 00:15:36,470
API-Endpunkte,

175
00:15:36,550 --> 00:15:38,350
verschiedenster, verschiedenster

176
00:15:38,350 --> 00:15:40,750
Blockchain-Node-Server

177
00:15:40,750 --> 00:15:42,790
abfragen kann, weil man die selbst

178
00:15:42,790 --> 00:15:43,530
hostet, ja.

179
00:15:44,610 --> 00:15:46,210
Und dann

180
00:15:46,210 --> 00:15:48,650
die Nodes, die einen

181
00:15:48,650 --> 00:15:50,590
besonders aktuellen Stand haben,

182
00:15:51,970 --> 00:15:52,530
hauptsächlich

183
00:15:52,530 --> 00:15:53,890
dorthin den Traffic schickt.

184
00:15:55,730 --> 00:15:56,690
Nee, nee, Blockchain ist

185
00:15:56,690 --> 00:16:00,200
voll angesagt. So.

186
00:16:00,580 --> 00:16:02,440
Das ist natürlich eine fertige Lösung mit

187
00:16:02,440 --> 00:16:04,060
einem Web-UI und ganz nice.

188
00:16:04,480 --> 00:16:06,060
Und ich hab heute gesagt, Jungs,

189
00:16:06,860 --> 00:16:08,200
eigentlich total unsinnig,

190
00:16:08,500 --> 00:16:09,540
das Gleiche

191
00:16:09,540 --> 00:16:12,520
mach ich mit HA-Proxy und 10 Zeilen

192
00:16:12,520 --> 00:16:15,960
Bash-Skript. Da können sie mir die

193
00:16:15,960 --> 00:16:17,480
50.000 Euro ja dann überweisen.

194
00:16:17,960 --> 00:16:19,500
Kann ich endlich mal meine Mods bezahlen.

195
00:16:21,360 --> 00:16:21,520
So.

196
00:16:21,960 --> 00:16:24,060
Und ich dachte mir, ich probier das jetzt mal im Stream

197
00:16:24,060 --> 00:16:26,220
aus, ob an meiner Aussage,

198
00:16:26,780 --> 00:16:27,940
dass man das mit

199
00:16:27,940 --> 00:16:29,860
HA-Proxy und 10 Zeilen Bash-Skript

200
00:16:29,860 --> 00:16:31,980
auch lösen kann, was die 50.000 Euro

201
00:16:31,980 --> 00:16:32,760
Appliance kann,

202
00:16:33,900 --> 00:16:35,020
ob da was dran ist.

203
00:16:37,700 --> 00:16:38,180
Beide

204
00:16:38,180 --> 00:16:39,920
Mal, was hältst du vom OpenAI-Beat?

205
00:16:39,940 --> 00:16:42,700
Oh, ich hab's, ich hab heute Morgen

206
00:16:42,700 --> 00:16:44,760
das Beheise gelesen, dass der

207
00:16:44,760 --> 00:16:46,480
Chef und der stellvertretende Chef

208
00:16:46,480 --> 00:16:47,860
irgendwie weggesetzt bei Microsoft.

209
00:16:48,180 --> 00:16:49,660
Microsoft irgendwie allen

210
00:16:49,660 --> 00:16:52,140
OpenAI-Mitarbeitern, die kündigen wollen,

211
00:16:52,560 --> 00:16:54,140
einen Job angeboten hat und irgendwie

212
00:16:54,140 --> 00:16:56,420
ein Drittel oder zwei Drittel der

213
00:16:56,420 --> 00:16:57,800
Belegschaft haben unterschrieben,

214
00:16:58,260 --> 00:17:00,440
dass sie keinen Bock mehr haben, wenn die

215
00:17:00,440 --> 00:17:01,740
nicht den alten Chef zurückholen.

216
00:17:02,180 --> 00:17:02,980
Was auch immer.

217
00:17:03,700 --> 00:17:05,380
Wir werden sehen, wir werden sehen.

218
00:17:05,720 --> 00:17:07,200
Wie findest du Security-Keys?

219
00:17:08,340 --> 00:17:09,940
Das ist jetzt eine äußerst allgemeine

220
00:17:09,940 --> 00:17:10,900
Frage.

221
00:17:12,340 --> 00:17:14,380
Oder meinst du sowas wie YubiKey,

222
00:17:14,380 --> 00:17:15,580
YubiKey und sowas?

223
00:17:15,580 --> 00:17:16,780
Das ist ganz praktisch.

224
00:17:18,180 --> 00:17:19,420
Nein, das geht mit Bash.

225
00:17:19,720 --> 00:17:21,780
Man kann Custom Health-Checks mit Bash machen.

226
00:17:21,780 --> 00:17:22,940
Das habe ich sogar schon gemacht.

227
00:17:24,640 --> 00:17:25,620
Ja, ist eine gute Sache.

228
00:17:26,060 --> 00:17:26,940
Finde ich ist eine gute Sache.

229
00:17:29,820 --> 00:17:31,540
Das probieren wir jetzt, das probieren wir jetzt einfach mal aus.

230
00:17:31,860 --> 00:17:34,080
So, Vince, ich mach mir mal, wie gesagt,

231
00:17:34,080 --> 00:17:36,200
wir vercontainerisieren das

232
00:17:36,200 --> 00:17:37,500
auch gar nicht oder sonst was.

233
00:17:37,760 --> 00:17:39,860
Das ist einfach direkt auf der VM und gut.

234
00:17:39,940 --> 00:17:42,220
Ist jetzt einfach mal Proxy und gut ist.

235
00:17:42,220 --> 00:17:43,440
Man muss es ja nicht übertreiben.

236
00:17:44,900 --> 00:17:47,780
Also ich habe gedacht, unser Setup, unser Setup zum

237
00:17:47,780 --> 00:17:50,080
Testen wird ganz easy.

238
00:17:50,380 --> 00:17:51,580
Ja, wir haben, wir haben nicht.

239
00:17:51,620 --> 00:17:53,180
Wir haben nur eineinhalb Stunden heute Zeit.

240
00:17:53,380 --> 00:17:54,520
Und das wird ganz easy.

241
00:17:54,820 --> 00:17:55,960
Wir machen ein Verzeichnis.

242
00:17:56,200 --> 00:17:58,660
Da kommt eine Proxy Conf rein.

243
00:17:58,840 --> 00:18:02,220
Proxy Conf muss mir gleich minimal Beispiele im Internet suchen,

244
00:18:02,220 --> 00:18:05,320
weil ich, weil ich die immer nicht nicht auf die Reihe kriege.

245
00:18:05,940 --> 00:18:08,980
Und dann machen wir, dann starten wir selber mal zwei Endpunkte.

246
00:18:09,060 --> 00:18:09,380
Reicht.

247
00:18:09,380 --> 00:18:10,960
Wenn man das Lokal mal mit zwei probiert.

248
00:18:11,860 --> 00:18:15,940
Wir machen hier, wir starten, wir starten zwei, zwei HTTP Server.

249
00:18:17,360 --> 00:18:21,260
Ein auf Port 8000 und ein auf Port 8001.

250
00:18:21,780 --> 00:18:22,280
Das machen wir jetzt.

251
00:18:22,280 --> 00:18:30,580
Das machen wir jetzt auch gleich mal nach Port 8000 und nach Port 8001.

252
00:18:30,580 --> 00:18:32,780
Und da drinne HTTP Server.

253
00:18:33,940 --> 00:18:40,700
Da starten wir jetzt ein auf Port 8000 und auf 8000, äh Moment, falsch rum, auf 8000.

254
00:18:40,700 --> 00:18:42,800
Eins und auf 8000.

255
00:18:42,800 --> 00:18:44,540
So, das ist unser Setup.

256
00:18:44,780 --> 00:18:56,380
Aktuell machen die beiden HTTP Server noch nix, außer ein leeres, ein leeres Directory Listing zurückzugeben.

257
00:18:56,840 --> 00:18:58,760
Gibt es da irgendeinen Grund für HA-Proxy?

258
00:18:58,760 --> 00:19:01,520
Ja, ich habe es jetzt schon dreimal erklärt, aber ich erkläre es noch einmal schnell.

259
00:19:02,300 --> 00:19:03,740
Der Stream, Stream fängt ja an.

260
00:19:03,980 --> 00:19:04,900
Was ist das für eine Shell?

261
00:19:04,900 --> 00:19:06,020
Nee, das ist ZSH.

262
00:19:10,420 --> 00:19:11,800
Also ich erkläre es noch mal kurz.

263
00:19:12,040 --> 00:19:15,860
Bei mir auf der Arbeit wollen sie sich eine 50.000 Euro teure,

264
00:19:15,880 --> 00:19:23,200
loadbalancer Appliance kaufen und ich war mal so mutig und habe gesagt, Jungs, warum kaufen wir so einen Schwachsinn?

265
00:19:23,200 --> 00:19:26,540
Das gleiche kann man mit HA-Proxy und 10 Zeilen Bash-Script machen.

266
00:19:26,540 --> 00:19:34,170
Und ich wollte jetzt mal ausprobieren, ob das etwas zu übertrieben war, meine Aussage, oder ob das wirklich geht.

267
00:19:34,170 --> 00:19:38,530
Ich bin mir ziemlich sicher, dass es geht, sonst hätte ich das nicht einfach erzählt.

268
00:19:38,530 --> 00:19:42,640
Nee, das will ich nicht.

269
00:19:42,640 --> 00:19:46,320
Wie gesagt, man kann Custom Bash Healthchecks machen, das weiß ich, das weiß ich.

270
00:19:46,320 --> 00:19:48,700
Habe ich sogar schon gemacht, aber ich weiß aus dem Kopf nicht wie.

271
00:19:48,700 --> 00:19:52,670
Ja, gibt's.

272
00:19:52,670 --> 00:19:53,170
Gibt's.

273
00:19:53,170 --> 00:19:55,670
Aber HA-Proxy ist POG für sowas, finde ich.

274
00:19:57,070 --> 00:19:59,870
Für so, für so Custom-Bastelleien finde ich das HA-Proxy gut.

275
00:19:59,870 --> 00:20:02,330
Also die haben alle seine Vorteile, finde ich.

276
00:20:02,330 --> 00:20:06,630
Cuddy hat der Vorteil, Let's Encrypts integriert und super easy aufzusetzen.

277
00:20:06,630 --> 00:20:09,070
Dafür sind komplizierte Resetups nicht richtig möglich.

278
00:20:09,070 --> 00:20:13,630
Traffic ist gut im Containerisierungsumfeld, hat aber eine abartige Upfuck-Config.

279
00:20:13,630 --> 00:20:16,230
Nginx ist eigentlich so ein schönes Allround-Ding.

280
00:20:16,230 --> 00:20:21,430
Und HA-Proxy finde ich top, wenn man, wenn man, wenn man ein bisschen Custom basteln will.

281
00:20:23,300 --> 00:20:23,800
Nee, ja.

282
00:20:23,800 --> 00:20:24,560
Habe ich mir auch schon gedacht.

283
00:20:24,760 --> 00:20:26,900
Die sollen mir das überweisen, dann kann ich meine Mods bezahlen.

284
00:20:29,160 --> 00:20:30,460
Es ist schon ganz schön wenig, oder?

285
00:20:30,720 --> 00:20:33,040
Dafür gibt's keinen super Premium-Business-Loadbalancer.

286
00:20:33,660 --> 00:20:36,980
Aber wie gesagt, die gehen ab 50.000 Euro los.

287
00:20:37,420 --> 00:20:40,420
Und wahrscheinlich, also das sind ja, das sind ja Hardware-Appliance-Dinger.

288
00:20:41,660 --> 00:20:46,220
Und da, da wird man sich wahrscheinlich auch nicht einkaufen, sondern wahrscheinlich drei oder so.

289
00:20:46,400 --> 00:20:47,920
Also, es ist, es ist unsinnig.

290
00:20:47,960 --> 00:20:48,980
Wir probieren das jetzt mal aus.

291
00:20:48,980 --> 00:20:51,680
Also, ich versuche, ich versuche das Ganze mal nachzustellen.

292
00:20:53,200 --> 00:20:55,220
Also, wir haben zwei, wir haben zwei Backends.

293
00:20:55,240 --> 00:20:57,720
Ja, auf Port 8000 und Port 8001.

294
00:20:58,200 --> 00:21:03,840
So, die Backends, die sollen, ähm, ja, wir tun mal so, als hätten die einen API-Endpunkt.

295
00:21:04,720 --> 00:21:06,880
Und legen jetzt einfach mal da der Datei hin.

296
00:21:07,480 --> 00:21:08,940
API-JSON, okay?

297
00:21:09,120 --> 00:21:10,200
So, API-JSON.

298
00:21:10,860 --> 00:21:16,560
Und da, und da kommt jetzt als, als Antwort, wenn man den Endpunkt curlt, zurück.

299
00:21:17,080 --> 00:21:17,480
Block.

300
00:21:18,820 --> 00:21:19,340
ID.

301
00:21:19,680 --> 00:21:20,480
Oder einfach nur Block.

302
00:21:20,480 --> 00:21:24,940
Wir simulieren mal die, die Krypto, Krypto-Node, API.

303
00:21:25,240 --> 00:21:28,040
Block-ID, so, beste, beste Block-ID.

304
00:21:28,720 --> 00:21:29,440
So sieht die aus.

305
00:21:31,000 --> 00:21:32,660
Und hier unten machen wir das Gleiche.

306
00:21:32,740 --> 00:21:34,040
API-Punkt-JSON.

307
00:21:34,760 --> 00:21:40,390
Und der liefert, so, und der liefert Block-ID.

308
00:21:40,470 --> 00:21:43,210
Der muss jetzt halt irgendeine, eine, eine, eine höhere liefern.

309
00:21:43,310 --> 00:21:46,290
Der liefert, na, Moment, jetzt habe ich Mist gemacht, ja.

310
00:21:47,570 --> 00:21:50,750
Äh, der liefert, keine Ahnung, hier, äh, 8.

311
00:21:51,890 --> 00:21:53,590
1, 1, so, irgendwie so.

312
00:21:53,590 --> 00:21:56,590
Also, also der Server, der auf, äh.

313
00:21:57,070 --> 00:22:04,610
Also, der, der Dienst, der auf 8.000 läuft, der, der liefert eine höhere, äh, äh, Block-ID über, über den Endpunkt.

314
00:22:05,210 --> 00:22:05,310
So.

315
00:22:06,030 --> 00:22:09,110
Das reicht eigentlich auch schon, was wir am Backend brauchen.

316
00:22:11,750 --> 00:22:13,090
So, und wenn man das jetzt curlt.

317
00:22:14,690 --> 00:22:20,310
API-JSON, dann kriegt man hier einmal Block, äh, 7, 6, 3.

318
00:22:20,670 --> 00:22:23,210
Und hier kriegt man Block 7, 8, 3.

319
00:22:23,210 --> 00:22:23,390
So.

320
00:22:23,770 --> 00:22:27,670
Also, wenn unser HA-Proxy, äh, Health-Check.

321
00:22:27,670 --> 00:22:34,330
Bash-Health-Check funktioniert, sollte der immer diesen Endpoint selecten, weil der die höhere Block-ID hat.

322
00:22:35,870 --> 00:22:36,310
Ja.

323
00:22:39,250 --> 00:22:40,250
Negative Latency.

324
00:22:40,930 --> 00:22:41,030
Ja.

325
00:22:41,730 --> 00:22:44,630
Genau, ich, ich returne einfach Daten, die es noch gar nicht gibt.

326
00:22:47,500 --> 00:22:50,560
Man hat ja gesehen, wie gut es bei Stadia lief mit Negative Latency.

327
00:22:51,360 --> 00:22:53,880
So, Frage an euch, Chat, hat man verstanden, was ich machen will?

328
00:22:55,240 --> 00:22:56,640
Kurz was trinken.

329
00:22:58,640 --> 00:23:00,980
Ja, stimmt, wir sollten, das sollte AI selecten.

330
00:23:00,980 --> 00:23:01,140
So.

331
00:23:01,140 --> 00:23:02,460
So ein einfaches Crep tut's nicht.

332
00:23:09,180 --> 00:23:09,420
Okay.

333
00:23:11,220 --> 00:23:11,620
Excellent.

334
00:23:12,280 --> 00:23:12,680
Excellent.

335
00:23:13,220 --> 00:23:16,980
Da müssen wir jetzt erstmal anfangen, eine HA-Proxy-Conf zu bauen.

336
00:23:17,780 --> 00:23:21,440
Und HA-Proxy minus C oder sowas ist es wahrscheinlich.

337
00:23:21,620 --> 00:23:22,300
Nein, ist es nicht.

338
00:23:24,470 --> 00:23:26,110
Es ist HA-Proxy minus F.

339
00:23:29,600 --> 00:23:31,620
Der paid respects die ganze Zeit.

340
00:23:32,680 --> 00:23:33,660
HA-Proxy-Conf.

341
00:23:34,040 --> 00:23:34,220
Gut.

342
00:23:35,540 --> 00:23:36,960
Dann starten wir das mal.

343
00:23:38,120 --> 00:23:40,040
Wie sieht so eine HA-Proxy-Conf aus?

344
00:23:40,100 --> 00:23:40,940
Ich kann's mir immer umsetzen.

345
00:23:41,080 --> 00:23:41,980
Verrecken, nicht merken.

346
00:23:42,580 --> 00:23:46,080
HA-Proxy-Conf-Minimal-Example.

347
00:23:50,440 --> 00:23:52,260
HA-Config-File-Example.

348
00:23:52,360 --> 00:23:54,460
HA-Proxy-Config.

349
00:23:55,100 --> 00:23:56,800
HA-Proxy-Basics.

350
00:24:02,940 --> 00:24:05,720
Ich bilde mir ein mit Frontend, das geht so gar nicht.

351
00:24:06,360 --> 00:24:06,840
Ja.

352
00:24:12,310 --> 00:24:13,910
Ja, genau, genau, genau.

353
00:24:16,860 --> 00:24:18,480
Der Übertreibung ist aber hier.

354
00:24:19,800 --> 00:24:20,820
HA-Proxy-Config.

355
00:24:20,960 --> 00:24:21,920
Ja, hier ist es doch.

356
00:24:22,000 --> 00:24:23,080
Das ist die offizielle Anleitung.

357
00:24:23,200 --> 00:24:23,940
Das Beste.

358
00:24:24,520 --> 00:24:25,420
Minimal-Config.

359
00:24:25,580 --> 00:24:25,960
Sehr schön.

360
00:24:26,900 --> 00:24:28,320
Sehr gut.

361
00:24:28,860 --> 00:24:29,740
Also, Minimal-Config.

362
00:24:29,920 --> 00:24:31,140
Mode-TCP.

363
00:24:32,280 --> 00:24:33,860
Und ich erkläre euch jetzt auch warum.

364
00:24:34,300 --> 00:24:37,560
Weil, willst du da Lua-Skripts auswählen?

365
00:24:37,620 --> 00:24:40,320
Nein, ich will ein Bash-Health-Check.

366
00:24:41,880 --> 00:24:46,020
Bash-Health-Check-Skript hinterlegen, was alle 5 Sekunden ausgeführt wird.

367
00:24:46,640 --> 00:24:51,440
Wenn du irgendwie eine Ahnung hast, wie man Lua-Skripts in der HA-Proxy-Lua,

368
00:24:51,440 --> 00:24:52,440
haben die irgendeinen Lua-Plugin?

369
00:24:52,440 --> 00:24:57,320
5 Ways to Extend HA-Proxy with Lua.

370
00:24:57,320 --> 00:25:02,210
Okay, gucken wir mal, ob das meine HA-Proxy überhaupt hat.

371
00:25:03,830 --> 00:25:04,650
Ja, hat's.

372
00:25:06,270 --> 00:25:07,930
Global Lua-Load.

373
00:25:11,520 --> 00:25:12,960
Und was macht das jetzt?

374
00:25:16,290 --> 00:25:18,330
Attaches, Converters, Action, Service...

375
00:25:18,330 --> 00:25:26,000
Nee, ich glaube, ich glaube, ich will kein Lua-Skript verwenden, ehrlich gesagt.

376
00:25:29,830 --> 00:25:37,420
Also, es ist mir, glaube ich, etwas zu High-IQ jetzt.

377
00:25:47,340 --> 00:25:48,100
Ich meine, das ist ein Lua-Skript.

378
00:25:48,100 --> 00:25:48,220
Das ist ein Lua-Skript.

379
00:25:48,220 --> 00:25:48,240
Das ist ein Lua-Skript.

380
00:25:48,240 --> 00:25:53,260
Das hier ist schon, das ist schon, ehrlich gesagt, ähnlich zu dem,

381
00:25:58,100 --> 00:26:02,980
das ist schon ähnlich zu dem, das muss ich mir mal speichern.

382
00:26:03,180 --> 00:26:13,400
Also, das ist, das ist tatsächlich sowas ähnliches, sowas ähnliches, wie ich will.

383
00:26:13,600 --> 00:26:15,340
Aber gucken wir mal, gucken wir mal.

384
00:26:15,780 --> 00:26:20,980
Also, ähm, so, wir wollen hier nicht Frontend, sondern wir wollen, glaube ich,

385
00:26:21,400 --> 00:26:22,160
was wollen wir denn, Listen?

386
00:26:23,180 --> 00:26:23,900
Wie war das?

387
00:26:24,480 --> 00:26:24,680
Nee.

388
00:26:25,880 --> 00:26:26,900
Nee, ist schon gut so.

389
00:26:27,600 --> 00:26:28,320
Doch, Listen.

390
00:26:28,320 --> 00:26:29,540
Listen, Listen, glaube ich, wollen wir.

391
00:26:29,860 --> 00:26:33,220
Listen, weil da kann man hier irgendwie sowas sagen, wenn ich das richtig aus dem Kopf hinkriege.

392
00:26:34,060 --> 00:26:34,840
Oder Sternchen?

393
00:26:35,180 --> 00:26:35,540
Sternchen?

394
00:26:36,060 --> 00:26:37,640
Irgendwie, dass es auf 8000 lauscht.

395
00:26:38,040 --> 00:26:39,720
Lass mal kurz checken, ob das jetzt funktioniert.

396
00:26:40,220 --> 00:26:42,220
HA-Proxy minus F.

397
00:26:42,760 --> 00:26:43,020
Nein.

398
00:26:43,380 --> 00:26:43,600
Was?

399
00:26:43,840 --> 00:26:45,320
Parsing Characters not supported.

400
00:26:45,440 --> 00:26:46,120
Permitted name list.

401
00:26:46,780 --> 00:26:47,660
Oh, wie ging das nochmal?

402
00:26:48,020 --> 00:26:49,700
Oder war das einfach nur Listen App?

403
00:26:49,960 --> 00:26:52,240
Ach, Moment, hier unten steht ja die Bind, die Bind-Adresse.

404
00:26:52,800 --> 00:26:55,180
Okay, HA-Proxy soll auf 8080 lauschen.

405
00:26:55,940 --> 00:26:57,140
Okay, HA-Proxy läuft.

406
00:26:57,140 --> 00:26:58,080
Gucken wir mal.

407
00:26:58,080 --> 00:27:01,720
HA-Proxy leitet weiter auf Port.

408
00:27:03,420 --> 00:27:05,280
Ähm, mein Server weiterleiten.

409
00:27:07,530 --> 00:27:07,870
Geht.

410
00:27:13,220 --> 00:27:18,730
Konnte man, konnte man die Server nicht einfach hier unten reinschreiben?

411
00:27:18,850 --> 00:27:19,970
Doch, ne, das ging auch.

412
00:27:20,490 --> 00:27:22,250
Okay, geht auf Port 8000.

413
00:27:23,950 --> 00:27:26,630
Okay, das sollte, das sollte jetzt schon funktionieren.

414
00:27:27,270 --> 00:27:27,810
Gucken wir mal.

415
00:27:28,290 --> 00:27:32,390
Curl, also wir gehen auf die Load, wir gehen auf die Load, auf den Load-Balancer-Endpunkt.

416
00:27:32,390 --> 00:27:35,390
Und wir kommen hier unten auf dem, auf Port 8000 raus.

417
00:27:35,790 --> 00:27:37,790
Okay, das funktioniert.

418
00:27:38,190 --> 00:27:40,910
Also Minimal-Config-HA-Proxy funzt schon mal.

419
00:27:44,340 --> 00:27:45,620
Ja, das könnte man auch machen.

420
00:27:46,080 --> 00:27:51,100
Aber, wie gesagt, ich, ich, ich, ich setze aktuell auf einen External-Health-Check im HA-Proxy.

421
00:27:53,100 --> 00:27:54,440
War da in der Aufsicht jemand, ob man...

422
00:27:55,580 --> 00:28:00,440
Hab ich, hab ich vor langer Zeit verwendet, hab ich aufgegeben, war mir zu, war mir zu ätzend.

423
00:28:00,940 --> 00:28:02,680
Deswegen hab ich jetzt das in der VM laufen.

424
00:28:06,020 --> 00:28:06,520
So.

425
00:28:07,520 --> 00:28:08,520
Dann machen wir mal...

426
00:28:08,720 --> 00:28:09,640
Ey, wie war das, warte mal.

427
00:28:09,900 --> 00:28:10,940
HA-Proxy...

428
00:28:10,940 --> 00:28:12,740
...External-Checks.

429
00:28:13,240 --> 00:28:14,440
Ich hab das schon mal gemacht.

430
00:28:15,080 --> 00:28:16,580
Das ist zwar schon bestimmt...

431
00:28:17,340 --> 00:28:18,740
...fünf Jahre oder so her.

432
00:28:19,840 --> 00:28:20,940
Aber ich kann mich noch...

433
00:28:21,940 --> 00:28:24,940
...verhältnismäßig gut für das, wie lange das her ist, dran erinnern.

434
00:28:25,300 --> 00:28:26,300
Also ich weiß, es gab...

435
00:28:26,640 --> 00:28:28,140
Genau, External-Checks...

436
00:28:28,400 --> 00:28:29,300
...Example.

437
00:28:30,080 --> 00:28:30,580
Es gibt...

438
00:28:35,020 --> 00:28:36,320
...genau, Option...

439
00:28:37,080 --> 00:28:40,020
...genau, das, genau, genau, genau, das kommt mir noch bekannt vor.

440
00:28:40,020 --> 00:28:41,320
Das bräu... das braucht man.

441
00:28:41,720 --> 00:28:43,520
Option, External-Check...

442
00:28:44,620 --> 00:28:48,120
...da kann man nämlich, also wenn ich das, wenn ich das noch richtig in Erinnerung habe...

443
00:28:48,720 --> 00:28:53,120
...dann konnte man, ich bin mir jetzt nicht sicher, ob das auf Global musste oder hierhin, ich glaub, das muss hierhin...

444
00:28:53,720 --> 00:28:55,520
...also man kann HA-Proxy sagen...

445
00:28:56,820 --> 00:28:57,320
...dass er...

446
00:28:57,820 --> 00:29:00,020
...also wir brauchen übrigens zwei Server im Backend, ne?

447
00:29:00,720 --> 00:29:03,220
Also einen auf 8001 und einen auch auf 8000.

448
00:29:03,620 --> 00:29:05,720
Also man kann, wenn ich das richtig im Hinterkopf habe...

449
00:29:06,720 --> 00:29:07,720
...HA-Proxy sagen...

450
00:29:08,420 --> 00:29:09,020
...führe...

451
00:29:09,720 --> 00:29:13,020
...einen Custom Health-Check aus, und zwar in dem Fall hier den da, den...

452
00:29:13,020 --> 00:29:15,020
...machen wir jetzt mal einen eigenen hier...

453
00:29:19,840 --> 00:29:20,340
...touch...

454
00:29:21,040 --> 00:29:22,440
...check.sh...

455
00:29:27,070 --> 00:29:27,570
...bin...

456
00:29:27,670 --> 00:29:28,170
...bash...

457
00:29:29,470 --> 00:29:30,270
...chmod...

458
00:29:31,370 --> 00:29:32,170
...plus x...

459
00:29:33,370 --> 00:29:33,870
...check...

460
00:29:34,770 --> 00:29:35,270
...hier...

461
00:29:36,270 --> 00:29:36,770
...so...

462
00:29:37,370 --> 00:29:37,870
...und...

463
00:29:37,970 --> 00:29:38,470
...ups...

464
00:29:40,470 --> 00:29:42,070
...so, External-Command...

465
00:29:42,370 --> 00:29:46,370
...so, und wenn ich das richtig zusammenkriege noch aus dem Kopf, dann ist das jetzt so...

466
00:29:47,470 --> 00:29:48,770
...dass HA-Proxy...

467
00:29:49,070 --> 00:29:52,770
...alle Sekunde oder alle fünf Sekunden, das kann man dann irgendwie einstellen...

468
00:29:54,170 --> 00:29:55,070
...dass der...

469
00:29:55,470 --> 00:29:57,270
...diesen Check ausführt...

470
00:29:58,770 --> 00:30:02,270
...und wenn der Check erfolgreich ist für das jeweilige Backend...

471
00:30:02,870 --> 00:30:06,570
...dann wird das...bleibt das aktiv, ansonsten wird das down genommen.

472
00:30:06,870 --> 00:30:08,570
Das heißt, alle Backends...

473
00:30:08,870 --> 00:30:10,370
...von denen ich nicht möchte...

474
00:30:10,670 --> 00:30:12,170
...dass die Traffic abbekommen...

475
00:30:13,270 --> 00:30:14,770
...sollen down sein.

476
00:30:14,870 --> 00:30:15,370
So, und...

477
00:30:15,870 --> 00:30:18,070
...das, das müsste, das müsste eigentlich funktionieren.

478
00:30:18,070 --> 00:30:18,670
Ich, ich führe mal...

479
00:30:18,670 --> 00:30:21,470
...HA-Proxy jetzt aus und gucke, ob es prinzipiell geht und nicht crasht...

480
00:30:21,570 --> 00:30:22,970
...bäm, geht kaputt.

481
00:30:23,570 --> 00:30:24,670
Was hat er für Schmerzen?

482
00:30:25,870 --> 00:30:27,370
Option External Check...

483
00:30:28,070 --> 00:30:31,670
...Unable to Find Global External Check.

484
00:30:32,170 --> 00:30:32,570
Okay.

485
00:30:34,070 --> 00:30:35,470
Brauche ich noch eine Global Section?

486
00:30:39,630 --> 00:30:40,030
Okay.

487
00:30:41,630 --> 00:30:42,530
Was, was hat er hier?

488
00:30:42,930 --> 00:30:47,030
Insecure Fork Wanted Not Enabled in the Global Section.

489
00:30:49,690 --> 00:30:52,290
Also, eins muss man HA-Proxy nämlich zugute halten...

490
00:30:52,290 --> 00:30:55,090
...die haben erstaunlich gute Docs.

491
00:30:56,190 --> 00:31:00,090
Sieht zwar aus wie 1995, aber die sind, sind wirklich ganz gut beschrieben.

492
00:31:00,590 --> 00:31:05,090
By default, HA-Proxy tries hard to prevent any threats and process creation of the...

493
00:31:05,190 --> 00:31:07,490
Okay, ja, das brauche ich, das ergibt Sinn.

494
00:31:08,190 --> 00:31:11,090
So, und wenn ich das jetzt richtig gemacht habe, dann sollte...

495
00:31:11,890 --> 00:31:15,490
...dieses, dieses Checkscript, schreibe mal echo123 rein...

496
00:31:15,690 --> 00:31:17,490
...sollte dieses Checkscript...

497
00:31:19,290 --> 00:31:21,690
...regelmäßig ausgeführt werden.

498
00:31:23,290 --> 00:31:24,290
Wird es aber nicht.

499
00:31:26,370 --> 00:31:26,970
Warum?

500
00:31:29,520 --> 00:31:35,520
Chat, wenn ihr irgendwelche Questions habt, dann schreibt es mit AdWoblos rein, weil ich muss mich gerade konzentrieren.

501
00:31:37,620 --> 00:31:39,720
Habe ich irgendwas vergessen?

502
00:31:41,220 --> 00:31:43,020
Can't use external check.

503
00:31:44,920 --> 00:31:46,420
Wie hat der das konfiguriert?

504
00:31:47,620 --> 00:31:48,220
Server...

505
00:31:48,520 --> 00:31:48,920
Ah!

506
00:31:50,120 --> 00:31:52,520
Ah, man muss Check dahinter schreiben, dass er was checkt.

507
00:31:52,720 --> 00:31:56,920
Ja, die Syntax, die Syntax von HA-Proxy ist etwas kryptisch.

508
00:31:57,620 --> 00:31:59,120
Aber es funktioniert gut.

509
00:32:00,220 --> 00:32:00,720
Jawoll!

510
00:32:01,020 --> 00:32:02,920
Okay, er führt mein Custom-Script aus.

511
00:32:03,020 --> 00:32:03,920
Sehr gut, sehr gut.

512
00:32:04,120 --> 00:32:04,920
Excellent!

513
00:32:11,290 --> 00:32:12,090
Das finde ich gut.

514
00:32:14,190 --> 00:32:16,190
Okay, und jetzt brauche ich nur noch ein Example.

515
00:32:16,590 --> 00:32:19,590
HA-Proxy external check.

516
00:32:20,290 --> 00:32:28,090
Weil, ich kann mich noch daran erinnern, da werden, genau, da werden, also da werden Variablen übergeben an das, an das Script.

517
00:32:28,490 --> 00:32:32,190
Anhand dessen kann man erkennen, für welchen Endpunkt das gerade ausgeführt wird.

518
00:32:32,190 --> 00:32:32,690
Mario!

519
00:32:32,790 --> 00:32:33,490
Oh, wir sind wieder am Start.

520
00:32:33,590 --> 00:32:34,590
Moin, danke für den Sub.

521
00:32:34,990 --> 00:32:36,690
How to write an external health check.

522
00:32:40,080 --> 00:32:41,280
External...

523
00:32:43,750 --> 00:32:44,250
Ach, guck mal!

524
00:32:44,750 --> 00:32:46,550
Hier haben, hier haben sie doch ein Beispiel für.

525
00:32:47,350 --> 00:32:48,850
Variablen sind...

526
00:32:49,650 --> 00:32:50,050
Hier.

527
00:32:50,450 --> 00:32:55,450
Also, $1 ist Virtual-Service-IP, also im Prinzip die IP vom Server, okay.

528
00:32:55,950 --> 00:32:56,450
Port...

529
00:33:00,050 --> 00:33:03,450
Real Server, also der eigentliche Endpunkt, der angesprochen wird.

530
00:33:05,450 --> 00:33:06,150
Und...

531
00:33:07,250 --> 00:33:09,150
Check Source IP.

532
00:33:09,350 --> 00:33:16,750
Check Source IP?

533
00:33:19,480 --> 00:33:21,680
Was soll die Check Source IP sein?

534
00:33:23,580 --> 00:33:25,980
Okay, wir gucken, wir gucken mal, was der HA-Proxy dazu sagt.

535
00:33:30,470 --> 00:33:31,870
Die IP vom Server?

536
00:33:32,370 --> 00:33:32,870
Ah!

537
00:33:33,570 --> 00:33:34,070
Ja.

538
00:33:34,970 --> 00:33:36,670
Das, das kann tatsächlich sein.

539
00:33:38,940 --> 00:33:41,140
Das, das kann tatsächlich sein, ja.

540
00:33:52,920 --> 00:33:53,420
Ja.

541
00:33:53,920 --> 00:33:56,320
Command ist der external command to run.

542
00:33:59,340 --> 00:34:00,840
The arguments passed...

543
00:34:01,140 --> 00:34:05,940
To the commands are proxy address, proxy port, server address, service port.

544
00:34:06,040 --> 00:34:07,240
Okay, das war's, der andere geschrieben.

545
00:34:07,340 --> 00:34:12,140
Andere war bestimmt JetGPT generated.

546
00:34:15,720 --> 00:34:18,620
Some values are also provided through environment variables.

547
00:34:18,720 --> 00:34:19,120
Okay.

548
00:34:19,220 --> 00:34:35,530
HA-Proxy address, backend ID, backend name, HA-Proxy port, server address, connection, server ID, server name,

549
00:34:35,530 --> 00:34:43,330
Ports, Protokoll, Pfad, ja, eigentlich nix, nix, was ich brauche.

550
00:34:44,930 --> 00:34:50,030
Kriegst du beim external Script alle Backends oder muss das Script sehr statisch sein?

551
00:34:50,430 --> 00:34:51,930
Nee, ich krieg nicht alle Backends.

552
00:34:52,130 --> 00:34:55,730
Aber das ist nicht schlimm, ich kenne ja alle Backends, die, die schreibe ich, die schreibe ich da rein.

553
00:34:56,030 --> 00:34:58,530
Ansonsten krabbe ich sie mir aus der HA-Proxy-Conf.

554
00:34:59,630 --> 00:35:03,130
Guck mal, ich auch mal, wir krabben uns die einfach aus der HA-Proxy-Conf, easy.

555
00:35:03,730 --> 00:35:04,230
Ja.

556
00:35:05,530 --> 00:35:20,460
Grab, server, ähm, grab, check, ah, Mist, grab, server, okay.

557
00:35:20,660 --> 00:35:29,260
Alter, HA-Proxy, Mensch, so, jetzt aber, ähm, und dann, cut.

558
00:35:35,880 --> 00:35:40,880
So, jetzt haben wir, guck, jetzt haben wir uns sogar die, jetzt haben wir uns sogar die IPs rausgeholt aus der HA-Proxy-Conf.

559
00:35:40,980 --> 00:35:41,880
Excellent.

560
00:35:44,420 --> 00:35:45,920
So, dann, dann probieren wir das mal auf.

561
00:35:45,920 --> 00:35:47,220
Ich, ich, ich bin gespannt.

562
00:35:47,420 --> 00:35:49,920
Dann machen wir das genau so, wir holen uns das hier raus.

563
00:35:51,220 --> 00:35:53,020
Gucken mal, ob das, ob das läuft.

564
00:35:53,220 --> 00:35:54,820
Easy-Hackerman-Stells, genau.

565
00:35:55,520 --> 00:35:56,320
Minus F.

566
00:35:57,720 --> 00:36:00,120
Ups, HA-Proxy, minus F.

567
00:36:00,920 --> 00:36:03,720
Es läuft, okay, er kriegt's, er kriegt's raus, sehr schön.

568
00:36:04,020 --> 00:36:04,820
Nice, du.

569
00:36:05,820 --> 00:36:09,920
Dann, okay, jetzt kommen die ersten an, Useless Use of Cat, ja, meinetwegen.

570
00:36:10,720 --> 00:36:13,120
HA-Proxy, aber ich find das einfach viel angenehmer so.

571
00:36:13,520 --> 00:36:15,520
So, dann nennen wir das mal Endpoints.

572
00:36:15,920 --> 00:36:19,920
Das ist so der beste Name, der mir einfällt dafür.

573
00:36:20,420 --> 00:36:23,920
Endpoints, so, Chat, Five-Hat-Time.

574
00:36:24,920 --> 00:36:27,420
Dann, was übergibt er für Variablen?

575
00:36:28,720 --> 00:36:42,120
Proxy-Adress, Proxy-Port, okay, machen wir mal sowas hier wie Service, IP, oder Service, Service-Host oder sowas, äh, Dollar 1.

576
00:36:43,420 --> 00:36:45,720
Service-Port.

577
00:36:45,920 --> 00:36:47,920
Dollar 2, was war das nächste?

578
00:36:48,920 --> 00:37:02,040
Server-Address, also quasi, äh, ja, Check, Check-Host, eigentlich egal.

579
00:37:02,540 --> 00:37:04,040
Weiß gar nicht, ob wir das überhaupt brauchen.

580
00:37:04,540 --> 00:37:10,040
Und Check-Port, dann zählen wir das noch hoch.

581
00:37:10,540 --> 00:37:14,040
Gut, jetzt bin ich mal gespannt.

582
00:37:14,540 --> 00:37:16,540
Erhältst du dann, welche OS könnt ihr für einen Home-Server empfehlen?

583
00:37:17,040 --> 00:37:19,040
Debian, nehm Debian, und gut ist.

584
00:37:20,040 --> 00:37:23,040
Dann sei denn du hast spezielle Anforderungen, dann eventuell was anderes.

585
00:37:24,040 --> 00:37:37,040
Debian, kannst auch Ubuntu nehmen, kannst auch, wenn du ganz hart drauf bist, ähm, CentOS nehmen oder sowas, aber das ist im Enterprise-Umfeld, geht mir das schon auf den Sack.

586
00:37:37,540 --> 00:37:40,040
Ich, ich würde einfach Default Debian nehmen, und gut ist.

587
00:37:41,040 --> 00:37:46,040
Ja, Rocky, genau, Rocky, einmal Linux, wenn man eher die Red Hat, Red Hat-Schiene will.

588
00:37:46,040 --> 00:37:49,040
So, also, was machen wir denn jetzt?

589
00:37:49,540 --> 00:37:56,040
Jetzt machen wir eine Schleife vor Endpoint, vor Endpoint in Endpoints.

590
00:37:56,540 --> 00:38:00,040
Do, Echo, Endpoint.

591
00:38:00,540 --> 00:38:03,040
Ah, Mann, das ist jetzt, das ist jetzt noch nicht die hohe Kunst.

592
00:38:03,540 --> 00:38:06,040
Wir führen das mal von Hand aus, um zu gucken, ob es funktioniert.

593
00:38:06,540 --> 00:38:09,040
Also, das interessiert mich nicht.

594
00:38:09,540 --> 00:38:12,040
Kunst, Kunst hast du wirklich?

595
00:38:12,540 --> 00:38:14,040
Kunst wirklich?

596
00:38:14,040 --> 00:38:15,040
So.

597
00:38:15,040 --> 00:38:18,040
So, vor Endpoint in Endpoints.

598
00:38:18,540 --> 00:38:20,040
Was wollen wir jetzt machen?

599
00:38:20,540 --> 00:38:31,360
Ich will jetzt checken, ob die Server hier, meine Web-Server-Endpunkte, also meine Web-Server, ähm, API-Endpunkte, ob die laufen.

600
00:38:31,860 --> 00:38:33,360
Das mache ich einfach mal mit einem Curl.

601
00:38:33,860 --> 00:38:35,360
Leute, ich habe ein Problem.

602
00:38:35,860 --> 00:38:39,360
Ich habe vorhin zwei, zwei Riesenteller Nudeln gefuttert.

603
00:38:39,860 --> 00:38:47,370
Ich muss mal kurz, ich muss mal kurz, auf Klo.

604
00:38:47,370 --> 00:38:51,900
Ich bin in fünf Minuten wieder da.

605
00:38:52,400 --> 00:38:55,900
Und, und dann haben wir noch eine Stunde genau Zeit, das zu vollenden.

606
00:38:56,400 --> 00:39:00,880
Ich bin gleich wieder da.

607
00:39:01,380 --> 00:43:48,160
Ich bin wieder am Start.

608
00:43:48,660 --> 00:43:54,550
Weiter geht's.

609
00:43:55,050 --> 00:44:02,040
Wo sind wir stehen geblieben?

610
00:44:02,540 --> 00:44:03,540
Ahem, genau.

611
00:44:04,040 --> 00:44:05,040
Bash, Bash-Skript.

612
00:44:05,540 --> 00:44:08,540
So, wir gehen alle Endpunkte aus der HA-Proxy-Config durch.

613
00:44:09,540 --> 00:44:12,540
Und jetzt muss ich mal überlegen, was machen wir.

614
00:44:13,040 --> 00:44:15,040
Ich will fest, also ich brauche hier erstmal so eine Art Health-Check.

615
00:44:15,540 --> 00:44:16,540
Da machen wir einfach einen Curl.

616
00:44:17,040 --> 00:44:18,540
So, Curl.

617
00:44:18,540 --> 00:44:19,540
Local Host, API.

618
00:44:20,040 --> 00:44:20,540
Sagen wir das immer mal korrekt.

619
00:44:21,040 --> 00:44:22,540
Schreiben wir mal http davor.

620
00:44:23,040 --> 00:44:24,040
Machen wir einen Curl.

621
00:44:24,540 --> 00:44:26,540
Auf 8080 läuft nichts.

622
00:44:28,040 --> 00:44:29,040
Weil HA-Proxy aus ist.

623
00:44:29,540 --> 00:44:30,040
Das ist schon mal gut.

624
00:44:30,540 --> 00:44:32,040
So, auf 8001 läuft was.

625
00:44:32,540 --> 00:44:35,040
Auf 8002 läuft nichts.

626
00:44:36,040 --> 00:44:39,040
Wir wollen keine Error-Ausgabe haben.

627
00:44:39,540 --> 00:44:40,540
Okay, gut.

628
00:44:41,540 --> 00:44:42,540
Und hier kriegen wir Jason zurück.

629
00:44:43,040 --> 00:44:44,540
Das heißt, das pipen wir nach JQ.

630
00:44:45,040 --> 00:44:46,540
Und holen uns...

631
00:44:47,540 --> 00:44:49,040
Das fällt mit Block raus.

632
00:44:49,540 --> 00:44:51,040
Genau das wollen wir haben.

633
00:44:51,540 --> 00:44:52,040
Eats.

634
00:44:56,540 --> 00:44:58,040
Nudeln mit Lachs, Alter.

635
00:44:59,540 --> 00:45:00,540
Ist klar, Leute.

636
00:45:02,600 --> 00:45:05,600
Ich weiß nur, weil ich euch nicht viel mehr erzähle, was ich sonst so esse.

637
00:45:06,100 --> 00:45:08,600
Heißt nicht, dass ich nur immer Nudeln mit Lachs-Futter...

638
00:45:09,600 --> 00:45:10,600
So, nehmen wir das mal so hier.

639
00:45:11,100 --> 00:45:12,100
Irgendwie Response.

640
00:45:14,360 --> 00:45:15,360
So, was brauchen wir denn jetzt?

641
00:45:15,860 --> 00:45:16,860
Jetzt muss ich mal kurz in mich gehen.

642
00:45:17,360 --> 00:45:21,360
Also, hier muss auf jeden Fall schon mal Quotes drumherum.

643
00:45:21,360 --> 00:45:22,860
Bin mir auch nicht ganz sicher, warum.

644
00:45:23,360 --> 00:45:24,360
Aber ist auf jeden Fall nicht verkehrt.

645
00:45:24,860 --> 00:45:26,860
Und hier kommt der Endpoint rein.

646
00:45:34,120 --> 00:45:36,620
Aber auch nicht auf Port 8001, sondern direkt so.

647
00:45:37,120 --> 00:45:41,460
Mach doch mal einen Koch-Stream.

648
00:45:41,960 --> 00:45:43,460
Na, ich weiß net.

649
00:45:43,960 --> 00:45:45,460
Ich weiß ja net.

650
00:45:45,960 --> 00:45:48,460
Da gibt's noch Leak im Kochdeckel oder so.

651
00:45:48,960 --> 00:45:49,960
Im Topfdeckel.

652
00:45:50,960 --> 00:45:51,960
So.

653
00:45:52,460 --> 00:45:53,960
Jetzt haben wir hier das Result drinne.

654
00:45:54,960 --> 00:45:56,460
Von diesem Curl.

655
00:45:56,960 --> 00:45:59,460
Die einzige Sache, wo ich mir nicht ganz sicher bin, ist...

656
00:45:59,460 --> 00:46:06,460
Was passiert, wenn es JSON, was der Server returnt, ein Error hat?

657
00:46:06,960 --> 00:46:12,460
Zumindest würde ich sagen, wir checken jetzt einfach erstmal, ob in der Response was drinne ist.

658
00:46:12,960 --> 00:46:14,460
Weil, ihr habt's ja gesehen...

659
00:46:14,960 --> 00:46:16,460
Oder wir können's ja mal ausprobieren.

660
00:46:16,960 --> 00:46:18,460
Okay, nix macht das JQ. Das ist gut.

661
00:46:18,960 --> 00:46:24,960
Also, wenn man was curlt von einem nicht erreichbaren Server, dann gibt's keine Ausgabe.

662
00:46:25,460 --> 00:46:26,460
Das heißt, wir checken jetzt erstmal...

663
00:46:26,960 --> 00:46:28,960
Leute, wenn ihr übrigens bessere Ideen habt, wie man das...

664
00:46:28,960 --> 00:46:33,460
Wie man das nicer machen kann, in Bash oder was ich hier mache, ne?

665
00:46:33,960 --> 00:46:34,960
Könnt ihr ruhig in den Chat schreiben.

666
00:46:35,460 --> 00:46:37,460
Vielleicht haben wir hier die richtig krassen Bash-Hackermans dabei.

667
00:46:37,960 --> 00:46:39,460
So, wir checken jetzt, ob...

668
00:46:41,460 --> 00:46:44,460
Ob das nicht leer ist.

669
00:46:47,030 --> 00:46:48,030
Übrigens, das ist Bash-Logik.

670
00:46:48,530 --> 00:46:51,030
Wer sich fragt, ein if muss man immer mit einem phi beenden.

671
00:46:51,530 --> 00:46:53,030
Warum? Man weiß es nicht.

672
00:46:53,530 --> 00:46:57,030
Und ein for beendet man mit done und nicht mit rof.

673
00:46:58,030 --> 00:46:59,030
Bash-Logik.

674
00:46:59,030 --> 00:47:01,530
Das hat sich irgendeiner vor 65 Jahren ausgedacht.

675
00:47:02,030 --> 00:47:03,530
Man weiß nicht mehr, warum das so ist.

676
00:47:08,100 --> 00:47:09,600
Letztens Video von meinem Klo gesehen, ja.

677
00:47:10,100 --> 00:47:12,100
Das ist so beliebt, das Video von meinem Klo,

678
00:47:12,600 --> 00:47:15,600
dass sogar irgendein russischer... russischer...

679
00:47:16,100 --> 00:47:16,600
ähm...

680
00:47:17,100 --> 00:47:19,600
Ja, so Sanitärhandel-Lampen...

681
00:47:20,100 --> 00:47:22,600
äh... russischer Sanitärhandels-Shop

682
00:47:23,100 --> 00:47:24,600
das Video geklaut hat davon.

683
00:47:26,660 --> 00:47:28,160
Und hochge... und reuploaded hat.

684
00:47:28,660 --> 00:47:32,670
Kann man sich nicht vorstellen, was da los ist, ne?

685
00:47:33,170 --> 00:47:35,670
Dass die sich selbst da einfach ein Video machen können.

686
00:47:36,170 --> 00:47:37,170
Vor allem auf einem russischen Channel.

687
00:47:37,670 --> 00:47:39,670
So ein Typ, der auf Deutsch redet und in seinem...

688
00:47:40,170 --> 00:47:41,170
in seinem Badezimmer ist.

689
00:47:41,670 --> 00:47:42,170
Komplett random.

690
00:47:42,670 --> 00:47:44,170
Was denken sich die Zuschauer da?

691
00:47:44,670 --> 00:47:45,670
Einfach mal ein Video gerippt.

692
00:47:47,800 --> 00:47:49,800
So, also wir testen, ob das...

693
00:47:50,300 --> 00:47:51,300
Ah, ich bin mir nicht ganz sicher.

694
00:47:51,800 --> 00:47:52,300
Okay, Chat, ich muss mal...

695
00:47:52,800 --> 00:47:54,300
ich muss mal überlegen, wie wir das jetzt machen.

696
00:47:56,300 --> 00:47:57,800
Wo findet man das Klo-Video?

697
00:47:58,300 --> 00:47:58,800
Auf YouTube.

698
00:47:59,300 --> 00:47:59,800
Wo ist es einfach bei mir?

699
00:48:00,300 --> 00:48:03,450
Hier.

700
00:48:03,950 --> 00:48:04,450
Klo.

701
00:48:04,950 --> 00:48:06,450
Es gibt zwei... es gibt zwei Klo-Videos.

702
00:48:06,950 --> 00:48:09,450
Eins von 2017, wo ich das Ding...

703
00:48:09,450 --> 00:48:12,760
so neu gar nicht hatte.

704
00:48:17,440 --> 00:48:19,440
Weil wir sind 2013 hier eingezogen.

705
00:48:19,940 --> 00:48:21,440
Also im Prinzip so lang... so lang habe ich das dann schon.

706
00:48:23,940 --> 00:48:24,440
Und...

707
00:48:25,440 --> 00:48:25,940
Ja.

708
00:48:26,440 --> 00:48:27,440
Hier habe ich Fazit gemacht.

709
00:48:27,940 --> 00:48:29,440
Acht Jahre Premium-Klo.

710
00:48:29,940 --> 00:48:43,770
Das ist richtig, ja.

711
00:48:44,270 --> 00:48:45,770
Ich habe mir das noch gar nicht so genau überlegt.

712
00:48:47,270 --> 00:48:48,270
Zumindest...

713
00:48:48,770 --> 00:48:51,770
Also, wenn... wenn das Ergebnis nicht leer ist, dann...

714
00:48:52,270 --> 00:48:53,770
geben... wir geben das einfach mal aus.

715
00:48:54,270 --> 00:48:55,770
Okay, wir geben das einfach mal aus.

716
00:48:55,770 --> 00:48:56,770
Wir geben...

717
00:48:57,270 --> 00:48:58,270
Leute, ich weiß...

718
00:48:58,770 --> 00:48:59,770
Ich weiß, wie wir das machen.

719
00:49:00,270 --> 00:49:01,270
Ich weiß, wie wir das machen.

720
00:49:01,770 --> 00:49:02,270
Pfeifert-Idee.

721
00:49:02,770 --> 00:49:04,270
Ich glaube, das funktioniert richtig gut.

722
00:49:04,770 --> 00:49:05,770
Das... das müssen wir mal ausbrennen.

723
00:49:06,270 --> 00:49:07,270
Okay, wir geben...

724
00:49:07,770 --> 00:49:09,270
Wir geben die Response aus...

725
00:49:10,270 --> 00:49:11,270
von dem Endpunkt.

726
00:49:12,270 --> 00:49:12,770
Und...

727
00:49:13,270 --> 00:49:14,270
dann...

728
00:49:15,270 --> 00:49:16,770
schreiben wir uns noch den End...

729
00:49:17,270 --> 00:49:18,270
Endpoint dahinter.

730
00:49:18,770 --> 00:49:20,770
So, und jetzt... und jetzt passt mal auf.

731
00:49:21,270 --> 00:49:21,770
Passt mal auf.

732
00:49:22,270 --> 00:49:23,270
Wenn ich das jetzt von Hand ausführe...

733
00:49:23,770 --> 00:49:25,270
dann kommt jetzt hier raus...

734
00:49:26,270 --> 00:49:27,770
der ist bei dieser Blocknummer...

735
00:49:28,270 --> 00:49:29,270
also, der ist bei dieser Blocknummer...

736
00:49:29,770 --> 00:49:30,770
und der ist bei dieser Blocknummer.

737
00:49:31,270 --> 00:49:32,270
Was ich jetzt machen kann, ist...

738
00:49:32,770 --> 00:49:33,770
ich kann das einfach...

739
00:49:34,270 --> 00:49:35,270
numerisch sortieren...

740
00:49:37,270 --> 00:49:39,270
und reverse sorten.

741
00:49:40,270 --> 00:49:41,270
Und dann habe ich immer...

742
00:49:42,770 --> 00:49:43,270
die...

743
00:49:44,770 --> 00:49:45,770
äh, reverse sorten?

744
00:49:49,250 --> 00:49:50,750
Ja, reverse sorten, genau.

745
00:49:51,250 --> 00:49:53,250
Dann habe ich immer... immer den höchsten...

746
00:49:54,250 --> 00:49:56,250
den... den Endpoint mit dem höchsten Block...

747
00:49:56,750 --> 00:49:57,750
als erstes.

748
00:49:58,250 --> 00:49:59,250
Heißt...

749
00:50:00,250 --> 00:50:02,750
Heißt, wir können das eigentlich so lassen...

750
00:50:03,250 --> 00:50:06,250
und schreiben die gesamte Schleifenausgabe...

751
00:50:09,460 --> 00:50:10,460
wobei, ja...

752
00:50:10,960 --> 00:50:12,460
Ne, das geht doch, glaube ich, noch einfach.

753
00:50:12,960 --> 00:50:15,960
Ich kann doch... ich kann doch theoretisch hier einfach ein sort-n-r hintendran hängen...

754
00:50:16,460 --> 00:50:17,960
und dann machen wir ein head-1...

755
00:50:18,460 --> 00:50:21,460
und nehmen immer... äh, ein head-n-1...

756
00:50:21,960 --> 00:50:23,460
und dann kriegen wir immer...

757
00:50:23,960 --> 00:50:25,460
den Endpoint raus... genau!

758
00:50:25,960 --> 00:50:27,960
Dann kriegen wir immer den Endpoint raus mit der höchsten...

759
00:50:27,960 --> 00:50:29,460
mit der höchsten... mit den höchsten Blocks.

760
00:50:29,960 --> 00:50:31,460
So, jetzt kriegen wir aktuell den hier raus.

761
00:50:31,960 --> 00:50:33,460
Jetzt schalte ich den mal aus...

762
00:50:34,460 --> 00:50:35,460
und jetzt kriege ich den da oben raus.

763
00:50:36,460 --> 00:50:37,460
Das passt doch wunderbar.

764
00:50:39,460 --> 00:50:40,960
Was passiert, wenn beide aus sind?

765
00:50:41,460 --> 00:50:42,460
Dann geht's bestimmt kaputt.

766
00:50:43,460 --> 00:50:45,460
Dann kommt nichts als Ausgabe.

767
00:50:45,960 --> 00:50:47,460
Eigentlich ziemlich gut.

768
00:50:48,960 --> 00:50:50,960
Easy 5k, denke ich auch.

769
00:50:51,460 --> 00:50:52,460
Äh, 50k.

770
00:50:53,460 --> 00:50:54,460
So...

771
00:50:55,460 --> 00:50:57,460
Und was müssen wir jetzt machen?

772
00:50:57,960 --> 00:51:00,970
Ähm...

773
00:51:05,910 --> 00:51:06,910
Ich brauche den Output nochmal.

774
00:51:07,410 --> 00:51:09,910
Den capturen wir auch nochmal, eine Variable.

775
00:51:10,910 --> 00:51:12,910
Das ist ja immer der...

776
00:51:13,910 --> 00:51:16,910
Endpunkt, der jetzt quasi ausgewählt wurde...

777
00:51:17,410 --> 00:51:19,910
mit... mit dem aktuellsten Stand.

778
00:51:20,910 --> 00:51:22,410
Schreibt noch eine Error-Message, ja?

779
00:51:22,910 --> 00:51:24,410
Nennen wir das mal selected.

780
00:51:24,910 --> 00:51:25,910
Se-lected.

781
00:51:26,410 --> 00:51:27,910
Nennen wir das mal selected.

782
00:51:29,410 --> 00:51:30,410
So...

783
00:51:35,230 --> 00:51:35,730
Und jetzt...

784
00:51:40,360 --> 00:51:41,860
Jetzt muss ich erstmal testen, ob das überhaupt funktioniert.

785
00:51:42,360 --> 00:51:42,860
Was ich hier...

786
00:51:42,860 --> 00:51:43,860
Was ich hier gebaut hab.

787
00:51:45,360 --> 00:51:45,860
Ich...

788
00:51:45,860 --> 00:51:49,360
Ich lass das grad nochmal kurz ausführen vom HA-Proxy und guck mal, was dann passiert.

789
00:51:50,360 --> 00:51:50,860
Okay, er...

790
00:51:50,860 --> 00:51:51,360
Er...

791
00:51:51,360 --> 00:51:53,360
Er fragt beide Endpunkte regelmäßig ab.

792
00:51:53,860 --> 00:51:54,360
Nice, nice.

793
00:51:54,360 --> 00:51:55,360
Das ist schonmal gut.

794
00:51:55,860 --> 00:51:57,860
So, dann machen wir jetzt mal eine Ausgabe.

795
00:51:57,860 --> 00:51:59,360
Machen wir mal irgendwie...

796
00:51:59,860 --> 00:52:00,360
Ähm...

797
00:52:00,360 --> 00:52:00,860
Ja...

798
00:52:02,360 --> 00:52:03,360
Highest Block...

799
00:52:05,680 --> 00:52:07,680
Achso, den hab ich ja gar nicht an der Stelle.

800
00:52:07,680 --> 00:52:09,680
Den muss ich mir erstmal irgendwie rausholen.

801
00:52:10,680 --> 00:52:11,680
Highest Block...

802
00:52:11,680 --> 00:52:12,180
Und...

803
00:52:12,180 --> 00:52:12,680
Und...

804
00:52:12,680 --> 00:52:13,180
Dann...

805
00:52:13,180 --> 00:52:15,180
Dann machen wir noch irgendwie...

806
00:52:16,680 --> 00:52:19,680
Was ich für einen Endpunkt ausgewählt hab.

807
00:52:21,680 --> 00:52:27,460
Äh, ja...

808
00:52:27,460 --> 00:52:28,460
Endpoint...

809
00:52:32,450 --> 00:52:33,450
Nennen wir einfach Block.

810
00:52:34,450 --> 00:52:34,950
Endpoint...

811
00:52:35,950 --> 00:52:36,450
So.

812
00:52:36,450 --> 00:52:39,950
Zumindest das sollte jetzt schonmal leer in der HA-Proxy, in dem Log auftauchen.

813
00:52:40,450 --> 00:52:40,950
Ja.

814
00:52:42,450 --> 00:52:43,450
War für eine Zeit weg.

815
00:52:43,450 --> 00:52:44,950
Haben drei Zeilen Bash bisher gereicht?

816
00:52:45,450 --> 00:52:45,950
Naja...

817
00:52:46,450 --> 00:52:49,950
Drei Zeilen Bash ist vielleicht ein bisschen übertrieben gewesen.

818
00:52:49,950 --> 00:52:51,950
Aber mit 20 kommen wir vielleicht hin.

819
00:52:52,950 --> 00:52:54,450
Mal gucken.

820
00:52:54,450 --> 00:52:54,950
So.

821
00:52:54,950 --> 00:52:56,950
Ne, ich glaub mit 20 kommen wir auch nicht ganz hin.

822
00:52:57,450 --> 00:52:57,950
So.

823
00:52:57,950 --> 00:52:59,950
Jetzt muss ich mir dort erstmal rausholen.

824
00:53:00,450 --> 00:53:02,260
Warte mal hier.

825
00:53:02,260 --> 00:53:02,760
Echo.

826
00:53:02,760 --> 00:53:03,260
Selected.

827
00:53:03,260 --> 00:53:05,260
Was steht denn da jetzt drinnen nochmal?

828
00:53:06,760 --> 00:53:07,760
Was steht drinnen?

829
00:53:08,260 --> 00:53:08,760
Das da.

830
00:53:08,760 --> 00:53:09,260
Okay.

831
00:53:09,760 --> 00:53:10,760
Also, das heißt...

832
00:53:11,260 --> 00:53:12,760
Das cutten wir...

833
00:53:14,260 --> 00:53:15,260
An einem Leerzeichen.

834
00:53:15,260 --> 00:53:16,760
Nehmen dann Feld 1.

835
00:53:17,760 --> 00:53:19,260
Und das wird unser...

836
00:53:19,260 --> 00:53:20,260
Unser Target.

837
00:53:20,260 --> 00:53:20,760
Oder Selected.

838
00:53:21,260 --> 00:53:21,760
Oder...

839
00:53:21,760 --> 00:53:22,260
Ach, wie auch immer.

840
00:53:22,260 --> 00:53:23,260
Mein Endpoint.

841
00:53:24,760 --> 00:53:25,260
Ne, wenn...

842
00:53:25,260 --> 00:53:25,760
Wenn...

843
00:53:25,760 --> 00:53:27,760
Ist doch wurscht, wie das heißt.

844
00:53:29,760 --> 00:53:30,260
So.

845
00:53:30,260 --> 00:53:30,760
Target.

846
00:53:31,760 --> 00:53:33,760
Also das, wo wir dann im Endeffekt...

847
00:53:34,760 --> 00:53:36,260
Was wir ausgewählt haben.

848
00:53:36,760 --> 00:53:38,260
Dann brauchen wir das gleiche nochmal.

849
00:53:38,260 --> 00:53:39,260
Und das nennen wir...

850
00:53:39,260 --> 00:53:39,760
Die...

851
00:53:39,760 --> 00:53:40,260
Ist die Block I...

852
00:53:40,260 --> 00:53:41,260
Ne, falsch rum.

853
00:53:41,760 --> 00:53:42,760
Das ist das Target.

854
00:53:42,760 --> 00:53:43,260
Das ist die Block...

855
00:53:43,760 --> 00:53:44,260
Oder?

856
00:53:44,760 --> 00:53:45,260
Ja.

857
00:53:45,760 --> 00:53:46,260
So.

858
00:53:47,760 --> 00:53:48,760
Block ID.

859
00:53:51,390 --> 00:53:51,890
Target.

860
00:53:51,890 --> 00:53:52,390
Gut.

861
00:53:52,390 --> 00:53:53,890
Gucken wir mal, ob das bis hierhin funzt.

862
00:53:55,390 --> 00:53:55,890
Okay.

863
00:53:55,890 --> 00:53:56,890
Block ist der höchste.

864
00:53:57,890 --> 00:53:59,390
7, 8 ist der höchste.

865
00:53:59,390 --> 00:53:59,890
Lass mal...

866
00:53:59,890 --> 00:54:00,390
Mach mal...

867
00:54:00,390 --> 00:54:00,890
Ich mach...

868
00:54:00,890 --> 00:54:01,390
Ich mach mal kurz aus.

869
00:54:01,390 --> 00:54:01,890
Ich mach mal kurz aus.

870
00:54:02,390 --> 00:54:02,890
7, 6.

871
00:54:02,890 --> 00:54:04,390
Guck mal, wie gut das funktioniert.

872
00:54:10,620 --> 00:54:11,620
Guck mal, wie gut das funktioniert.

873
00:54:13,120 --> 00:54:16,620
Erst Rest und Endpoint in Selected kombinieren und dann wieder splitten.

874
00:54:19,060 --> 00:54:19,560
Aber geht das denn...

875
00:54:19,560 --> 00:54:21,060
Geht das denn anders irgendwie?

876
00:54:23,130 --> 00:54:25,130
Ne, das muss ich kombinieren, damit ich es...

877
00:54:25,630 --> 00:54:27,130
Damit ich es sortieren kann.

878
00:54:27,630 --> 00:54:30,130
Und danach, wenn ich das Ergebnis hab, will ich es wieder splitten.

879
00:54:30,630 --> 00:54:31,130
Ja, Bash...

880
00:54:31,130 --> 00:54:36,130
Bash ist halt ein bisschen pepeger in der Richtung, aber muss ich halt dran gewöhnen mal.

881
00:54:36,630 --> 00:54:42,630
Wenn man ne Zeit lang mit Linux unterwegs ist, denkt man so ein bisschen in Bash-Logik schon.

882
00:54:50,390 --> 00:54:50,890
Okay.

883
00:54:54,360 --> 00:54:54,860
Dann...

884
00:54:57,880 --> 00:54:59,380
Wollen wir das so überhaupt ausgeben?

885
00:55:02,660 --> 00:55:03,160
Ich hab ne Idee.

886
00:55:03,160 --> 00:55:04,660
Wir machen nochmal nen If.

887
00:55:05,660 --> 00:55:06,660
Wir machen nochmal nen If.

888
00:55:07,160 --> 00:55:08,660
Und gucken jetzt, ob Target...

889
00:55:09,660 --> 00:55:10,660
Ob Target leer ist.

890
00:55:11,660 --> 00:55:12,660
Weil Target ist...

891
00:55:12,660 --> 00:55:13,660
Wobei, ja...

892
00:55:14,160 --> 00:55:14,660
Ist...

893
00:55:14,660 --> 00:55:15,160
Ja, doch.

894
00:55:15,660 --> 00:55:16,660
Target ist leer.

895
00:55:17,660 --> 00:55:18,660
Klar, muss ja leer sein.

896
00:55:19,160 --> 00:55:19,660
Wenn er nix...

897
00:55:19,660 --> 00:55:20,160
Wenn er nix...

898
00:55:20,160 --> 00:55:20,660
Wenn...

899
00:55:20,660 --> 00:55:21,160
Wenn die Backends...

900
00:55:21,660 --> 00:55:23,660
Wenn die Backends down sind, dann ist es leer.

901
00:55:24,160 --> 00:55:24,660
Ja?

902
00:55:25,160 --> 00:55:25,660
Dann...

903
00:55:25,660 --> 00:55:26,160
Dann...

904
00:55:26,160 --> 00:55:26,660
Dann machen wir das so.

905
00:55:26,660 --> 00:55:27,160
Wir gucken...

906
00:55:27,160 --> 00:55:28,160
Wir gucken, ob Target leer ist.

907
00:55:28,660 --> 00:55:31,160
Wenn Target leer ist, dann geben wir aus...

908
00:55:31,660 --> 00:55:32,160
Ähm...

909
00:55:32,660 --> 00:55:34,660
No valid backend found.

910
00:55:37,930 --> 00:55:40,930
Und wenn es...

911
00:55:41,430 --> 00:55:42,930
Nicht leer ist...

912
00:55:43,930 --> 00:55:44,930
Dann...

913
00:55:47,830 --> 00:55:48,830
Geben wir aus...

914
00:55:49,330 --> 00:55:50,330
Block...

915
00:55:50,330 --> 00:55:50,830
Und...

916
00:55:52,330 --> 00:55:52,830
Backend.

917
00:55:52,830 --> 00:55:53,330
So...

918
00:55:55,590 --> 00:55:58,090
Nenn das einfach jetzt nicht Target, sondern Backend.

919
00:56:04,320 --> 00:56:05,820
Ja, weil ansonsten...

920
00:56:08,400 --> 00:56:08,900
So...

921
00:56:11,410 --> 00:56:11,910
So, funzt...

922
00:56:11,910 --> 00:56:12,910
Funzt das jetzt schon mal.

923
00:56:12,910 --> 00:56:13,910
Lasst uns mal checken.

924
00:56:15,410 --> 00:56:15,910
Backend...

925
00:56:15,910 --> 00:56:16,910
Backend 80...

926
00:56:16,910 --> 00:56:17,410
80...

927
00:56:17,410 --> 00:56:17,910
80...

928
00:56:17,910 --> 00:56:18,410
Okay.

929
00:56:18,410 --> 00:56:18,910
Aus.

930
00:56:19,910 --> 00:56:20,410
81...

931
00:56:20,410 --> 00:56:20,910
Ah...

932
00:56:20,910 --> 00:56:21,910
8001 wird select.

933
00:56:21,910 --> 00:56:22,410
Und jetzt...

934
00:56:22,410 --> 00:56:23,910
Pass auf, jetzt mach ich mal beides aus.

935
00:56:26,480 --> 00:56:30,480
Wie gehen denn eigentlich die Clients damit um, wenn die Session gekillt wird, weil das Backend sich wechselt?

936
00:56:30,480 --> 00:56:30,980
Äh...

937
00:56:30,980 --> 00:56:31,480
Die werden wahrscheinlich...

938
00:56:31,480 --> 00:56:31,980
Äh...

939
00:56:31,980 --> 00:56:32,480
Timeouten.

940
00:56:34,790 --> 00:56:35,290
Vermutlich.

941
00:56:38,820 --> 00:56:39,320
Wenn das...

942
00:56:39,320 --> 00:56:39,820
Wenn das Stick...

943
00:56:40,320 --> 00:56:41,320
Wobei, ich weiß es gar nicht.

944
00:56:42,320 --> 00:56:43,320
Eine gute Frage.

945
00:56:45,890 --> 00:56:47,390
Weil, werden die Timeouten?

946
00:56:51,560 --> 00:56:53,060
Die machen ja immer neue Requests.

947
00:56:53,560 --> 00:56:56,140
Ach...

948
00:56:56,140 --> 00:56:56,640
Da...

949
00:56:56,640 --> 00:56:57,140
Muss man mal gucken.

950
00:57:01,050 --> 00:57:02,050
Ja, die machen neue Requests.

951
00:57:02,050 --> 00:57:04,050
Der nächste Request geht dann halt dahin.

952
00:57:04,550 --> 00:57:06,050
HTTP ist zustandslos.

953
00:57:07,550 --> 00:57:12,550
Ich meine, die könnten natürlich eine bestehende TCP-Verbindung benutzen, um irgendwie über Websocket oder sowas.

954
00:57:12,550 --> 00:57:15,550
Dann wird es wahrscheinlich abkacken.

955
00:57:15,550 --> 00:57:16,050
Ja.

956
00:57:16,050 --> 00:57:16,550
Oh ja.

957
00:57:16,550 --> 00:57:17,050
Gut.

958
00:57:17,050 --> 00:57:18,550
Dann Timeout und das Bauen neu auf.

959
00:57:18,550 --> 00:57:19,550
Gut ist.

960
00:57:19,550 --> 00:57:25,590
Aber ich meine, wenn das Backend ausgeschaltet wird, dann ist es halt...

961
00:57:25,590 --> 00:57:26,590
Ist halt weg.

962
00:57:26,590 --> 00:57:31,080
In dem Fall...

963
00:57:31,080 --> 00:57:32,080
In dem Fall wird es halt...

964
00:57:32,080 --> 00:57:33,080
Wird es halt aus...

965
00:57:33,080 --> 00:57:34,080
Ausgeschaltet.

966
00:57:35,080 --> 00:57:36,080
Müssen wir mal gucken.

967
00:57:36,080 --> 00:57:40,080
Das ist ja nur so eine rudimentäre so Implementierung jetzt.

968
00:57:40,080 --> 00:57:43,080
Kann man bestimmt noch verfeinern, wenn man das möchte.

969
00:57:43,080 --> 00:57:44,080
Ja.

970
00:57:44,080 --> 00:57:47,030
Das ist ein Backend.

971
00:57:47,030 --> 00:57:48,030
So, jetzt schalten wir mal aus.

972
00:57:48,030 --> 00:57:49,030
Mal gucken, was dann passiert.

973
00:57:49,030 --> 00:57:50,030
So.

974
00:57:50,030 --> 00:57:52,030
No valid Backend Found.

975
00:57:52,030 --> 00:57:53,030
Guck mal.

976
00:57:53,030 --> 00:57:55,030
Unser Custom Health Check.

977
00:57:55,030 --> 00:57:57,030
Der ist gar nicht mal so kacke.

978
00:57:57,030 --> 00:57:59,030
Schalten wir mal wieder eins ein.

979
00:57:59,030 --> 00:58:01,030
Schalten wir mal das hier ein.

980
00:58:01,030 --> 00:58:02,030
Ups.

981
00:58:02,030 --> 00:58:06,130
Ja.

982
00:58:06,130 --> 00:58:08,130
Und schalten wir mal das hier ein.

983
00:58:08,130 --> 00:58:10,130
Jetzt hatten wir den anderen.

984
00:58:10,130 --> 00:58:11,130
Zack.

985
00:58:11,130 --> 00:58:12,130
Okay.

986
00:58:12,130 --> 00:58:13,130
Ich muss sagen, Leute.

987
00:58:13,130 --> 00:58:15,130
Das funktioniert wirklich erstaunlich gut.

988
00:58:15,130 --> 00:58:17,130
Das hätte ich jetzt gar nicht so gedacht.

989
00:58:19,130 --> 00:58:21,130
Das funktioniert gar nicht mal so schlecht.

990
00:58:22,130 --> 00:58:23,130
So.

991
00:58:23,130 --> 00:58:24,130
Und jetzt?

992
00:58:24,130 --> 00:58:25,130
Jetzt ist die Frage.

993
00:58:25,130 --> 00:58:26,130
Moment.

994
00:58:26,130 --> 00:58:27,130
Moment.

995
00:58:27,130 --> 00:58:30,130
Wir haben, glaube ich, eine wichtige Sache noch vergessen.

996
00:58:30,130 --> 00:58:35,130
Das ist ja alles nur Textausgabe bisher.

997
00:58:35,130 --> 00:58:47,790
Wir müssen jetzt noch gucken, ob das ausgewählte Backend das Backend ist, was von HAproxy gerade

998
00:58:47,790 --> 00:58:48,790
gecheckt wird.

999
00:58:48,790 --> 00:58:52,790
Wenn es das ist, dann soll es aktiv sein.

1000
00:58:52,790 --> 00:58:54,790
Wenn es das nicht ist, dann nicht.

1001
00:58:54,790 --> 00:59:04,790
Ich glaube, anhand des Return Codes kann man sagen, ob HAproxy das anschalten soll oder nicht.

1002
00:59:04,790 --> 00:59:05,790
Hier.

1003
00:59:05,790 --> 00:59:06,790
Guck mal.

1004
00:59:06,790 --> 00:59:07,790
Hier.

1005
00:59:07,790 --> 00:59:08,790
Hier.

1006
00:59:08,790 --> 00:59:09,790
Hier steht irgendwas.

1007
00:59:09,790 --> 00:59:10,790
Exit Code 0 for a healthy Server.

1008
00:59:10,790 --> 00:59:11,790
Okay.

1009
00:59:11,790 --> 00:59:12,790
Also, machen wir mal irgendwie.

1010
00:59:12,790 --> 00:59:15,790
Ich weiß noch nicht, was ich für eine Bedingung brauche.

1011
00:59:15,790 --> 00:59:16,790
If true.

1012
00:59:16,790 --> 00:59:19,790
Also, if was auch immer dann da reinkommt.

1013
00:59:19,790 --> 00:59:20,790
So.

1014
00:59:20,790 --> 00:59:22,790
Und dann sagen wir so was wie hier Exit 0.

1015
00:59:22,790 --> 00:59:23,790
Und dann so beides.

1016
00:59:23,790 --> 00:59:24,790
Und dann so beides.

1017
00:59:24,790 --> 00:59:25,790
Können wir doch eigentlich viel.

1018
00:59:25,790 --> 00:59:26,790
Warte mal.

1019
00:59:26,790 --> 00:59:29,790
Wie macht man das in Bash jetzt schön?

1020
00:59:29,790 --> 00:59:33,480
Wie würde man das?

1021
00:59:33,480 --> 00:59:42,400
Also, ich meine, wir könnten so schreiben.

1022
00:59:42,400 --> 00:59:43,400
Oder 255.

1023
00:59:43,400 --> 00:59:46,400
Aber das kann man doch in Bash bestimmt.

1024
00:59:46,400 --> 00:59:50,400
Das kann man doch in Bash bestimmt kurzer und knackiger schreiben, oder?

1025
00:59:50,400 --> 00:59:55,400
In irgendeiner anderen Programmiersprache würde ich jetzt so was machen.

1026
00:59:55,400 --> 00:59:56,400
Hier irgendwie Exit.

1027
00:59:56,400 --> 00:59:58,400
Und ja, hier keine Ahnung.

1028
00:59:58,400 --> 00:59:59,400
Bedingungen.

1029
00:59:59,400 --> 01:00:01,910
Bedingungen.

1030
01:00:01,910 --> 01:00:02,910
So irgendwie.

1031
01:00:02,910 --> 01:00:03,910
Null.

1032
01:00:03,910 --> 01:00:06,910
Aber ich glaube, das geht in Bash nicht.

1033
01:00:06,910 --> 01:00:07,910
Bash.

1034
01:00:07,910 --> 01:00:08,910
Ternary Operator.

1035
01:00:08,910 --> 01:00:09,910
Hat Bash so was?

1036
01:00:09,910 --> 01:00:13,500
Ja, Andreas.

1037
01:00:13,500 --> 01:00:14,500
Das ist gar nicht schlecht.

1038
01:00:14,500 --> 01:00:15,500
Dieses Short.

1039
01:00:15,500 --> 01:00:16,500
Diese.

1040
01:00:16,500 --> 01:00:25,850
If.

1041
01:00:25,850 --> 01:00:26,850
If.

1042
01:00:26,850 --> 01:00:27,850
Kurz.

1043
01:00:27,850 --> 01:00:28,850
Moment.

1044
01:00:28,850 --> 01:00:29,850
Bash hat so was?

1045
01:00:29,850 --> 01:00:30,850
Wirklich?

1046
01:00:30,850 --> 01:00:31,850
Wait a minute.

1047
01:00:31,850 --> 01:00:39,160
Bash hat so was?

1048
01:00:39,160 --> 01:00:40,160
Ach.

1049
01:00:40,160 --> 01:00:41,160
Only with numbers.

1050
01:00:41,160 --> 01:00:44,880
Okay.

1051
01:00:44,880 --> 01:00:45,880
Okay.

1052
01:00:45,880 --> 01:00:46,880
Okay.

1053
01:00:46,880 --> 01:00:47,880
Okay.

1054
01:00:47,880 --> 01:00:57,360
Okay.

1055
01:00:57,360 --> 01:00:58,360
Okay.

1056
01:00:58,360 --> 01:00:59,360
Das, Haus.

1057
01:00:59,360 --> 01:01:00,360
Okay.

1058
01:01:00,360 --> 01:01:01,360
Das.

1059
01:01:01,360 --> 01:01:02,360
Okay.

1060
01:01:02,360 --> 01:01:09,920
Okay.

1061
01:01:09,920 --> 01:01:10,920
Okay.

1062
01:01:10,920 --> 01:01:11,920
Okay.

1063
01:01:11,920 --> 01:01:12,920
Ja.

1064
01:01:12,920 --> 01:01:13,920
Ja, das, da wäre ich auch drauf gekommen.

1065
01:01:13,920 --> 01:01:26,570
Wir können auch einfach ein If da stehen lassen und gut ist.

1066
01:01:26,570 --> 01:01:29,880
Jetzt ist die Frage, was wir eigentlich checken wollen.

1067
01:01:29,880 --> 01:01:30,880
Wir wollen checken, ob.

1068
01:01:30,880 --> 01:01:32,880
Lasst uns das mal doch in If schreiben.

1069
01:01:32,880 --> 01:01:35,880
Wir wollen checken, ob Dollar Backend, gleich, gleich, ich weiß, dass das so in Bash nicht

1070
01:01:35,880 --> 01:01:36,880
geht.

1071
01:01:36,880 --> 01:01:38,880
Checkhost und Checkport.

1072
01:01:41,140 --> 01:01:42,060
Checkhost.

1073
01:01:44,000 --> 01:01:44,920
Checkport.

1074
01:01:51,020 --> 01:01:51,440
Warte mal.

1075
01:01:51,880 --> 01:01:53,020
Bash String

1076
01:01:53,020 --> 01:01:54,560
Compare.

1077
01:01:55,780 --> 01:01:57,440
Auto Compare Strings in Bash.

1078
01:01:59,800 --> 01:02:01,780
Das ist nämlich, glaube ich, ein einfaches

1079
01:02:01,780 --> 01:02:02,200
Gleich.

1080
01:02:06,220 --> 01:02:08,040
Ach, mit Bash Magic.

1081
01:02:08,200 --> 01:02:09,540
Doppelten, doppelten Klammern.

1082
01:02:09,980 --> 01:02:11,880
Ja, Bash ist auch nicht die schönste Sprache, ne?

1083
01:02:12,240 --> 01:02:14,100
Chat, was sagt ihr? Was findet ihr

1084
01:02:14,100 --> 01:02:14,880
optisch hübscher?

1085
01:02:15,720 --> 01:02:16,480
Bash oder Rust?

1086
01:02:17,860 --> 01:02:19,480
Ich weiß, es ist eine schwierige Wahl.

1087
01:02:19,740 --> 01:02:21,620
Ist beides ziemlich hässlich.

1088
01:02:22,240 --> 01:02:23,840
So, wie geht das jetzt weiter?

1089
01:02:25,300 --> 01:02:25,880
Check if...

1090
01:02:25,880 --> 01:02:27,440
Ach, ne. Doch nur ein...

1091
01:02:27,440 --> 01:02:27,820
Moment.

1092
01:02:29,480 --> 01:02:30,620
Ey, zweifach mit

1093
01:02:30,620 --> 01:02:32,940
Bash, aber uff, ja.

1094
01:02:33,260 --> 01:02:33,940
Finde ich auch.

1095
01:02:35,180 --> 01:02:36,980
Okay, dann stimmt das sogar, was ich hier

1096
01:02:36,980 --> 01:02:38,120
fabriziert hab.

1097
01:02:39,960 --> 01:02:40,340
Okay.

1098
01:02:43,380 --> 01:02:44,900
Und was sagt ihr? Wir müssen das

1099
01:02:44,900 --> 01:02:45,600
eindampfen.

1100
01:02:45,740 --> 01:02:51,840
Wir müssen das eindampfen

1101
01:02:51,840 --> 01:02:53,100
in One-Liner, weil

1102
01:02:53,100 --> 01:02:59,220
Bash...

1103
01:02:59,220 --> 01:03:07,820
Äh...

1104
01:03:07,820 --> 01:03:11,190
Ähm...

1105
01:03:11,190 --> 01:03:13,090
Observer 2 ist down?

1106
01:03:14,070 --> 01:03:14,570
Warum?

1107
01:03:21,300 --> 01:03:23,280
Ich bin verwirrt, Leute.

1108
01:03:24,660 --> 01:03:24,880
Ja.

1109
01:03:32,910 --> 01:03:34,210
Ach, weil der niedriger ist.

1110
01:03:34,530 --> 01:03:35,430
Ja, das ist ja auch korrekt.

1111
01:03:36,370 --> 01:03:37,390
Das ist ja auch richtig so.

1112
01:03:38,750 --> 01:03:40,010
Das ist ja auch richtig so.

1113
01:03:40,990 --> 01:03:42,090
Das ist ja der Held.

1114
01:03:42,090 --> 01:03:43,870
Genau deswegen mach ich das ja auch.

1115
01:03:44,310 --> 01:03:45,250
Haha, lol.

1116
01:03:46,070 --> 01:03:48,710
Wunderbar. Weißt du, der ganze Sinn

1117
01:03:48,710 --> 01:03:50,230
der Geschichte ist, dass ein Server

1118
01:03:50,230 --> 01:03:52,790
down ist, aber nein, das ist verwundert sein.

1119
01:03:53,850 --> 01:03:53,970
Ja.

1120
01:03:54,250 --> 01:03:56,170
Das ist genau das, was ich haben wollte, ja.

1121
01:03:57,270 --> 01:03:57,510
Ja.

1122
01:03:58,110 --> 01:04:00,290
Ja, das funktioniert. Das funktioniert tatsächlich.

1123
01:04:00,410 --> 01:04:01,830
Guck mal. Jetzt machen wir den aus.

1124
01:04:03,530 --> 01:04:04,770
Moment, ich hab den falschen...

1125
01:04:04,770 --> 01:04:06,250
falschen ausgeschaltet.

1126
01:04:06,870 --> 01:04:08,570
Jetzt, jetzt, jetzt, jetzt machen wir

1127
01:04:08,570 --> 01:04:09,330
den hier aus.

1128
01:04:10,830 --> 01:04:11,470
Und jetzt

1129
01:04:11,470 --> 01:04:13,070
switcht das rüber. So.

1130
01:04:14,310 --> 01:04:16,210
Guck, jetzt kommen meine Requests

1131
01:04:16,210 --> 01:04:18,090
hier raus. Oder auch nicht.

1132
01:04:18,490 --> 01:04:20,110
Oh. Ach, Moment. Ich muss

1133
01:04:20,110 --> 01:04:22,070
auf 80, 80 gehen. Ist ja auch falsch.

1134
01:04:23,050 --> 01:04:24,110
Jetzt kommen meine Requests

1135
01:04:24,110 --> 01:04:25,850
hier raus. Jetzt

1136
01:04:25,850 --> 01:04:28,130
kommen meine Requests nirgendwo raus.

1137
01:04:28,690 --> 01:04:30,070
Und jetzt kommen meine Requests

1138
01:04:30,070 --> 01:04:31,330
auf 8000 raus.

1139
01:04:32,270 --> 01:04:34,210
Naja. So, jetzt kommen wir auf Request 8000.

1140
01:04:34,650 --> 01:04:36,410
So. Und wenn ich den hier anmache,

1141
01:04:37,790 --> 01:04:38,070
dann kommen

1142
01:04:38,070 --> 01:04:39,410
meine Requests oben raus.

1143
01:04:39,950 --> 01:04:42,230
Nachdem der wieder gecheckt hat, dass der Server wieder da ist.

1144
01:04:42,810 --> 01:04:43,210
So.

1145
01:04:44,310 --> 01:04:46,270
Jetzt mach ich den unteren an

1146
01:04:46,270 --> 01:04:48,170
und dann sollten sie wieder auf die

1147
01:04:48,170 --> 01:04:49,310
8000 switchen.

1148
01:04:51,390 --> 01:04:51,870
Ups.

1149
01:04:53,470 --> 01:04:54,370
Ja, guck.

1150
01:04:54,930 --> 01:04:55,190
Und?

1151
01:04:56,390 --> 01:04:58,330
Ja, das funktioniert doch eigentlich erstaunlich

1152
01:04:58,330 --> 01:04:58,710
gut, oder?

1153
01:04:59,790 --> 01:05:02,170
Das einzige Ding, wo ich mir nicht ganz sicher bin, ist,

1154
01:05:02,290 --> 01:05:04,230
wie es mit bestehenden

1155
01:05:04,230 --> 01:05:06,390
TCP-Verbindungen aussieht, wie ihr gefragt habt.

1156
01:05:06,570 --> 01:05:08,310
Beispielsweise WebSockets oder sowas.

1157
01:05:10,570 --> 01:05:12,230
Das wird halt nicht funktionieren.

1158
01:05:13,790 --> 01:05:14,290
Dann

1159
01:05:14,290 --> 01:05:16,290
wird das Backend down genommen und

1160
01:05:16,290 --> 01:05:17,990
ist halt

1161
01:05:17,990 --> 01:05:19,210
weg.

1162
01:05:20,430 --> 01:05:22,250
Die fliegen weg im Endeffekt.

1163
01:05:25,110 --> 01:05:25,750
Da muss halt neu

1164
01:05:25,750 --> 01:05:26,690
aufgebaut werden.

1165
01:05:28,030 --> 01:05:29,790
Was ich okay finde.

1166
01:05:29,790 --> 01:05:38,630
Du könntest über

1167
01:05:38,630 --> 01:05:40,310
irgendwelche Skript-Sachen das

1168
01:05:40,310 --> 01:05:42,150
also über Sokka die Befehle

1169
01:05:42,150 --> 01:05:43,490
das Wait anpassen.

1170
01:05:45,290 --> 01:05:45,890
Ja.

1171
01:05:46,530 --> 01:05:50,850
Ja. Warum?

1172
01:05:53,100 --> 01:05:54,520
Du meinst, dass nicht dasteht, dass

1173
01:05:54,520 --> 01:05:56,280
der down ist, sondern dass der

1174
01:05:56,280 --> 01:05:56,540
quasi

1175
01:05:56,900 --> 01:05:58,560
einer kriegt Wait

1176
01:05:58,560 --> 01:06:00,880
200 und der andere 0 oder sowas.

1177
01:06:04,180 --> 01:06:05,360
Ja, das ist, das ist,

1178
01:06:05,500 --> 01:06:09,210
das wäre, das wäre

1179
01:06:09,210 --> 01:06:09,850
eine Idee.

1180
01:06:11,670 --> 01:06:13,150
Wobei ich sagen muss,

1181
01:06:15,570 --> 01:06:16,390
das funktioniert

1182
01:06:16,390 --> 01:06:18,730
jetzt ja eigentlich auch relativ gut.

1183
01:06:18,890 --> 01:06:19,010
Ja.

1184
01:06:20,670 --> 01:06:21,990
Also insofern,

1185
01:06:25,160 --> 01:06:27,000
ich tendiere, ich meine,

1186
01:06:27,000 --> 01:06:28,400
es ist doof, dass in der Ausgabe

1187
01:06:28,400 --> 01:06:30,820
drin steht, einer ist down, obwohl der noch

1188
01:06:30,820 --> 01:06:31,580
da ist, ja.

1189
01:06:36,750 --> 01:06:37,770
Aber was willst du machen?

1190
01:06:48,020 --> 01:06:50,060
Ich glaube, Wait anpassen über den Health-Check

1191
01:06:50,060 --> 01:06:50,820
ist nicht drinne.

1192
01:06:55,650 --> 01:06:57,250
Dann werden die Connections nicht

1193
01:06:57,250 --> 01:06:59,430
gekillt und die neuen Verbindungen gehen auf dein

1194
01:06:59,430 --> 01:07:00,850
gewünschtes Backend, ja.

1195
01:07:05,520 --> 01:07:10,210
Warte mal. Ja, das ist

1196
01:07:10,210 --> 01:07:11,910
eine gute Idee, das kriege ich heute, aber

1197
01:07:11,910 --> 01:07:14,110
das nehme ich auf die Reihe. Das ist eine gute

1198
01:07:14,110 --> 01:07:19,640
Idee. Ich kriege dafür

1199
01:07:19,640 --> 01:07:20,920
bestimmt keine 50k.

1200
01:07:21,540 --> 01:07:23,660
Bei mir auf der Arbeit wollen sie sich eine super teure

1201
01:07:23,660 --> 01:07:25,520
Loadbalancer-Appliance für sowas kaufen.

1202
01:07:25,940 --> 01:07:27,400
Und ich habe gesagt, das kann man auch mit

1203
01:07:27,400 --> 01:07:29,540
HA-Proxy machen und 3-Zeilen-Bash-Skript.

1204
01:07:30,600 --> 01:07:31,180
Was ich

1205
01:07:31,180 --> 01:07:33,180
was im Endeffekt, ja,

1206
01:07:35,000 --> 01:07:35,220
so

1207
01:07:35,220 --> 01:07:37,440
Proof-of-Concept-mäßig bewiesen ist,

1208
01:07:37,440 --> 01:07:38,680
dass das funktioniert, ne.

1209
01:07:40,830 --> 01:07:42,870
Ihr seht, der geht immer nur auf unten

1210
01:07:42,870 --> 01:07:44,270
rechts, meine Requests.

1211
01:07:52,250 --> 01:07:52,530
Okay.

1212
01:07:54,430 --> 01:07:56,270
Ja, dann würde ich das aber nicht als Health-Check

1213
01:07:56,270 --> 01:07:58,070
oder? Dann würde ich das nicht als

1214
01:07:58,070 --> 01:07:59,930
Health-Check machen, sondern als

1215
01:07:59,930 --> 01:08:00,430
irgendwas,

1216
01:08:01,730 --> 01:08:04,130
was außerhalb vom HA-Proxy

1217
01:08:04,130 --> 01:08:12,700
läuft. Was programmierst

1218
01:08:12,700 --> 01:08:14,780
du gerade? Ein Custom

1219
01:08:14,780 --> 01:08:16,000
Health-Check für HA-Proxy.

1220
01:08:16,440 --> 01:08:21,200
Der auch besser funktioniert, als ich es mir vorgestellt

1221
01:08:21,200 --> 01:08:25,430
habe, ehrlich gesagt. Das ist wichtig für

1222
01:08:25,430 --> 01:08:27,330
Stonks, da gebe ich dir recht. So muss das, so muss

1223
01:08:27,330 --> 01:08:31,860
das sein. So, jetzt müssen wir noch mal was anpassen an der

1224
01:08:31,860 --> 01:08:35,400
HA-Proxy-Content. Und zwar, wie kann man denn den

1225
01:08:35,400 --> 01:08:37,180
Intervall hochstellen?

1226
01:08:39,020 --> 01:08:46,380
HA-Proxy Check-Intervall, HA-Proxy Aloha.

1227
01:08:47,760 --> 01:08:58,480
Was? Moment, hatten wir nicht die HA-Proxy-Docs?

1228
01:08:58,860 --> 01:08:59,460
Okay.

1229
01:09:00,400 --> 01:09:03,850
Server. Server and

1230
01:09:03,850 --> 01:09:05,630
Default-Server-Options. Server.

1231
01:09:10,780 --> 01:09:11,800
Ja, wie, wie, Moment.

1232
01:09:12,040 --> 01:09:19,410
Check. Server.

1233
01:09:24,400 --> 01:09:24,840
Check.

1234
01:09:26,320 --> 01:09:32,780
Health-Check. Oh, ich bin zu dumm

1235
01:09:32,780 --> 01:09:33,520
in die HA-Proxy.

1236
01:09:35,100 --> 01:09:36,600
Wie macht man denn, wie macht man denn

1237
01:09:36,600 --> 01:09:39,680
Health-Check?

1238
01:09:40,880 --> 01:09:41,800
HA-Proxy

1239
01:09:41,800 --> 01:09:43,940
Check-Intervall. Da muss man

1240
01:09:43,940 --> 01:09:45,060
doch setzen können.

1241
01:09:46,420 --> 01:09:48,200
Stack. Stack-Overflow.

1242
01:09:48,200 --> 01:09:48,380
Ja.

1243
01:09:59,960 --> 01:10:05,240
Default-HA-Proxy-Option. Fallback ist 3.

1244
01:10:05,240 --> 01:10:06,440
Error-Limit.

1245
01:10:07,660 --> 01:10:09,960
Tune Health-Check-Intervall.

1246
01:10:10,440 --> 01:10:13,600
Was? Inter, Faster-Inter, Down-Inter.

1247
01:10:13,920 --> 01:10:14,400
What?

1248
01:10:16,320 --> 01:10:20,620
Inter-Parameter. Setze Intervall between two Health-Checks.

1249
01:10:23,440 --> 01:10:28,900
Milliseconds. Das übertreibt man nicht, Alter.

1250
01:10:29,800 --> 01:10:36,040
In Milliseconds, also eine Sekunde, eine Sekunde reicht

1251
01:10:36,040 --> 01:10:38,180
mir, da muss ich halt 1000 Milliseconds machen.

1252
01:10:48,100 --> 01:10:50,660
Was? Just as with every time-based parameter,

1253
01:10:50,780 --> 01:10:53,800
they can be answered in any other explicit

1254
01:10:53,800 --> 01:10:55,580
you immer. Ah, man kann auch Sekunden

1255
01:10:55,580 --> 01:10:57,720
hinschreiben, okay. Also sprich,

1256
01:10:57,840 --> 01:10:59,360
ich schreibe jetzt da hinten, was denn?

1257
01:10:59,600 --> 01:11:01,920
Inter, was haben wir, 5 Sekunden

1258
01:11:01,920 --> 01:11:02,940
oder wie? Inter.

1259
01:11:09,540 --> 01:11:11,400
Ja, viel besser, viel besser.

1260
01:11:16,770 --> 01:11:17,770
Ja, gut.

1261
01:11:17,990 --> 01:11:23,690
Gefällt mir. Das finde ich

1262
01:11:23,690 --> 01:11:25,510
äußerst nice, wie gut das

1263
01:11:25,510 --> 01:11:34,750
funktioniert. Ne, das ist, das ist

1264
01:11:34,750 --> 01:11:35,870
nicht, das ist ein anderer Hersteller.

1265
01:11:44,740 --> 01:11:46,900
Ist doch jetzt höher als Default, ja.

1266
01:11:47,060 --> 01:11:48,620
Ist es. Will ich auch.

1267
01:11:49,180 --> 01:11:50,660
Ich will es ja auch höher als Default.

1268
01:11:51,260 --> 01:11:52,780
5 Sekunden reicht dicker aus.

1269
01:11:53,520 --> 01:11:54,680
So schnell synchronisieren

1270
01:11:54,680 --> 01:11:55,200
die sich nicht.

1271
01:11:56,500 --> 01:11:57,780
Muss ja nicht so rumspammen.

1272
01:12:00,050 --> 01:12:02,610
Guck mal, das Log ist auch, es eskaliert

1273
01:12:02,610 --> 01:12:03,570
auch komplett, Alter.

1274
01:12:03,570 --> 01:12:03,970
Ähm.

1275
01:12:06,390 --> 01:12:07,550
Guck mal, HA-Proxy

1276
01:12:07,550 --> 01:12:10,980
Log, Log

1277
01:12:10,980 --> 01:12:12,300
Directory, wie kann man,

1278
01:12:15,180 --> 01:12:22,440
ja, was?

1279
01:12:23,600 --> 01:12:25,360
HA-Proxy

1280
01:12:25,360 --> 01:12:27,320
doesn't support

1281
01:12:27,320 --> 01:12:29,320
Logging to Files?

1282
01:12:29,320 --> 01:12:37,490
What? Ach, der kann nur

1283
01:12:37,490 --> 01:12:45,990
syslog. Der kann echt nur

1284
01:12:45,990 --> 01:12:52,950
syslog? Ja, ich mein, ich kann

1285
01:12:52,950 --> 01:12:54,950
den Output in eine Logdatei pipen.

1286
01:12:54,950 --> 01:12:58,710
Ja, das ist mir auch klar.

1287
01:12:58,710 --> 01:13:00,710
Aber schön ist was anderes.

1288
01:13:00,710 --> 01:13:25,680
Also, also

1289
01:13:25,680 --> 01:13:27,680
mein, das, ich mein,

1290
01:13:27,680 --> 01:13:29,680
so schlau, ups, so schlau wär ich

1291
01:13:29,680 --> 01:13:31,680
jetzt auch gewesen.

1292
01:13:31,680 --> 01:13:33,680
Ja.

1293
01:13:33,680 --> 01:13:37,000
So was machen können.

1294
01:13:37,000 --> 01:13:39,000
Guck, jetzt haben wir, haben wir ein Logfile.

1295
01:13:39,000 --> 01:13:43,480
Ganz schön spammiges Logfile.

1296
01:13:43,480 --> 01:13:50,760
Das gefällt mir aber gut.

1297
01:13:50,760 --> 01:13:52,760
Also, Leute, mal ganz im Ernst,

1298
01:13:52,760 --> 01:13:54,760
für so übers Knie gebrochene

1299
01:13:54,760 --> 01:13:56,760
Lösung, ist das doch gar

1300
01:13:56,760 --> 01:13:58,760
net übel. Ich glaub,

1301
01:13:58,760 --> 01:14:00,760
das zeigt doch

1302
01:14:00,760 --> 01:14:02,760
erstmal, dass man keine

1303
01:14:02,760 --> 01:14:04,760
50.000 Euro teure Loadbalancer braucht,

1304
01:14:04,760 --> 01:14:12,750
um sowas zu machen, oder?

1305
01:14:12,750 --> 01:14:14,750
Weil, also ich mein,

1306
01:14:14,750 --> 01:14:16,750
was haben die eigentlich auf ihrer

1307
01:14:16,750 --> 01:14:18,750
krassen Loadbalancer Appliance laufen?

1308
01:14:18,750 --> 01:14:20,750
Dann 60 Zeilen

1309
01:14:20,750 --> 01:14:22,750
Bash-Skript oder was?

1310
01:14:22,750 --> 01:14:24,750
Ein bisschen mehr muss das ja schon sein.

1311
01:14:24,750 --> 01:14:26,750
Ja, okay, sie haben ein schönes

1312
01:14:26,750 --> 01:14:28,750
React-Webinterface gebaut.

1313
01:14:28,750 --> 01:14:30,750
Drumherum.

1314
01:14:30,750 --> 01:14:32,750
Um 30 Zeilen Bash-Skript.

1315
01:14:32,750 --> 01:14:34,750
Ein bisschen advancer wird's

1316
01:14:34,750 --> 01:14:36,750
schon sein. Ja, okay.

1317
01:14:36,750 --> 01:14:38,750
So schön ist es nicht,

1318
01:14:38,750 --> 01:14:40,750
hier, dass man die HAProxy-Konf-Sicht

1319
01:14:40,750 --> 01:14:42,750
rausgribbt und sowas. Aber trotzdem,

1320
01:14:42,750 --> 01:14:44,750
mein, es funktioniert.

1321
01:14:44,750 --> 01:14:48,250
Warum nicht Caddy ohne Nginx?

1322
01:14:48,250 --> 01:14:50,250
Weil man mit HAProxy schön

1323
01:14:50,250 --> 01:14:52,250
rumbasteln kann, was Custom-Checks

1324
01:14:52,250 --> 01:14:59,600
und sowas angeht.

1325
01:14:59,600 --> 01:15:01,600
Loadbalancer is written in Rust blazingly fast.

1326
01:15:01,600 --> 01:15:11,630
Bestimmt, bestimmt.

1327
01:15:11,630 --> 01:15:13,630
Du hast recht, du hast recht.

1328
01:15:13,630 --> 01:15:15,630
Aber die Frage, die ich mir stelle,

1329
01:15:15,630 --> 01:15:20,600
warum?

1330
01:15:20,600 --> 01:15:22,600
Ich mein, das läuft ja auf dem normalen Lino.

1331
01:15:22,600 --> 01:15:24,600
Und selbst, wenn du es im Docker-Container laufen lässt,

1332
01:15:24,600 --> 01:15:26,600
installierst du dir halt Curl.

1333
01:15:26,600 --> 01:15:28,600
Ich mein, und?

1334
01:15:28,600 --> 01:15:30,600
Also,

1335
01:15:30,600 --> 01:15:32,600
ich verstehe, was du meinst.

1336
01:15:32,600 --> 01:15:34,600
Man könnte es super minimalistisch

1337
01:15:34,600 --> 01:15:36,600
machen.

1338
01:15:36,600 --> 01:15:38,600
Man könnte auch, man könnte sich da auch

1339
01:15:38,600 --> 01:15:40,600
irgendwas in Go basteln oder

1340
01:15:40,600 --> 01:15:42,600
in Rust oder in .NET

1341
01:15:42,600 --> 01:15:44,600
oder in Java oder so, was das

1342
01:15:44,600 --> 01:15:46,600
wahrscheinlich

1343
01:15:46,600 --> 01:15:48,600
ähnlich macht.

1344
01:15:48,600 --> 01:15:50,600
Pusht du das? Hab so viel

1345
01:15:50,600 --> 01:15:52,600
verpasst. Ähm, es gibt

1346
01:15:52,600 --> 01:15:54,600
nicht viel zu pushen. Ich hab nen Custom-Health-Check

1347
01:15:54,600 --> 01:15:56,600
für HAProxy gebaut. Das war's.

1348
01:15:56,600 --> 01:15:58,600
Mehr hat er nicht.

1349
01:15:58,600 --> 01:16:00,600
Und ich, also,

1350
01:16:00,600 --> 01:16:02,600
das, was

1351
01:16:02,600 --> 01:16:04,600
der Strafo,

1352
01:16:04,600 --> 01:16:06,600
was Strafo vorhin geschrieben hat,

1353
01:16:06,600 --> 01:16:08,600
das würde ich auch gern nochmal ausprobieren.

1354
01:16:08,600 --> 01:16:10,600
Dass man

1355
01:16:10,600 --> 01:16:12,600
ein Programm nebenbei laufen lässt

1356
01:16:12,600 --> 01:16:14,600
und die,

1357
01:16:14,600 --> 01:16:16,600
das Wait, also was er,

1358
01:16:16,600 --> 01:16:18,600
was er, wann er, welches

1359
01:16:18,600 --> 01:16:20,600
Backend bevorzugt.

1360
01:16:20,600 --> 01:16:22,600
Auf der anderen Seite, ich glaube

1361
01:16:22,600 --> 01:16:24,600
fast, dass es besser wäre,

1362
01:16:24,600 --> 01:16:26,600
so, also, dass es besser

1363
01:16:26,600 --> 01:16:28,600
ist, wie

1364
01:16:28,600 --> 01:16:32,490
ich das mache, weil

1365
01:16:32,490 --> 01:16:34,490
der soll ruhig

1366
01:16:34,490 --> 01:16:36,490
die Verbindung abbrechen.

1367
01:16:36,490 --> 01:16:38,490
Wenn er nämlich ne langlaufende TCP-Verbindung

1368
01:16:38,490 --> 01:16:40,490
hat und auf

1369
01:16:40,490 --> 01:16:42,490
alten outdateden Server gelandet

1370
01:16:42,490 --> 01:16:44,490
ist, dann wird die ja quasi nie

1371
01:16:44,490 --> 01:16:46,490
abgebaut. Dann ist besser,

1372
01:16:46,490 --> 01:16:48,490
die wird gekappt und die

1373
01:16:48,490 --> 01:16:50,490
andere Seite verbindet sich neu.

1374
01:16:50,490 --> 01:16:57,000
Aber eine Sache, die man

1375
01:16:57,000 --> 01:16:59,000
noch einbauen müsste hier,

1376
01:16:59,000 --> 01:17:01,000
ja, eine Sache sollte man noch einbauen,

1377
01:17:01,000 --> 01:17:03,000
nicht,

1378
01:17:03,000 --> 01:17:05,000
sag ich oft, nicht zu oft

1379
01:17:05,000 --> 01:17:07,000
switchen.

1380
01:17:07,000 --> 01:17:09,000
Ja, das wäre tatsächlich ne Sache, die man

1381
01:17:09,000 --> 01:17:11,000
noch einbauen müsste, weil

1382
01:17:11,000 --> 01:17:13,000
stellt euch mal vor,

1383
01:17:13,000 --> 01:17:15,000
beide Server sind ganz

1384
01:17:15,000 --> 01:17:20,750
knapp, sind ganz

1385
01:17:20,750 --> 01:17:22,750
knapp, gleich auf

1386
01:17:22,750 --> 01:17:24,750
und switchen

1387
01:17:24,750 --> 01:17:26,750
quasi im Sekundentakt,

1388
01:17:26,750 --> 01:17:28,750
dann würde der Health-Check

1389
01:17:28,750 --> 01:17:30,750
permanent die Verbindung, das wäre dann

1390
01:17:30,750 --> 01:17:36,300
eher nicht so geil, ja.

1391
01:17:36,300 --> 01:17:38,300
Das ist ja gerade das tolle an der Blockchain,

1392
01:17:38,300 --> 01:17:40,300
da geht nichts verloren. Im Zweifelsfall

1393
01:17:40,300 --> 01:17:45,080
synchst du und dann ist er da.

1394
01:17:45,080 --> 01:17:47,080
Alle anderen Nodes,

1395
01:17:47,080 --> 01:17:49,080
von denen du synchst, haben die ja.

1396
01:17:49,080 --> 01:17:51,080
Also, nicht zu oft

1397
01:17:51,080 --> 01:17:53,080
switchen ist auf jeden Fall, wäre

1398
01:17:53,080 --> 01:17:55,080
auf jeden Fall nicht verkehrt. Also, man

1399
01:17:55,080 --> 01:17:57,080
könnte, man könnte zum Beispiel sich noch

1400
01:17:57,080 --> 01:17:59,080
merken, wann das letzte Mal

1401
01:17:59,080 --> 01:18:03,610
geswitcht wurde und

1402
01:18:03,610 --> 01:18:05,610
für fünf Minuten nicht mal

1403
01:18:05,610 --> 01:18:07,610
switchen so. Das, das, das könnte

1404
01:18:07,610 --> 01:18:09,610
man machen, wobei er dann auch nicht

1405
01:18:09,610 --> 01:18:11,610
erkennt, ob das down ist. Da muss

1406
01:18:11,610 --> 01:18:13,610
ich mir nochmal Gedanken drüber machen,

1407
01:18:13,610 --> 01:18:19,040
aber, ja, sagen wir mal so, als

1408
01:18:19,040 --> 01:18:21,040
Proof of Concept finde ich das eigentlich ganz gut.

1409
01:18:21,040 --> 01:18:26,330
Du kannst ja einen zweistufigen

1410
01:18:26,330 --> 01:18:28,330
Check einbauen, ist Port offen? Ja, nein.

1411
01:18:28,330 --> 01:18:34,270
Ach so, du meinst, dass ich

1412
01:18:34,270 --> 01:18:36,270
prinzipiell abfackeln kann,

1413
01:18:36,270 --> 01:18:38,270
falls der, falls

1414
01:18:38,270 --> 01:18:40,270
ich unter fünf Minuten bin

1415
01:18:40,270 --> 01:18:42,270
und der wirklich ausfällt, dass er

1416
01:18:42,270 --> 01:18:44,270
dann doch auf den geht, der noch da ist.

1417
01:18:44,270 --> 01:18:56,800
Ja. Ja,

1418
01:18:56,800 --> 01:19:02,990
das, das könnte man machen.

1419
01:19:02,990 --> 01:19:04,990
Das muss ich mir nochmal durch den Kopf gehen lassen,

1420
01:19:04,990 --> 01:19:11,560
wie ich das am besten mache. Aber

1421
01:19:11,560 --> 01:19:20,960
das, das gefällt mir erstmal.

1422
01:19:20,960 --> 01:19:22,960
Und wisst ihr, was das coole ist? Wenn man jetzt,

1423
01:19:22,960 --> 01:19:24,960
wenn man irgendwie

1424
01:19:24,960 --> 01:19:26,960
fünf Server hat oder so,

1425
01:19:26,960 --> 01:19:28,960
könnte man, könnte man theoretisch auch sagen,

1426
01:19:28,960 --> 01:19:34,510
aber wie gesagt, mit dem Lua,

1427
01:19:34,510 --> 01:19:36,510
das finde ich richtig cool mit dem

1428
01:19:36,510 --> 01:19:38,510
Lua Plugin, ja, ja, ja.

1429
01:19:38,510 --> 01:19:42,200
Ich würde das wahrscheinlich in Lua auch

1430
01:19:42,200 --> 01:19:44,200
hinkriegen. Ich meine, meine Terminal

1431
01:19:44,200 --> 01:19:46,200
Config ist in Lua, ja.

1432
01:19:46,200 --> 01:19:48,200
Ist zwar nicht, ist zwar nicht die,

1433
01:19:48,200 --> 01:19:50,200
ist zwar nicht das schönste Lua, aber

1434
01:19:50,200 --> 01:19:52,200
meine Terminal Config ist in Lua.

1435
01:19:52,200 --> 01:19:54,200
So, so,

1436
01:19:54,200 --> 01:19:56,200
so ein bisschen was in Lua kriege ich zur Not hin.

1437
01:19:56,200 --> 01:20:01,500
Selbst, selbst

1438
01:20:01,500 --> 01:20:03,500
irgendein Lua Plugin gebaut.

1439
01:20:03,500 --> 01:20:10,720
Ja, da hatten wir hier den,

1440
01:20:10,720 --> 01:20:12,720
hier das, hier das Beispiel.

1441
01:20:12,720 --> 01:20:14,720
Also das Beispiel hier von denen ist ziemlich

1442
01:20:14,720 --> 01:20:16,720
gut. Hier, Backend with

1443
01:20:16,720 --> 01:20:18,720
Least, Least Connection. Hier müsste ich halt

1444
01:20:18,720 --> 01:20:20,720
in Lua den,

1445
01:20:20,720 --> 01:20:26,140
genau, hier kriegst du auch alle

1446
01:20:26,140 --> 01:20:28,140
Backend, Backend Namen und Server Namen.

1447
01:20:28,140 --> 01:20:30,140
Und hier müsste ich dann den

1448
01:20:30,140 --> 01:20:32,140
AP, die, die, die AP Abfrage

1449
01:20:32,140 --> 01:20:34,140
drin machen.

1450
01:20:34,140 --> 01:20:36,140
AProxy Lua.

1451
01:20:36,140 --> 01:20:58,970
Kann man da Curl benutzen drin?

1452
01:20:58,970 --> 01:21:00,970
Dynamic Backend Selection

1453
01:21:00,970 --> 01:21:02,970
with Lua Script. Oh, jetzt,

1454
01:21:02,970 --> 01:21:04,970
jetzt aber advanced

1455
01:21:04,970 --> 01:21:23,070
hier. Local

1456
01:21:23,070 --> 01:21:25,070
Function Pick Backend.

1457
01:21:25,070 --> 01:21:27,070
Ja,

1458
01:21:27,070 --> 01:21:32,940
genau, sowas.

1459
01:21:32,940 --> 01:21:34,940
If Backend Name Master, then

1460
01:21:34,940 --> 01:21:36,940
Filter out, Build in Backend

1461
01:21:36,940 --> 01:21:41,600
Name. Ja.

1462
01:21:41,600 --> 01:21:47,850
Ja, das ist natürlich cool. Dann hast

1463
01:21:47,850 --> 01:21:49,850
du, dann hast du Zugriff auf den

1464
01:21:49,850 --> 01:21:51,850
internen Status halt von, von

1465
01:21:51,850 --> 01:22:01,690
HA-Proxy. Ja, das

1466
01:22:01,690 --> 01:22:03,690
gefällt mir. Das, das, das bookmarke ich

1467
01:22:03,690 --> 01:22:05,690
mir mal.

1468
01:22:05,690 --> 01:22:15,920
Das finde ich nice.

1469
01:22:15,920 --> 01:22:17,920
Und, wo, ach hier.

1470
01:22:17,920 --> 01:22:19,920
TCP Connect.

1471
01:22:19,920 --> 01:22:21,920
Moment, Moment.

1472
01:22:21,920 --> 01:22:23,920
Der macht, der macht HTTP

1473
01:22:23,920 --> 01:22:25,920
von Hand, sehe ich das richtig

1474
01:22:25,920 --> 01:22:31,280
in seinem, oje.

1475
01:22:31,280 --> 01:22:33,280
Und

1476
01:22:33,280 --> 01:22:35,280
JSON Parser dann auch von Hand, oder wie?

1477
01:22:37,280 --> 01:22:39,280
Kann man da irgendwelche Lua Libs laden

1478
01:22:39,280 --> 01:22:43,480
vielleicht?

1479
01:22:43,480 --> 01:22:45,480
Lua HA-Proxy

1480
01:22:45,480 --> 01:23:11,520
JSON Parser. Da kann man

1481
01:23:11,520 --> 01:23:13,520
wahrscheinlich auch Curl aufrufen, ja.

1482
01:23:13,520 --> 01:23:23,740
Was?

1483
01:23:23,740 --> 01:23:25,740
Lua HTTP Client

1484
01:23:25,740 --> 01:23:27,740
Library for HA-Proxy. Alter,

1485
01:23:27,740 --> 01:23:29,740
was es nicht alles gibt.

1486
01:23:29,740 --> 01:23:33,310
Mann. Ich geb dir Header,

1487
01:23:33,310 --> 01:23:35,310
Alter. Was es

1488
01:23:35,310 --> 01:23:37,310
nicht alles gibt, Alter. Lua, Lua

1489
01:23:37,310 --> 01:23:39,310
HA-Proxy

1490
01:23:39,310 --> 01:23:43,580
Libraries. Meine Güte.

1491
01:23:43,580 --> 01:23:45,580
Ja, also das ist, das ist ne gute

1492
01:23:45,580 --> 01:23:47,580
Idee, das da drüber

1493
01:23:47,580 --> 01:23:49,580
zu machen. Das wäre äußerst

1494
01:23:49,580 --> 01:23:51,580
Business Enterprise.

1495
01:23:51,580 --> 01:23:56,620
Macht er das hier mit Wait?

1496
01:23:56,620 --> 01:23:58,620
Oder wie macht er das eigentlich?

1497
01:23:58,620 --> 01:24:00,620
Nee, der setzt nicht die, der

1498
01:24:00,620 --> 01:24:02,620
macht das, was ich mache.

1499
01:24:02,620 --> 01:24:04,620
Nur mit Lua.

1500
01:24:04,620 --> 01:24:19,070
Ja, weil wenn er das gleich mit Lua macht, kann ich's auch nicht machen.

1501
01:24:19,070 --> 01:24:24,360
Wenn er mit dem Bash-Script macht.

1502
01:24:24,360 --> 01:24:26,360
Also, ich werd mir nochmal Gedanken drüber machen.

1503
01:24:28,360 --> 01:24:30,360
Wie ich das, wie ich das am besten bauen kann.

1504
01:24:30,360 --> 01:24:32,360
Noch, dass der nicht, dass der

1505
01:24:32,360 --> 01:24:34,360
nicht zu oft, zu oft

1506
01:24:34,360 --> 01:24:47,850
switcht. Und dann

1507
01:24:47,850 --> 01:24:49,850
würde ich sagen, Chat,

1508
01:24:49,850 --> 01:24:51,850
das war heute kurz und knackig,

1509
01:24:51,850 --> 01:24:53,850
aber wir haben was auf die Reihe gekriegt.

1510
01:24:53,850 --> 01:24:55,850
Ich muss jeden 20 Minuten pennen.

1511
01:24:55,850 --> 01:25:00,700
Dann geh ich jetzt schon auf.

1512
01:25:00,700 --> 01:25:02,700
Und wir sehen uns morgen oder die Tage.

1513
01:25:02,700 --> 01:25:04,700
Macht's gut, bis denn. See you.
