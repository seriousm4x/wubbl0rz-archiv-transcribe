WEBVTT

02:19.950 --> 02:29.710
so da bin ich omega pock ich bin ja ich will nach dem im ort nicht suchen weil

02:29.710 --> 02:34.270
im zweifelsfall gibt es das auch natürlich gibt es omega pock was was

02:34.270 --> 02:38.530
was denke ich mir selbstverständlich gibt es omega pock so ziemlich alle

02:38.530 --> 02:42.530
emotes die ich mir so kurz oder fly ausdenken kann ist schon jemand drauf

02:42.530 --> 02:56.270
gekommen omega pock ggg aktiviert auch ein sehr

02:56.270 --> 03:00.850
beliebtes im ort wir haben glaube ich ich wurde und

03:00.850 --> 03:06.030
scheiße wir haben so unglaublich viele keck emotes das hört gar nicht mehr aus

03:06.030 --> 03:10.590
der ist auch nicht schnell business business muss sagen die sind

03:10.590 --> 03:18.340
eigentlich alle gut javascript auch nichts

03:18.340 --> 03:23.860
vergessen und das ist der twitch versuch keck w nachzumachen das hat

03:23.860 --> 03:33.980
nicht wirklich geklappt naja so jetzt waren wir ja so ein bisschen

03:33.980 --> 03:38.000
riemen richtig angelaufen ist und dann zeige ich dann erst nicht zeigen auch

03:38.000 --> 03:42.800
aber dann erzähle ich euch mal was wir werden heute etwas was kleines machen

03:42.800 --> 03:46.100
nicht ganz so kompliziert hoffe ich zumindest dass es nicht ganz so

03:46.100 --> 03:58.120
kompliziert ist ein bisschen mal ein bisschen was anderes

03:58.120 --> 04:08.030
ja beach beach music das muss jetzt

04:08.030 --> 04:25.620
sein passt optimal exzellent passt exquisit und wie war das mit wärmster

04:25.620 --> 04:33.040
september aller zeiten november ja heute habe roxy gseto danke

04:33.040 --> 04:37.880
für den sab dr pro noob sport gar kein nur halb park ans trinken ich habe es

04:37.880 --> 04:42.280
wenn es ab eine subscription gewesen aber bisher noch subscribe trinken habe

04:42.280 --> 04:46.620
ich hier steht ich bin auch schlau ich habe mir hier neue wasserflasche trinken

04:46.620 --> 04:47.340
hier stehen aber ich bin auch schlau ich habe hier wasserflasche trinken hier stehen

04:47.340 --> 04:47.440
aber ich bin auch schlau ich habe hier wasserflasche trinken hier stehen aber

04:47.500 --> 04:51.000
ich habe kein glas mit gut muss ich also das ist eine plastikflasche trinkt

04:51.000 --> 04:54.880
ich ungern raus aber immerhin für heute geht es unter daniel wieder am start

04:54.880 --> 05:05.380
daniel lul lul hd 3d für die saps leute ja und zwar ich schalte mal ich schalte

05:05.380 --> 05:10.440
man die vm an das wird das wird etwas kurzes knackiges denke ich war es ist

05:10.440 --> 05:14.620
schon 20 23 10 uhr spätestens muss ich wieder pennen deswegen müssen wir als

05:14.620 --> 05:17.340
bastel champ machen ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja

05:17.340 --> 05:52.590
ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja ja

05:52.590 --> 06:00.450
dass die kategorie hier besser ist glaubt ich glaube die kategorie hier ist besser erst mal

06:00.450 --> 06:07.110
erst mal absehen ja also ich erzähle euch jetzt einfach was und zwar bei uns auf der arbeit wir

06:07.110 --> 06:13.890
machen ja in letzter zeit relativ viele hipster block chain zeug und jetzt haltet euch mal fest

06:13.890 --> 06:21.380
haltet euch mal fest ich weiß gar nicht wo ich am besten anfangen anfange zu erzählen also ich

06:21.380 --> 06:26.900
habe euch ja schon erzählt dass das selbst betreiben diverser crypto block chain notes

06:26.900 --> 06:34.940
ziemlich pain in gachi bus ist also das ziemlich ziemlich von arsch ist die software ist übelst

06:34.940 --> 06:42.800
buggy das kackt ab die so übelst langsam und gerade gerade polygon notes sind ganz abartig

06:42.800 --> 06:50.360
zumindest zumindest sie sind jetzt sie sind es auf die glorreiche idee gekommen bzw ich glaube

06:50.360 --> 06:51.360
gar nicht dass sie wirklich auch

06:51.360 --> 06:58.680
die idee gekommen sind ich glaube ein eine eine sehr gute wie heißt das wie nennen die sich sales

06:58.680 --> 07:04.500
abteilung oder die die leute was verkaufen wollen hat ihn versucht das aufzuschätzen und zwar haben

07:04.500 --> 07:13.530
sie sich überlegt ob sie sich ja block chain ist bei design langsam ist die frage bei was langsam

07:13.530 --> 07:22.410
ja bei was zumindest war irgend so eine tolle sales abteilung hat irgendwie war was vorgestellt

07:22.410 --> 07:24.250
starbucks danke für den start

07:24.270 --> 07:30.690
wir fangen wir fangen gleich an und irgendwie sind sie jetzt was ist denn cia mu wird sowieso

07:30.690 --> 07:37.550
das so gtk teams einpassen zumindest selbst jetzt auf die glorreiche idee gekommen sie wollen sich

07:37.550 --> 07:42.730
also weil das so schwierig ist eigene eigene chlorpoints zu betreiben und die immer mal

07:42.730 --> 07:48.030
probleme machen wollen sie sich jetzt eine block ist haltet euch halt euch fest leute halten kann

07:48.030 --> 07:50.190
ein block chain tour surveillance klagenвидet tier

07:50.190 --> 07:50.230
eine lok train load balancer pi ins kinday

07:50.230 --> 07:52.190
die euch aufketzten angst nicht die dust entertainment

07:52.190 --> 07:58.410
load balancer appliance kaufen von den herstellern sage ich euch nicht von dem

07:58.410 --> 08:02.630
hersteller hat niemand irgendwas gehört bisher die machen ansonsten nix

08:02.630 --> 08:08.590
wahrscheinlich irgendwie startup eine also quasi eine premium block chain load

08:08.590 --> 08:17.430
balancer appliance die irgendwie ab 50.000 euro losgeht so und und jetzt

08:17.430 --> 08:21.410
haltet euch mal fest für was sie die benutzen wollen es ist es ist es ist

08:21.410 --> 08:24.730
blödsinn deluxe aber jetzt haltet euch mal fest für für was sie die benutzen

08:24.730 --> 08:32.630
wollen es blickser danke für den sub die wollen man angenommen man hat ja 67 wie

08:32.630 --> 08:37.490
auch immer verschiedene nodes für eine spezielle block chain ist egal was es ist

08:37.490 --> 08:41.870
ja nehmen wir mal polygon weil polygon ist recht recht beliebt in der richtung

08:41.870 --> 08:47.530
da und jetzt kommt es ja vor dass manche nodes mal out of sync gehen weil die

08:47.530 --> 08:51.390
software scheiße ist und buggy ist ja mal out of sync gehen

08:51.390 --> 08:57.390
dass die das pudel给ena nick ist so verknüttelt dass sie das die nuts maar

08:57.390 --> 09:03.930
brechen dass man was bei maintenance neu gestartet werden muss umso was und jetzt

09:03.930 --> 09:08.610
könnte man ja einfach auf die idee komme man machte einen ganz normalen路

09:08.610 --> 09:13.190
balancer vor und der fackel das ganze ab was ein normaler load balancer

09:13.190 --> 09:20.510
allerdings nicht kann ist die ap endpunkte dieser notes abzufragen und zu

09:20.510 --> 09:26.810
welcher note der neueste ist weil wie gesagt die sünden sich alle und manche

09:26.810 --> 09:31.310
sind ein bisschen schneller gesunken als andere ja also einer der notes ist halt

09:31.310 --> 09:35.730
der der den aktuellsten stand hat oftmals oder unser mama sagen wir 123

09:35.730 --> 09:39.650
not sind relativ aktuell manche hinten dran und diese super krasse premium

09:39.650 --> 09:45.450
load balancer appliance die kann halt die api endpunkte abfragen und dort

09:45.450 --> 09:50.970
checken quasi wie weit welcher not gesünd ist und da habe ich gesagt leute

09:50.970 --> 10:00.010
ganz im ernst ob es laut irgendwie habe ich das leute ganz im ernst ja wenn wir

10:00.010 --> 10:05.350
sowas haben wollen da müssen wir uns doch keine 50.000 euro premium block

10:05.350 --> 10:10.390
chain load balancer appliance kaufen da stellen wir eine proxy hin machen drei

10:10.390 --> 10:19.080
zeilen best script als health check und dann funktioniert das auch und ich

10:19.080 --> 10:26.800
habe mir gedacht ich teste jetzt mal im stream ob an der aussage überhaupt was

10:26.800 --> 10:32.880
dran ist ob das wirklich nur drei zeilen best script sind okay da so wenn es 20

10:32.880 --> 10:38.560
zeilen best script sind ist auch okay und proxys und proxys konflikt schreibe

10:38.560 --> 10:40.960
ich jetzt auch nicht einfach runter macht zu selten was dafür

10:40.960 --> 10:45.520
das wollte ich mal ausbringen aber von der idee her von der idee her muss das

10:45.520 --> 10:48.680
super simpel sein wir machen und custom health check

10:48.680 --> 10:54.080
in dem custom health check fragen wir die api endpunkte das machen wir jetzt

10:54.080 --> 10:59.840
so quasi wir bauen jetzt keine block chain sachen auf wir machen ein paar endpunkte

10:59.840 --> 11:04.640
die unterschiedliche werte liefern und da gucken wir welche so der health check

11:04.640 --> 11:09.120
fragt einfach alle unterschiedlichen api endpunkte ab sortiert die nach dem

11:09.120 --> 11:15.240
höchsten block und die api response mit dem höchsten block die wird halt

11:15.240 --> 11:18.400
selected im health check für kriegt allen traffic

11:18.680 --> 11:22.480
wir können sogar so weit gehen wir können sogar super advanced sein wir

11:22.480 --> 11:27.720
können sogar mehrere aktivieren also und ich wie gesagt ich hab gesagt

11:27.720 --> 11:35.320
leute wir brauchen keine wir brauchen keine 50 ja ich weiß nicht ob ha proxy

11:35.320 --> 11:38.520
und zählzeilen best script business enterprise genug sind

11:38.520 --> 11:44.680
ganz ehrlich die sollen die 50.000 euro lieber mir geben oder zwischen den

11:44.680 --> 11:51.870
leuten die ein projekt auf mitarbeiten aufteilen anstatt sinnlose sinnlose

11:51.870 --> 11:58.650
appliance zu kaufen die können die können leute ich habe die

11:58.650 --> 12:04.290
idee die sollen mir die 50.000 euro überweisen und dann bezahle ich meine

12:04.290 --> 12:14.000
modgis da gibt es dann gibt es dann modgis gehalt da wirst du mal sehen wir

12:14.000 --> 12:17.300
haben ein paar mods teilweise die waren jetzt irgendwie gefühlt jahre nicht mehr

12:17.300 --> 12:20.600
da da wirst du sehen die spawnen auf einmal wieder sind auf einmal alle sind

12:20.600 --> 12:28.060
sie wieder da so aktuell sind sie immer so die gleichen 45 da kommt doch der

12:28.060 --> 12:31.760
separo wieder her

12:31.920 --> 12:38.500
hat er genug kohle dann da kann er seine referendar grills beeindrucken nicht

12:38.500 --> 12:43.200
trägt 69 lange für den subs blicks aufs blicks abbox aufs krebs studieren

12:43.200 --> 12:49.800
ja jetzt jetzt will ich bloß mal testen ob das ob meine aussage stimmt dass das

12:49.800 --> 12:53.460
ja eigentlich nur ha proxy und zählzeilen best script sind das werden

12:53.460 --> 12:57.660
wir jetzt mal ausprobieren also ziel ist ich ich rekapituliere das

12:57.660 --> 13:03.940
noch mal kurz für euch wir bauen exemplarisch quasi

13:04.060 --> 13:09.340
jetzt wir starten im prinzip drei web server alle drei web server liefern auf

13:09.340 --> 13:14.680
einem api endpunkt die die gleiche response nur mit unterschiedlichen ja

13:14.680 --> 13:23.480
unterschiedlichem stand und dann bauen wir paar zeilen best script health check

13:23.480 --> 13:28.420
in herr proxy der dann den richtigen das richtige back end selected irgendwie so

13:28.420 --> 13:31.380
ich weiß selbst noch nicht genau wie das man beide way wie ich sehe hast du auch

13:31.380 --> 13:35.540
windows 11 ja leider vielleicht kannst du mir helfen ich habe folgendes probleme

13:35.540 --> 13:35.680
vielleicht kannst du mir helfen ich habe folgendes problem ich habe folgendes problem

13:35.700 --> 13:40.260
mit windows 11 wenn die app im hintergrund läuft bzw kann fokus mit

13:40.260 --> 13:40.280
mit windows 11 wenn die app im hintergrund läuft bzw kann fokus mit

13:40.280 --> 13:41.800
mit windows 11 wenn die app im hintergrund läuft bzw kann fokus mit der maus drauf ist läuft die app

13:41.800 --> 13:41.820
der maus drauf ist läuft die app

13:41.820 --> 13:48.480
der maus drauf ist läuft die app nur auf vier von 16 kursen windows magic keine

13:48.480 --> 13:48.500
nur auf vier von 16 kursen windows magic keine

13:48.500 --> 13:51.460
nur auf vier von 16 kursen windows magic keine ahnung ich habe absolut nicht den

13:51.460 --> 13:51.480
ahnung ich habe absolut nicht den

13:51.480 --> 13:54.140
ahnung ich habe absolut nicht den leisen schon mal was da abgeht stimmt

13:54.140 --> 13:54.160
leisen schon mal was da abgeht stimmt

13:54.160 --> 13:56.380
leisen schon mal was da abgeht stimmt irgendwelche energiesparen ab was du

13:56.380 --> 13:56.400
irgendwelche energiesparen ab was du

13:56.400 --> 13:57.420
irgendwelche energiesparen ab was du machen kannst du kannst deine

13:57.420 --> 13:57.440
machen kannst du kannst deine

13:57.440 --> 13:58.940
Energiespar-Settings auf

13:58.940 --> 14:01.100
Performance und Unlimited stellen.

14:02.540 --> 14:04.100
Das müsste

14:04.100 --> 14:04.760
funzen, ja.

14:07.720 --> 14:09.380
Dann geht das wahrscheinlich.

14:10.680 --> 14:11.680
So, also heute

14:11.680 --> 14:13.880
kein krasser IDE-Progress-Stells,

14:14.340 --> 14:15.840
sondern Command-Line-WIM.

14:16.100 --> 14:17.360
Wir machen mal einen neuen Ordner.

14:17.360 --> 14:19.260
Nehmen wir mal Aproxy. Wir machen es auch nicht,

14:19.340 --> 14:20.680
Leute, wir machen es auch nicht

14:20.680 --> 14:22.880
vercontainerisiert. Wir machen das ganz simpel.

14:22.980 --> 14:24.060
Oh, guck mal, ich hab hier einen Snapshot.

14:24.920 --> 14:27.260
Snapshot von was auch immer genau.

14:27.780 --> 14:28.820
Also, ich weiß nicht,

14:28.820 --> 14:31.020
was das hier ist auf dem Vorschau-Bild.

14:31.840 --> 14:33.180
Es ist nicht das, was ihr

14:33.180 --> 14:34.560
eventuell denken könntet.

14:37.550 --> 14:39.890
Man könnte das Vorschau-Bild was reininterpretieren,

14:40.010 --> 14:40.850
aber das ist es nicht.

14:41.910 --> 14:42.550
Weil das

14:42.550 --> 14:45.070
ein Vorschau-Bild von meiner Streaming-VM ist.

14:45.190 --> 14:47.350
Und da geht's nur

14:49.920 --> 14:50.680
löblich zu.

14:52.680 --> 14:53.440
Erstmal löschen.

14:56.790 --> 14:57.450
Für was setzt du den

14:57.450 --> 14:59.290
Aproxy ein? Was ist das Ziel? Kann leider nicht

14:59.290 --> 15:00.590
zurückspulen. Okay.

15:03.190 --> 15:04.390
Ich erklär's nochmal kurz.

15:06.410 --> 15:06.550
Ich

15:06.550 --> 15:07.830
erklär's nochmal kurz.

15:08.990 --> 15:10.590
Ja, die Konfektion-Taxi ist ein bisschen kryptisch.

15:10.650 --> 15:12.050
Ich erklär's nochmal kurz. Also,

15:12.630 --> 15:14.610
bei mir auf der Arbeit wollen sie sich eine 50,

15:14.730 --> 15:16.990
mindestens, mindestens, 50.000

15:16.990 --> 15:17.950
Euro teure

15:17.950 --> 15:21.530
Premium-Blockchain-Loadbalancer-

15:21.530 --> 15:22.490
Appliance kaufen.

15:24.050 --> 15:25.150
Warum das so teuer ist?

15:25.150 --> 15:26.170
Ich hab keine Ahnung.

15:27.370 --> 15:29.610
Was das im Endeffekt macht, ist folgendes.

15:30.310 --> 15:31.370
Das ist ein Loadbalancer,

15:32.150 --> 15:33.090
der

15:33.090 --> 15:35.190
die

15:35.190 --> 15:36.470
API-Endpunkte,

15:36.550 --> 15:38.350
verschiedenster, verschiedenster

15:38.350 --> 15:40.750
Blockchain-Node-Server

15:40.750 --> 15:42.790
abfragen kann, weil man die selbst

15:42.790 --> 15:43.530
hostet, ja.

15:44.610 --> 15:46.210
Und dann

15:46.210 --> 15:48.650
die Nodes, die einen

15:48.650 --> 15:50.590
besonders aktuellen Stand haben,

15:51.970 --> 15:52.530
hauptsächlich

15:52.530 --> 15:53.890
dorthin den Traffic schickt.

15:55.730 --> 15:56.690
Nee, nee, Blockchain ist

15:56.690 --> 16:00.200
voll angesagt. So.

16:00.580 --> 16:02.440
Das ist natürlich eine fertige Lösung mit

16:02.440 --> 16:04.060
einem Web-UI und ganz nice.

16:04.480 --> 16:06.060
Und ich hab heute gesagt, Jungs,

16:06.860 --> 16:08.200
eigentlich total unsinnig,

16:08.500 --> 16:09.540
das Gleiche

16:09.540 --> 16:12.520
mach ich mit HA-Proxy und 10 Zeilen

16:12.520 --> 16:15.960
Bash-Skript. Da können sie mir die

16:15.960 --> 16:17.480
50.000 Euro ja dann überweisen.

16:17.960 --> 16:19.500
Kann ich endlich mal meine Mods bezahlen.

16:21.360 --> 16:21.520
So.

16:21.960 --> 16:24.060
Und ich dachte mir, ich probier das jetzt mal im Stream

16:24.060 --> 16:26.220
aus, ob an meiner Aussage,

16:26.780 --> 16:27.940
dass man das mit

16:27.940 --> 16:29.860
HA-Proxy und 10 Zeilen Bash-Skript

16:29.860 --> 16:31.980
auch lösen kann, was die 50.000 Euro

16:31.980 --> 16:32.760
Appliance kann,

16:33.900 --> 16:35.020
ob da was dran ist.

16:37.700 --> 16:38.180
Beide

16:38.180 --> 16:39.920
Mal, was hältst du vom OpenAI-Beat?

16:39.940 --> 16:42.700
Oh, ich hab's, ich hab heute Morgen

16:42.700 --> 16:44.760
das Beheise gelesen, dass der

16:44.760 --> 16:46.480
Chef und der stellvertretende Chef

16:46.480 --> 16:47.860
irgendwie weggesetzt bei Microsoft.

16:48.180 --> 16:49.660
Microsoft irgendwie allen

16:49.660 --> 16:52.140
OpenAI-Mitarbeitern, die kündigen wollen,

16:52.560 --> 16:54.140
einen Job angeboten hat und irgendwie

16:54.140 --> 16:56.420
ein Drittel oder zwei Drittel der

16:56.420 --> 16:57.800
Belegschaft haben unterschrieben,

16:58.260 --> 17:00.440
dass sie keinen Bock mehr haben, wenn die

17:00.440 --> 17:01.740
nicht den alten Chef zurückholen.

17:02.180 --> 17:02.980
Was auch immer.

17:03.700 --> 17:05.380
Wir werden sehen, wir werden sehen.

17:05.720 --> 17:07.200
Wie findest du Security-Keys?

17:08.340 --> 17:09.940
Das ist jetzt eine äußerst allgemeine

17:09.940 --> 17:10.900
Frage.

17:12.340 --> 17:14.380
Oder meinst du sowas wie YubiKey,

17:14.380 --> 17:15.580
YubiKey und sowas?

17:15.580 --> 17:16.780
Das ist ganz praktisch.

17:18.180 --> 17:19.420
Nein, das geht mit Bash.

17:19.720 --> 17:21.780
Man kann Custom Health-Checks mit Bash machen.

17:21.780 --> 17:22.940
Das habe ich sogar schon gemacht.

17:24.640 --> 17:25.620
Ja, ist eine gute Sache.

17:26.060 --> 17:26.940
Finde ich ist eine gute Sache.

17:29.820 --> 17:31.540
Das probieren wir jetzt, das probieren wir jetzt einfach mal aus.

17:31.860 --> 17:34.080
So, Vince, ich mach mir mal, wie gesagt,

17:34.080 --> 17:36.200
wir vercontainerisieren das

17:36.200 --> 17:37.500
auch gar nicht oder sonst was.

17:37.760 --> 17:39.860
Das ist einfach direkt auf der VM und gut.

17:39.940 --> 17:42.220
Ist jetzt einfach mal Proxy und gut ist.

17:42.220 --> 17:43.440
Man muss es ja nicht übertreiben.

17:44.900 --> 17:47.780
Also ich habe gedacht, unser Setup, unser Setup zum

17:47.780 --> 17:50.080
Testen wird ganz easy.

17:50.380 --> 17:51.580
Ja, wir haben, wir haben nicht.

17:51.620 --> 17:53.180
Wir haben nur eineinhalb Stunden heute Zeit.

17:53.380 --> 17:54.520
Und das wird ganz easy.

17:54.820 --> 17:55.960
Wir machen ein Verzeichnis.

17:56.200 --> 17:58.660
Da kommt eine Proxy Conf rein.

17:58.840 --> 18:02.220
Proxy Conf muss mir gleich minimal Beispiele im Internet suchen,

18:02.220 --> 18:05.320
weil ich, weil ich die immer nicht nicht auf die Reihe kriege.

18:05.940 --> 18:08.980
Und dann machen wir, dann starten wir selber mal zwei Endpunkte.

18:09.060 --> 18:09.380
Reicht.

18:09.380 --> 18:10.960
Wenn man das Lokal mal mit zwei probiert.

18:11.860 --> 18:15.940
Wir machen hier, wir starten, wir starten zwei, zwei HTTP Server.

18:17.360 --> 18:21.260
Ein auf Port 8000 und ein auf Port 8001.

18:21.780 --> 18:22.280
Das machen wir jetzt.

18:22.280 --> 18:30.580
Das machen wir jetzt auch gleich mal nach Port 8000 und nach Port 8001.

18:30.580 --> 18:32.780
Und da drinne HTTP Server.

18:33.940 --> 18:40.700
Da starten wir jetzt ein auf Port 8000 und auf 8000, äh Moment, falsch rum, auf 8000.

18:40.700 --> 18:42.800
Eins und auf 8000.

18:42.800 --> 18:44.540
So, das ist unser Setup.

18:44.780 --> 18:56.380
Aktuell machen die beiden HTTP Server noch nix, außer ein leeres, ein leeres Directory Listing zurückzugeben.

18:56.840 --> 18:58.760
Gibt es da irgendeinen Grund für HA-Proxy?

18:58.760 --> 19:01.520
Ja, ich habe es jetzt schon dreimal erklärt, aber ich erkläre es noch einmal schnell.

19:02.300 --> 19:03.740
Der Stream, Stream fängt ja an.

19:03.980 --> 19:04.900
Was ist das für eine Shell?

19:04.900 --> 19:06.020
Nee, das ist ZSH.

19:10.420 --> 19:11.800
Also ich erkläre es noch mal kurz.

19:12.040 --> 19:15.860
Bei mir auf der Arbeit wollen sie sich eine 50.000 Euro teure,

19:15.880 --> 19:23.200
loadbalancer Appliance kaufen und ich war mal so mutig und habe gesagt, Jungs, warum kaufen wir so einen Schwachsinn?

19:23.200 --> 19:26.540
Das gleiche kann man mit HA-Proxy und 10 Zeilen Bash-Script machen.

19:26.540 --> 19:34.170
Und ich wollte jetzt mal ausprobieren, ob das etwas zu übertrieben war, meine Aussage, oder ob das wirklich geht.

19:34.170 --> 19:38.530
Ich bin mir ziemlich sicher, dass es geht, sonst hätte ich das nicht einfach erzählt.

19:38.530 --> 19:42.640
Nee, das will ich nicht.

19:42.640 --> 19:46.320
Wie gesagt, man kann Custom Bash Healthchecks machen, das weiß ich, das weiß ich.

19:46.320 --> 19:48.700
Habe ich sogar schon gemacht, aber ich weiß aus dem Kopf nicht wie.

19:48.700 --> 19:52.670
Ja, gibt's.

19:52.670 --> 19:53.170
Gibt's.

19:53.170 --> 19:55.670
Aber HA-Proxy ist POG für sowas, finde ich.

19:57.070 --> 19:59.870
Für so, für so Custom-Bastelleien finde ich das HA-Proxy gut.

19:59.870 --> 20:02.330
Also die haben alle seine Vorteile, finde ich.

20:02.330 --> 20:06.630
Cuddy hat der Vorteil, Let's Encrypts integriert und super easy aufzusetzen.

20:06.630 --> 20:09.070
Dafür sind komplizierte Resetups nicht richtig möglich.

20:09.070 --> 20:13.630
Traffic ist gut im Containerisierungsumfeld, hat aber eine abartige Upfuck-Config.

20:13.630 --> 20:16.230
Nginx ist eigentlich so ein schönes Allround-Ding.

20:16.230 --> 20:21.430
Und HA-Proxy finde ich top, wenn man, wenn man, wenn man ein bisschen Custom basteln will.

20:23.300 --> 20:23.800
Nee, ja.

20:23.800 --> 20:24.560
Habe ich mir auch schon gedacht.

20:24.760 --> 20:26.900
Die sollen mir das überweisen, dann kann ich meine Mods bezahlen.

20:29.160 --> 20:30.460
Es ist schon ganz schön wenig, oder?

20:30.720 --> 20:33.040
Dafür gibt's keinen super Premium-Business-Loadbalancer.

20:33.660 --> 20:36.980
Aber wie gesagt, die gehen ab 50.000 Euro los.

20:37.420 --> 20:40.420
Und wahrscheinlich, also das sind ja, das sind ja Hardware-Appliance-Dinger.

20:41.660 --> 20:46.220
Und da, da wird man sich wahrscheinlich auch nicht einkaufen, sondern wahrscheinlich drei oder so.

20:46.400 --> 20:47.920
Also, es ist, es ist unsinnig.

20:47.960 --> 20:48.980
Wir probieren das jetzt mal aus.

20:48.980 --> 20:51.680
Also, ich versuche, ich versuche das Ganze mal nachzustellen.

20:53.200 --> 20:55.220
Also, wir haben zwei, wir haben zwei Backends.

20:55.240 --> 20:57.720
Ja, auf Port 8000 und Port 8001.

20:58.200 --> 21:03.840
So, die Backends, die sollen, ähm, ja, wir tun mal so, als hätten die einen API-Endpunkt.

21:04.720 --> 21:06.880
Und legen jetzt einfach mal da der Datei hin.

21:07.480 --> 21:08.940
API-JSON, okay?

21:09.120 --> 21:10.200
So, API-JSON.

21:10.860 --> 21:16.560
Und da, und da kommt jetzt als, als Antwort, wenn man den Endpunkt curlt, zurück.

21:17.080 --> 21:17.480
Block.

21:18.820 --> 21:19.340
ID.

21:19.680 --> 21:20.480
Oder einfach nur Block.

21:20.480 --> 21:24.940
Wir simulieren mal die, die Krypto, Krypto-Node, API.

21:25.240 --> 21:28.040
Block-ID, so, beste, beste Block-ID.

21:28.720 --> 21:29.440
So sieht die aus.

21:31.000 --> 21:32.660
Und hier unten machen wir das Gleiche.

21:32.740 --> 21:34.040
API-Punkt-JSON.

21:34.760 --> 21:40.390
Und der liefert, so, und der liefert Block-ID.

21:40.470 --> 21:43.210
Der muss jetzt halt irgendeine, eine, eine, eine höhere liefern.

21:43.310 --> 21:46.290
Der liefert, na, Moment, jetzt habe ich Mist gemacht, ja.

21:47.570 --> 21:50.750
Äh, der liefert, keine Ahnung, hier, äh, 8.

21:51.890 --> 21:53.590
1, 1, so, irgendwie so.

21:53.590 --> 21:56.590
Also, also der Server, der auf, äh.

21:57.070 --> 22:04.610
Also, der, der Dienst, der auf 8.000 läuft, der, der liefert eine höhere, äh, äh, Block-ID über, über den Endpunkt.

22:05.210 --> 22:05.310
So.

22:06.030 --> 22:09.110
Das reicht eigentlich auch schon, was wir am Backend brauchen.

22:11.750 --> 22:13.090
So, und wenn man das jetzt curlt.

22:14.690 --> 22:20.310
API-JSON, dann kriegt man hier einmal Block, äh, 7, 6, 3.

22:20.670 --> 22:23.210
Und hier kriegt man Block 7, 8, 3.

22:23.210 --> 22:23.390
So.

22:23.770 --> 22:27.670
Also, wenn unser HA-Proxy, äh, Health-Check.

22:27.670 --> 22:34.330
Bash-Health-Check funktioniert, sollte der immer diesen Endpoint selecten, weil der die höhere Block-ID hat.

22:35.870 --> 22:36.310
Ja.

22:39.250 --> 22:40.250
Negative Latency.

22:40.930 --> 22:41.030
Ja.

22:41.730 --> 22:44.630
Genau, ich, ich returne einfach Daten, die es noch gar nicht gibt.

22:47.500 --> 22:50.560
Man hat ja gesehen, wie gut es bei Stadia lief mit Negative Latency.

22:51.360 --> 22:53.880
So, Frage an euch, Chat, hat man verstanden, was ich machen will?

22:55.240 --> 22:56.640
Kurz was trinken.

22:58.640 --> 23:00.980
Ja, stimmt, wir sollten, das sollte AI selecten.

23:00.980 --> 23:01.140
So.

23:01.140 --> 23:02.460
So ein einfaches Crep tut's nicht.

23:09.180 --> 23:09.420
Okay.

23:11.220 --> 23:11.620
Excellent.

23:12.280 --> 23:12.680
Excellent.

23:13.220 --> 23:16.980
Da müssen wir jetzt erstmal anfangen, eine HA-Proxy-Conf zu bauen.

23:17.780 --> 23:21.440
Und HA-Proxy minus C oder sowas ist es wahrscheinlich.

23:21.620 --> 23:22.300
Nein, ist es nicht.

23:24.470 --> 23:26.110
Es ist HA-Proxy minus F.

23:29.600 --> 23:31.620
Der paid respects die ganze Zeit.

23:32.680 --> 23:33.660
HA-Proxy-Conf.

23:34.040 --> 23:34.220
Gut.

23:35.540 --> 23:36.960
Dann starten wir das mal.

23:38.120 --> 23:40.040
Wie sieht so eine HA-Proxy-Conf aus?

23:40.100 --> 23:40.940
Ich kann's mir immer umsetzen.

23:41.080 --> 23:41.980
Verrecken, nicht merken.

23:42.580 --> 23:46.080
HA-Proxy-Conf-Minimal-Example.

23:50.440 --> 23:52.260
HA-Config-File-Example.

23:52.360 --> 23:54.460
HA-Proxy-Config.

23:55.100 --> 23:56.800
HA-Proxy-Basics.

24:02.940 --> 24:05.720
Ich bilde mir ein mit Frontend, das geht so gar nicht.

24:06.360 --> 24:06.840
Ja.

24:12.310 --> 24:13.910
Ja, genau, genau, genau.

24:16.860 --> 24:18.480
Der Übertreibung ist aber hier.

24:19.800 --> 24:20.820
HA-Proxy-Config.

24:20.960 --> 24:21.920
Ja, hier ist es doch.

24:22.000 --> 24:23.080
Das ist die offizielle Anleitung.

24:23.200 --> 24:23.940
Das Beste.

24:24.520 --> 24:25.420
Minimal-Config.

24:25.580 --> 24:25.960
Sehr schön.

24:26.900 --> 24:28.320
Sehr gut.

24:28.860 --> 24:29.740
Also, Minimal-Config.

24:29.920 --> 24:31.140
Mode-TCP.

24:32.280 --> 24:33.860
Und ich erkläre euch jetzt auch warum.

24:34.300 --> 24:37.560
Weil, willst du da Lua-Skripts auswählen?

24:37.620 --> 24:40.320
Nein, ich will ein Bash-Health-Check.

24:41.880 --> 24:46.020
Bash-Health-Check-Skript hinterlegen, was alle 5 Sekunden ausgeführt wird.

24:46.640 --> 24:51.440
Wenn du irgendwie eine Ahnung hast, wie man Lua-Skripts in der HA-Proxy-Lua,

24:51.440 --> 24:52.440
haben die irgendeinen Lua-Plugin?

24:52.440 --> 24:57.320
5 Ways to Extend HA-Proxy with Lua.

24:57.320 --> 25:02.210
Okay, gucken wir mal, ob das meine HA-Proxy überhaupt hat.

25:03.830 --> 25:04.650
Ja, hat's.

25:06.270 --> 25:07.930
Global Lua-Load.

25:11.520 --> 25:12.960
Und was macht das jetzt?

25:16.290 --> 25:18.330
Attaches, Converters, Action, Service...

25:18.330 --> 25:26.000
Nee, ich glaube, ich glaube, ich will kein Lua-Skript verwenden, ehrlich gesagt.

25:29.830 --> 25:37.420
Also, es ist mir, glaube ich, etwas zu High-IQ jetzt.

25:47.340 --> 25:48.100
Ich meine, das ist ein Lua-Skript.

25:48.100 --> 25:48.220
Das ist ein Lua-Skript.

25:48.220 --> 25:48.240
Das ist ein Lua-Skript.

25:48.240 --> 25:53.260
Das hier ist schon, das ist schon, ehrlich gesagt, ähnlich zu dem,

25:58.100 --> 26:02.980
das ist schon ähnlich zu dem, das muss ich mir mal speichern.

26:03.180 --> 26:13.400
Also, das ist, das ist tatsächlich sowas ähnliches, sowas ähnliches, wie ich will.

26:13.600 --> 26:15.340
Aber gucken wir mal, gucken wir mal.

26:15.780 --> 26:20.980
Also, ähm, so, wir wollen hier nicht Frontend, sondern wir wollen, glaube ich,

26:21.400 --> 26:22.160
was wollen wir denn, Listen?

26:23.180 --> 26:23.900
Wie war das?

26:24.480 --> 26:24.680
Nee.

26:25.880 --> 26:26.900
Nee, ist schon gut so.

26:27.600 --> 26:28.320
Doch, Listen.

26:28.320 --> 26:29.540
Listen, Listen, glaube ich, wollen wir.

26:29.860 --> 26:33.220
Listen, weil da kann man hier irgendwie sowas sagen, wenn ich das richtig aus dem Kopf hinkriege.

26:34.060 --> 26:34.840
Oder Sternchen?

26:35.180 --> 26:35.540
Sternchen?

26:36.060 --> 26:37.640
Irgendwie, dass es auf 8000 lauscht.

26:38.040 --> 26:39.720
Lass mal kurz checken, ob das jetzt funktioniert.

26:40.220 --> 26:42.220
HA-Proxy minus F.

26:42.760 --> 26:43.020
Nein.

26:43.380 --> 26:43.600
Was?

26:43.840 --> 26:45.320
Parsing Characters not supported.

26:45.440 --> 26:46.120
Permitted name list.

26:46.780 --> 26:47.660
Oh, wie ging das nochmal?

26:48.020 --> 26:49.700
Oder war das einfach nur Listen App?

26:49.960 --> 26:52.240
Ach, Moment, hier unten steht ja die Bind, die Bind-Adresse.

26:52.800 --> 26:55.180
Okay, HA-Proxy soll auf 8080 lauschen.

26:55.940 --> 26:57.140
Okay, HA-Proxy läuft.

26:57.140 --> 26:58.080
Gucken wir mal.

26:58.080 --> 27:01.720
HA-Proxy leitet weiter auf Port.

27:03.420 --> 27:05.280
Ähm, mein Server weiterleiten.

27:07.530 --> 27:07.870
Geht.

27:13.220 --> 27:18.730
Konnte man, konnte man die Server nicht einfach hier unten reinschreiben?

27:18.850 --> 27:19.970
Doch, ne, das ging auch.

27:20.490 --> 27:22.250
Okay, geht auf Port 8000.

27:23.950 --> 27:26.630
Okay, das sollte, das sollte jetzt schon funktionieren.

27:27.270 --> 27:27.810
Gucken wir mal.

27:28.290 --> 27:32.390
Curl, also wir gehen auf die Load, wir gehen auf die Load, auf den Load-Balancer-Endpunkt.

27:32.390 --> 27:35.390
Und wir kommen hier unten auf dem, auf Port 8000 raus.

27:35.790 --> 27:37.790
Okay, das funktioniert.

27:38.190 --> 27:40.910
Also Minimal-Config-HA-Proxy funzt schon mal.

27:44.340 --> 27:45.620
Ja, das könnte man auch machen.

27:46.080 --> 27:51.100
Aber, wie gesagt, ich, ich, ich, ich setze aktuell auf einen External-Health-Check im HA-Proxy.

27:53.100 --> 27:54.440
War da in der Aufsicht jemand, ob man...

27:55.580 --> 28:00.440
Hab ich, hab ich vor langer Zeit verwendet, hab ich aufgegeben, war mir zu, war mir zu ätzend.

28:00.940 --> 28:02.680
Deswegen hab ich jetzt das in der VM laufen.

28:06.020 --> 28:06.520
So.

28:07.520 --> 28:08.520
Dann machen wir mal...

28:08.720 --> 28:09.640
Ey, wie war das, warte mal.

28:09.900 --> 28:10.940
HA-Proxy...

28:10.940 --> 28:12.740
...External-Checks.

28:13.240 --> 28:14.440
Ich hab das schon mal gemacht.

28:15.080 --> 28:16.580
Das ist zwar schon bestimmt...

28:17.340 --> 28:18.740
...fünf Jahre oder so her.

28:19.840 --> 28:20.940
Aber ich kann mich noch...

28:21.940 --> 28:24.940
...verhältnismäßig gut für das, wie lange das her ist, dran erinnern.

28:25.300 --> 28:26.300
Also ich weiß, es gab...

28:26.640 --> 28:28.140
Genau, External-Checks...

28:28.400 --> 28:29.300
...Example.

28:30.080 --> 28:30.580
Es gibt...

28:35.020 --> 28:36.320
...genau, Option...

28:37.080 --> 28:40.020
...genau, das, genau, genau, genau, das kommt mir noch bekannt vor.

28:40.020 --> 28:41.320
Das bräu... das braucht man.

28:41.720 --> 28:43.520
Option, External-Check...

28:44.620 --> 28:48.120
...da kann man nämlich, also wenn ich das, wenn ich das noch richtig in Erinnerung habe...

28:48.720 --> 28:53.120
...dann konnte man, ich bin mir jetzt nicht sicher, ob das auf Global musste oder hierhin, ich glaub, das muss hierhin...

28:53.720 --> 28:55.520
...also man kann HA-Proxy sagen...

28:56.820 --> 28:57.320
...dass er...

28:57.820 --> 29:00.020
...also wir brauchen übrigens zwei Server im Backend, ne?

29:00.720 --> 29:03.220
Also einen auf 8001 und einen auch auf 8000.

29:03.620 --> 29:05.720
Also man kann, wenn ich das richtig im Hinterkopf habe...

29:06.720 --> 29:07.720
...HA-Proxy sagen...

29:08.420 --> 29:09.020
...führe...

29:09.720 --> 29:13.020
...einen Custom Health-Check aus, und zwar in dem Fall hier den da, den...

29:13.020 --> 29:15.020
...machen wir jetzt mal einen eigenen hier...

29:19.840 --> 29:20.340
...touch...

29:21.040 --> 29:22.440
...check.sh...

29:27.070 --> 29:27.570
...bin...

29:27.670 --> 29:28.170
...bash...

29:29.470 --> 29:30.270
...chmod...

29:31.370 --> 29:32.170
...plus x...

29:33.370 --> 29:33.870
...check...

29:34.770 --> 29:35.270
...hier...

29:36.270 --> 29:36.770
...so...

29:37.370 --> 29:37.870
...und...

29:37.970 --> 29:38.470
...ups...

29:40.470 --> 29:42.070
...so, External-Command...

29:42.370 --> 29:46.370
...so, und wenn ich das richtig zusammenkriege noch aus dem Kopf, dann ist das jetzt so...

29:47.470 --> 29:48.770
...dass HA-Proxy...

29:49.070 --> 29:52.770
...alle Sekunde oder alle fünf Sekunden, das kann man dann irgendwie einstellen...

29:54.170 --> 29:55.070
...dass der...

29:55.470 --> 29:57.270
...diesen Check ausführt...

29:58.770 --> 30:02.270
...und wenn der Check erfolgreich ist für das jeweilige Backend...

30:02.870 --> 30:06.570
...dann wird das...bleibt das aktiv, ansonsten wird das down genommen.

30:06.870 --> 30:08.570
Das heißt, alle Backends...

30:08.870 --> 30:10.370
...von denen ich nicht möchte...

30:10.670 --> 30:12.170
...dass die Traffic abbekommen...

30:13.270 --> 30:14.770
...sollen down sein.

30:14.870 --> 30:15.370
So, und...

30:15.870 --> 30:18.070
...das, das müsste, das müsste eigentlich funktionieren.

30:18.070 --> 30:18.670
Ich, ich führe mal...

30:18.670 --> 30:21.470
...HA-Proxy jetzt aus und gucke, ob es prinzipiell geht und nicht crasht...

30:21.570 --> 30:22.970
...bäm, geht kaputt.

30:23.570 --> 30:24.670
Was hat er für Schmerzen?

30:25.870 --> 30:27.370
Option External Check...

30:28.070 --> 30:31.670
...Unable to Find Global External Check.

30:32.170 --> 30:32.570
Okay.

30:34.070 --> 30:35.470
Brauche ich noch eine Global Section?

30:39.630 --> 30:40.030
Okay.

30:41.630 --> 30:42.530
Was, was hat er hier?

30:42.930 --> 30:47.030
Insecure Fork Wanted Not Enabled in the Global Section.

30:49.690 --> 30:52.290
Also, eins muss man HA-Proxy nämlich zugute halten...

30:52.290 --> 30:55.090
...die haben erstaunlich gute Docs.

30:56.190 --> 31:00.090
Sieht zwar aus wie 1995, aber die sind, sind wirklich ganz gut beschrieben.

31:00.590 --> 31:05.090
By default, HA-Proxy tries hard to prevent any threats and process creation of the...

31:05.190 --> 31:07.490
Okay, ja, das brauche ich, das ergibt Sinn.

31:08.190 --> 31:11.090
So, und wenn ich das jetzt richtig gemacht habe, dann sollte...

31:11.890 --> 31:15.490
...dieses, dieses Checkscript, schreibe mal echo123 rein...

31:15.690 --> 31:17.490
...sollte dieses Checkscript...

31:19.290 --> 31:21.690
...regelmäßig ausgeführt werden.

31:23.290 --> 31:24.290
Wird es aber nicht.

31:26.370 --> 31:26.970
Warum?

31:29.520 --> 31:35.520
Chat, wenn ihr irgendwelche Questions habt, dann schreibt es mit AdWoblos rein, weil ich muss mich gerade konzentrieren.

31:37.620 --> 31:39.720
Habe ich irgendwas vergessen?

31:41.220 --> 31:43.020
Can't use external check.

31:44.920 --> 31:46.420
Wie hat der das konfiguriert?

31:47.620 --> 31:48.220
Server...

31:48.520 --> 31:48.920
Ah!

31:50.120 --> 31:52.520
Ah, man muss Check dahinter schreiben, dass er was checkt.

31:52.720 --> 31:56.920
Ja, die Syntax, die Syntax von HA-Proxy ist etwas kryptisch.

31:57.620 --> 31:59.120
Aber es funktioniert gut.

32:00.220 --> 32:00.720
Jawoll!

32:01.020 --> 32:02.920
Okay, er führt mein Custom-Script aus.

32:03.020 --> 32:03.920
Sehr gut, sehr gut.

32:04.120 --> 32:04.920
Excellent!

32:11.290 --> 32:12.090
Das finde ich gut.

32:14.190 --> 32:16.190
Okay, und jetzt brauche ich nur noch ein Example.

32:16.590 --> 32:19.590
HA-Proxy external check.

32:20.290 --> 32:28.090
Weil, ich kann mich noch daran erinnern, da werden, genau, da werden, also da werden Variablen übergeben an das, an das Script.

32:28.490 --> 32:32.190
Anhand dessen kann man erkennen, für welchen Endpunkt das gerade ausgeführt wird.

32:32.190 --> 32:32.690
Mario!

32:32.790 --> 32:33.490
Oh, wir sind wieder am Start.

32:33.590 --> 32:34.590
Moin, danke für den Sub.

32:34.990 --> 32:36.690
How to write an external health check.

32:40.080 --> 32:41.280
External...

32:43.750 --> 32:44.250
Ach, guck mal!

32:44.750 --> 32:46.550
Hier haben, hier haben sie doch ein Beispiel für.

32:47.350 --> 32:48.850
Variablen sind...

32:49.650 --> 32:50.050
Hier.

32:50.450 --> 32:55.450
Also, $1 ist Virtual-Service-IP, also im Prinzip die IP vom Server, okay.

32:55.950 --> 32:56.450
Port...

33:00.050 --> 33:03.450
Real Server, also der eigentliche Endpunkt, der angesprochen wird.

33:05.450 --> 33:06.150
Und...

33:07.250 --> 33:09.150
Check Source IP.

33:09.350 --> 33:16.750
Check Source IP?

33:19.480 --> 33:21.680
Was soll die Check Source IP sein?

33:23.580 --> 33:25.980
Okay, wir gucken, wir gucken mal, was der HA-Proxy dazu sagt.

33:30.470 --> 33:31.870
Die IP vom Server?

33:32.370 --> 33:32.870
Ah!

33:33.570 --> 33:34.070
Ja.

33:34.970 --> 33:36.670
Das, das kann tatsächlich sein.

33:38.940 --> 33:41.140
Das, das kann tatsächlich sein, ja.

33:52.920 --> 33:53.420
Ja.

33:53.920 --> 33:56.320
Command ist der external command to run.

33:59.340 --> 34:00.840
The arguments passed...

34:01.140 --> 34:05.940
To the commands are proxy address, proxy port, server address, service port.

34:06.040 --> 34:07.240
Okay, das war's, der andere geschrieben.

34:07.340 --> 34:12.140
Andere war bestimmt JetGPT generated.

34:15.720 --> 34:18.620
Some values are also provided through environment variables.

34:18.720 --> 34:19.120
Okay.

34:19.220 --> 34:35.530
HA-Proxy address, backend ID, backend name, HA-Proxy port, server address, connection, server ID, server name,

34:35.530 --> 34:43.330
Ports, Protokoll, Pfad, ja, eigentlich nix, nix, was ich brauche.

34:44.930 --> 34:50.030
Kriegst du beim external Script alle Backends oder muss das Script sehr statisch sein?

34:50.430 --> 34:51.930
Nee, ich krieg nicht alle Backends.

34:52.130 --> 34:55.730
Aber das ist nicht schlimm, ich kenne ja alle Backends, die, die schreibe ich, die schreibe ich da rein.

34:56.030 --> 34:58.530
Ansonsten krabbe ich sie mir aus der HA-Proxy-Conf.

34:59.630 --> 35:03.130
Guck mal, ich auch mal, wir krabben uns die einfach aus der HA-Proxy-Conf, easy.

35:03.730 --> 35:04.230
Ja.

35:05.530 --> 35:20.460
Grab, server, ähm, grab, check, ah, Mist, grab, server, okay.

35:20.660 --> 35:29.260
Alter, HA-Proxy, Mensch, so, jetzt aber, ähm, und dann, cut.

35:35.880 --> 35:40.880
So, jetzt haben wir, guck, jetzt haben wir uns sogar die, jetzt haben wir uns sogar die IPs rausgeholt aus der HA-Proxy-Conf.

35:40.980 --> 35:41.880
Excellent.

35:44.420 --> 35:45.920
So, dann, dann probieren wir das mal auf.

35:45.920 --> 35:47.220
Ich, ich, ich bin gespannt.

35:47.420 --> 35:49.920
Dann machen wir das genau so, wir holen uns das hier raus.

35:51.220 --> 35:53.020
Gucken mal, ob das, ob das läuft.

35:53.220 --> 35:54.820
Easy-Hackerman-Stells, genau.

35:55.520 --> 35:56.320
Minus F.

35:57.720 --> 36:00.120
Ups, HA-Proxy, minus F.

36:00.920 --> 36:03.720
Es läuft, okay, er kriegt's, er kriegt's raus, sehr schön.

36:04.020 --> 36:04.820
Nice, du.

36:05.820 --> 36:09.920
Dann, okay, jetzt kommen die ersten an, Useless Use of Cat, ja, meinetwegen.

36:10.720 --> 36:13.120
HA-Proxy, aber ich find das einfach viel angenehmer so.

36:13.520 --> 36:15.520
So, dann nennen wir das mal Endpoints.

36:15.920 --> 36:19.920
Das ist so der beste Name, der mir einfällt dafür.

36:20.420 --> 36:23.920
Endpoints, so, Chat, Five-Hat-Time.

36:24.920 --> 36:27.420
Dann, was übergibt er für Variablen?

36:28.720 --> 36:42.120
Proxy-Adress, Proxy-Port, okay, machen wir mal sowas hier wie Service, IP, oder Service, Service-Host oder sowas, äh, Dollar 1.

36:43.420 --> 36:45.720
Service-Port.

36:45.920 --> 36:47.920
Dollar 2, was war das nächste?

36:48.920 --> 37:02.040
Server-Address, also quasi, äh, ja, Check, Check-Host, eigentlich egal.

37:02.540 --> 37:04.040
Weiß gar nicht, ob wir das überhaupt brauchen.

37:04.540 --> 37:10.040
Und Check-Port, dann zählen wir das noch hoch.

37:10.540 --> 37:14.040
Gut, jetzt bin ich mal gespannt.

37:14.540 --> 37:16.540
Erhältst du dann, welche OS könnt ihr für einen Home-Server empfehlen?

37:17.040 --> 37:19.040
Debian, nehm Debian, und gut ist.

37:20.040 --> 37:23.040
Dann sei denn du hast spezielle Anforderungen, dann eventuell was anderes.

37:24.040 --> 37:37.040
Debian, kannst auch Ubuntu nehmen, kannst auch, wenn du ganz hart drauf bist, ähm, CentOS nehmen oder sowas, aber das ist im Enterprise-Umfeld, geht mir das schon auf den Sack.

37:37.540 --> 37:40.040
Ich, ich würde einfach Default Debian nehmen, und gut ist.

37:41.040 --> 37:46.040
Ja, Rocky, genau, Rocky, einmal Linux, wenn man eher die Red Hat, Red Hat-Schiene will.

37:46.040 --> 37:49.040
So, also, was machen wir denn jetzt?

37:49.540 --> 37:56.040
Jetzt machen wir eine Schleife vor Endpoint, vor Endpoint in Endpoints.

37:56.540 --> 38:00.040
Do, Echo, Endpoint.

38:00.540 --> 38:03.040
Ah, Mann, das ist jetzt, das ist jetzt noch nicht die hohe Kunst.

38:03.540 --> 38:06.040
Wir führen das mal von Hand aus, um zu gucken, ob es funktioniert.

38:06.540 --> 38:09.040
Also, das interessiert mich nicht.

38:09.540 --> 38:12.040
Kunst, Kunst hast du wirklich?

38:12.540 --> 38:14.040
Kunst wirklich?

38:14.040 --> 38:15.040
So.

38:15.040 --> 38:18.040
So, vor Endpoint in Endpoints.

38:18.540 --> 38:20.040
Was wollen wir jetzt machen?

38:20.540 --> 38:31.360
Ich will jetzt checken, ob die Server hier, meine Web-Server-Endpunkte, also meine Web-Server, ähm, API-Endpunkte, ob die laufen.

38:31.860 --> 38:33.360
Das mache ich einfach mal mit einem Curl.

38:33.860 --> 38:35.360
Leute, ich habe ein Problem.

38:35.860 --> 38:39.360
Ich habe vorhin zwei, zwei Riesenteller Nudeln gefuttert.

38:39.860 --> 38:47.370
Ich muss mal kurz, ich muss mal kurz, auf Klo.

38:47.370 --> 38:51.900
Ich bin in fünf Minuten wieder da.

38:52.400 --> 38:55.900
Und, und dann haben wir noch eine Stunde genau Zeit, das zu vollenden.

38:56.400 --> 39:00.880
Ich bin gleich wieder da.

39:01.380 --> 43:48.160
Ich bin wieder am Start.

43:48.660 --> 43:54.550
Weiter geht's.

43:55.050 --> 44:02.040
Wo sind wir stehen geblieben?

44:02.540 --> 44:03.540
Ahem, genau.

44:04.040 --> 44:05.040
Bash, Bash-Skript.

44:05.540 --> 44:08.540
So, wir gehen alle Endpunkte aus der HA-Proxy-Config durch.

44:09.540 --> 44:12.540
Und jetzt muss ich mal überlegen, was machen wir.

44:13.040 --> 44:15.040
Ich will fest, also ich brauche hier erstmal so eine Art Health-Check.

44:15.540 --> 44:16.540
Da machen wir einfach einen Curl.

44:17.040 --> 44:18.540
So, Curl.

44:18.540 --> 44:19.540
Local Host, API.

44:20.040 --> 44:20.540
Sagen wir das immer mal korrekt.

44:21.040 --> 44:22.540
Schreiben wir mal http davor.

44:23.040 --> 44:24.040
Machen wir einen Curl.

44:24.540 --> 44:26.540
Auf 8080 läuft nichts.

44:28.040 --> 44:29.040
Weil HA-Proxy aus ist.

44:29.540 --> 44:30.040
Das ist schon mal gut.

44:30.540 --> 44:32.040
So, auf 8001 läuft was.

44:32.540 --> 44:35.040
Auf 8002 läuft nichts.

44:36.040 --> 44:39.040
Wir wollen keine Error-Ausgabe haben.

44:39.540 --> 44:40.540
Okay, gut.

44:41.540 --> 44:42.540
Und hier kriegen wir Jason zurück.

44:43.040 --> 44:44.540
Das heißt, das pipen wir nach JQ.

44:45.040 --> 44:46.540
Und holen uns...

44:47.540 --> 44:49.040
Das fällt mit Block raus.

44:49.540 --> 44:51.040
Genau das wollen wir haben.

44:51.540 --> 44:52.040
Eats.

44:56.540 --> 44:58.040
Nudeln mit Lachs, Alter.

44:59.540 --> 45:00.540
Ist klar, Leute.

45:02.600 --> 45:05.600
Ich weiß nur, weil ich euch nicht viel mehr erzähle, was ich sonst so esse.

45:06.100 --> 45:08.600
Heißt nicht, dass ich nur immer Nudeln mit Lachs-Futter...

45:09.600 --> 45:10.600
So, nehmen wir das mal so hier.

45:11.100 --> 45:12.100
Irgendwie Response.

45:14.360 --> 45:15.360
So, was brauchen wir denn jetzt?

45:15.860 --> 45:16.860
Jetzt muss ich mal kurz in mich gehen.

45:17.360 --> 45:21.360
Also, hier muss auf jeden Fall schon mal Quotes drumherum.

45:21.360 --> 45:22.860
Bin mir auch nicht ganz sicher, warum.

45:23.360 --> 45:24.360
Aber ist auf jeden Fall nicht verkehrt.

45:24.860 --> 45:26.860
Und hier kommt der Endpoint rein.

45:34.120 --> 45:36.620
Aber auch nicht auf Port 8001, sondern direkt so.

45:37.120 --> 45:41.460
Mach doch mal einen Koch-Stream.

45:41.960 --> 45:43.460
Na, ich weiß net.

45:43.960 --> 45:45.460
Ich weiß ja net.

45:45.960 --> 45:48.460
Da gibt's noch Leak im Kochdeckel oder so.

45:48.960 --> 45:49.960
Im Topfdeckel.

45:50.960 --> 45:51.960
So.

45:52.460 --> 45:53.960
Jetzt haben wir hier das Result drinne.

45:54.960 --> 45:56.460
Von diesem Curl.

45:56.960 --> 45:59.460
Die einzige Sache, wo ich mir nicht ganz sicher bin, ist...

45:59.460 --> 46:06.460
Was passiert, wenn es JSON, was der Server returnt, ein Error hat?

46:06.960 --> 46:12.460
Zumindest würde ich sagen, wir checken jetzt einfach erstmal, ob in der Response was drinne ist.

46:12.960 --> 46:14.460
Weil, ihr habt's ja gesehen...

46:14.960 --> 46:16.460
Oder wir können's ja mal ausprobieren.

46:16.960 --> 46:18.460
Okay, nix macht das JQ. Das ist gut.

46:18.960 --> 46:24.960
Also, wenn man was curlt von einem nicht erreichbaren Server, dann gibt's keine Ausgabe.

46:25.460 --> 46:26.460
Das heißt, wir checken jetzt erstmal...

46:26.960 --> 46:28.960
Leute, wenn ihr übrigens bessere Ideen habt, wie man das...

46:28.960 --> 46:33.460
Wie man das nicer machen kann, in Bash oder was ich hier mache, ne?

46:33.960 --> 46:34.960
Könnt ihr ruhig in den Chat schreiben.

46:35.460 --> 46:37.460
Vielleicht haben wir hier die richtig krassen Bash-Hackermans dabei.

46:37.960 --> 46:39.460
So, wir checken jetzt, ob...

46:41.460 --> 46:44.460
Ob das nicht leer ist.

46:47.030 --> 46:48.030
Übrigens, das ist Bash-Logik.

46:48.530 --> 46:51.030
Wer sich fragt, ein if muss man immer mit einem phi beenden.

46:51.530 --> 46:53.030
Warum? Man weiß es nicht.

46:53.530 --> 46:57.030
Und ein for beendet man mit done und nicht mit rof.

46:58.030 --> 46:59.030
Bash-Logik.

46:59.030 --> 47:01.530
Das hat sich irgendeiner vor 65 Jahren ausgedacht.

47:02.030 --> 47:03.530
Man weiß nicht mehr, warum das so ist.

47:08.100 --> 47:09.600
Letztens Video von meinem Klo gesehen, ja.

47:10.100 --> 47:12.100
Das ist so beliebt, das Video von meinem Klo,

47:12.600 --> 47:15.600
dass sogar irgendein russischer... russischer...

47:16.100 --> 47:16.600
ähm...

47:17.100 --> 47:19.600
Ja, so Sanitärhandel-Lampen...

47:20.100 --> 47:22.600
äh... russischer Sanitärhandels-Shop

47:23.100 --> 47:24.600
das Video geklaut hat davon.

47:26.660 --> 47:28.160
Und hochge... und reuploaded hat.

47:28.660 --> 47:32.670
Kann man sich nicht vorstellen, was da los ist, ne?

47:33.170 --> 47:35.670
Dass die sich selbst da einfach ein Video machen können.

47:36.170 --> 47:37.170
Vor allem auf einem russischen Channel.

47:37.670 --> 47:39.670
So ein Typ, der auf Deutsch redet und in seinem...

47:40.170 --> 47:41.170
in seinem Badezimmer ist.

47:41.670 --> 47:42.170
Komplett random.

47:42.670 --> 47:44.170
Was denken sich die Zuschauer da?

47:44.670 --> 47:45.670
Einfach mal ein Video gerippt.

47:47.800 --> 47:49.800
So, also wir testen, ob das...

47:50.300 --> 47:51.300
Ah, ich bin mir nicht ganz sicher.

47:51.800 --> 47:52.300
Okay, Chat, ich muss mal...

47:52.800 --> 47:54.300
ich muss mal überlegen, wie wir das jetzt machen.

47:56.300 --> 47:57.800
Wo findet man das Klo-Video?

47:58.300 --> 47:58.800
Auf YouTube.

47:59.300 --> 47:59.800
Wo ist es einfach bei mir?

48:00.300 --> 48:03.450
Hier.

48:03.950 --> 48:04.450
Klo.

48:04.950 --> 48:06.450
Es gibt zwei... es gibt zwei Klo-Videos.

48:06.950 --> 48:09.450
Eins von 2017, wo ich das Ding...

48:09.450 --> 48:12.760
so neu gar nicht hatte.

48:17.440 --> 48:19.440
Weil wir sind 2013 hier eingezogen.

48:19.940 --> 48:21.440
Also im Prinzip so lang... so lang habe ich das dann schon.

48:23.940 --> 48:24.440
Und...

48:25.440 --> 48:25.940
Ja.

48:26.440 --> 48:27.440
Hier habe ich Fazit gemacht.

48:27.940 --> 48:29.440
Acht Jahre Premium-Klo.

48:29.940 --> 48:43.770
Das ist richtig, ja.

48:44.270 --> 48:45.770
Ich habe mir das noch gar nicht so genau überlegt.

48:47.270 --> 48:48.270
Zumindest...

48:48.770 --> 48:51.770
Also, wenn... wenn das Ergebnis nicht leer ist, dann...

48:52.270 --> 48:53.770
geben... wir geben das einfach mal aus.

48:54.270 --> 48:55.770
Okay, wir geben das einfach mal aus.

48:55.770 --> 48:56.770
Wir geben...

48:57.270 --> 48:58.270
Leute, ich weiß...

48:58.770 --> 48:59.770
Ich weiß, wie wir das machen.

49:00.270 --> 49:01.270
Ich weiß, wie wir das machen.

49:01.770 --> 49:02.270
Pfeifert-Idee.

49:02.770 --> 49:04.270
Ich glaube, das funktioniert richtig gut.

49:04.770 --> 49:05.770
Das... das müssen wir mal ausbrennen.

49:06.270 --> 49:07.270
Okay, wir geben...

49:07.770 --> 49:09.270
Wir geben die Response aus...

49:10.270 --> 49:11.270
von dem Endpunkt.

49:12.270 --> 49:12.770
Und...

49:13.270 --> 49:14.270
dann...

49:15.270 --> 49:16.770
schreiben wir uns noch den End...

49:17.270 --> 49:18.270
Endpoint dahinter.

49:18.770 --> 49:20.770
So, und jetzt... und jetzt passt mal auf.

49:21.270 --> 49:21.770
Passt mal auf.

49:22.270 --> 49:23.270
Wenn ich das jetzt von Hand ausführe...

49:23.770 --> 49:25.270
dann kommt jetzt hier raus...

49:26.270 --> 49:27.770
der ist bei dieser Blocknummer...

49:28.270 --> 49:29.270
also, der ist bei dieser Blocknummer...

49:29.770 --> 49:30.770
und der ist bei dieser Blocknummer.

49:31.270 --> 49:32.270
Was ich jetzt machen kann, ist...

49:32.770 --> 49:33.770
ich kann das einfach...

49:34.270 --> 49:35.270
numerisch sortieren...

49:37.270 --> 49:39.270
und reverse sorten.

49:40.270 --> 49:41.270
Und dann habe ich immer...

49:42.770 --> 49:43.270
die...

49:44.770 --> 49:45.770
äh, reverse sorten?

49:49.250 --> 49:50.750
Ja, reverse sorten, genau.

49:51.250 --> 49:53.250
Dann habe ich immer... immer den höchsten...

49:54.250 --> 49:56.250
den... den Endpoint mit dem höchsten Block...

49:56.750 --> 49:57.750
als erstes.

49:58.250 --> 49:59.250
Heißt...

50:00.250 --> 50:02.750
Heißt, wir können das eigentlich so lassen...

50:03.250 --> 50:06.250
und schreiben die gesamte Schleifenausgabe...

50:09.460 --> 50:10.460
wobei, ja...

50:10.960 --> 50:12.460
Ne, das geht doch, glaube ich, noch einfach.

50:12.960 --> 50:15.960
Ich kann doch... ich kann doch theoretisch hier einfach ein sort-n-r hintendran hängen...

50:16.460 --> 50:17.960
und dann machen wir ein head-1...

50:18.460 --> 50:21.460
und nehmen immer... äh, ein head-n-1...

50:21.960 --> 50:23.460
und dann kriegen wir immer...

50:23.960 --> 50:25.460
den Endpoint raus... genau!

50:25.960 --> 50:27.960
Dann kriegen wir immer den Endpoint raus mit der höchsten...

50:27.960 --> 50:29.460
mit der höchsten... mit den höchsten Blocks.

50:29.960 --> 50:31.460
So, jetzt kriegen wir aktuell den hier raus.

50:31.960 --> 50:33.460
Jetzt schalte ich den mal aus...

50:34.460 --> 50:35.460
und jetzt kriege ich den da oben raus.

50:36.460 --> 50:37.460
Das passt doch wunderbar.

50:39.460 --> 50:40.960
Was passiert, wenn beide aus sind?

50:41.460 --> 50:42.460
Dann geht's bestimmt kaputt.

50:43.460 --> 50:45.460
Dann kommt nichts als Ausgabe.

50:45.960 --> 50:47.460
Eigentlich ziemlich gut.

50:48.960 --> 50:50.960
Easy 5k, denke ich auch.

50:51.460 --> 50:52.460
Äh, 50k.

50:53.460 --> 50:54.460
So...

50:55.460 --> 50:57.460
Und was müssen wir jetzt machen?

50:57.960 --> 51:00.970
Ähm...

51:05.910 --> 51:06.910
Ich brauche den Output nochmal.

51:07.410 --> 51:09.910
Den capturen wir auch nochmal, eine Variable.

51:10.910 --> 51:12.910
Das ist ja immer der...

51:13.910 --> 51:16.910
Endpunkt, der jetzt quasi ausgewählt wurde...

51:17.410 --> 51:19.910
mit... mit dem aktuellsten Stand.

51:20.910 --> 51:22.410
Schreibt noch eine Error-Message, ja?

51:22.910 --> 51:24.410
Nennen wir das mal selected.

51:24.910 --> 51:25.910
Se-lected.

51:26.410 --> 51:27.910
Nennen wir das mal selected.

51:29.410 --> 51:30.410
So...

51:35.230 --> 51:35.730
Und jetzt...

51:40.360 --> 51:41.860
Jetzt muss ich erstmal testen, ob das überhaupt funktioniert.

51:42.360 --> 51:42.860
Was ich hier...

51:42.860 --> 51:43.860
Was ich hier gebaut hab.

51:45.360 --> 51:45.860
Ich...

51:45.860 --> 51:49.360
Ich lass das grad nochmal kurz ausführen vom HA-Proxy und guck mal, was dann passiert.

51:50.360 --> 51:50.860
Okay, er...

51:50.860 --> 51:51.360
Er...

51:51.360 --> 51:53.360
Er fragt beide Endpunkte regelmäßig ab.

51:53.860 --> 51:54.360
Nice, nice.

51:54.360 --> 51:55.360
Das ist schonmal gut.

51:55.860 --> 51:57.860
So, dann machen wir jetzt mal eine Ausgabe.

51:57.860 --> 51:59.360
Machen wir mal irgendwie...

51:59.860 --> 52:00.360
Ähm...

52:00.360 --> 52:00.860
Ja...

52:02.360 --> 52:03.360
Highest Block...

52:05.680 --> 52:07.680
Achso, den hab ich ja gar nicht an der Stelle.

52:07.680 --> 52:09.680
Den muss ich mir erstmal irgendwie rausholen.

52:10.680 --> 52:11.680
Highest Block...

52:11.680 --> 52:12.180
Und...

52:12.180 --> 52:12.680
Und...

52:12.680 --> 52:13.180
Dann...

52:13.180 --> 52:15.180
Dann machen wir noch irgendwie...

52:16.680 --> 52:19.680
Was ich für einen Endpunkt ausgewählt hab.

52:21.680 --> 52:27.460
Äh, ja...

52:27.460 --> 52:28.460
Endpoint...

52:32.450 --> 52:33.450
Nennen wir einfach Block.

52:34.450 --> 52:34.950
Endpoint...

52:35.950 --> 52:36.450
So.

52:36.450 --> 52:39.950
Zumindest das sollte jetzt schonmal leer in der HA-Proxy, in dem Log auftauchen.

52:40.450 --> 52:40.950
Ja.

52:42.450 --> 52:43.450
War für eine Zeit weg.

52:43.450 --> 52:44.950
Haben drei Zeilen Bash bisher gereicht?

52:45.450 --> 52:45.950
Naja...

52:46.450 --> 52:49.950
Drei Zeilen Bash ist vielleicht ein bisschen übertrieben gewesen.

52:49.950 --> 52:51.950
Aber mit 20 kommen wir vielleicht hin.

52:52.950 --> 52:54.450
Mal gucken.

52:54.450 --> 52:54.950
So.

52:54.950 --> 52:56.950
Ne, ich glaub mit 20 kommen wir auch nicht ganz hin.

52:57.450 --> 52:57.950
So.

52:57.950 --> 52:59.950
Jetzt muss ich mir dort erstmal rausholen.

53:00.450 --> 53:02.260
Warte mal hier.

53:02.260 --> 53:02.760
Echo.

53:02.760 --> 53:03.260
Selected.

53:03.260 --> 53:05.260
Was steht denn da jetzt drinnen nochmal?

53:06.760 --> 53:07.760
Was steht drinnen?

53:08.260 --> 53:08.760
Das da.

53:08.760 --> 53:09.260
Okay.

53:09.760 --> 53:10.760
Also, das heißt...

53:11.260 --> 53:12.760
Das cutten wir...

53:14.260 --> 53:15.260
An einem Leerzeichen.

53:15.260 --> 53:16.760
Nehmen dann Feld 1.

53:17.760 --> 53:19.260
Und das wird unser...

53:19.260 --> 53:20.260
Unser Target.

53:20.260 --> 53:20.760
Oder Selected.

53:21.260 --> 53:21.760
Oder...

53:21.760 --> 53:22.260
Ach, wie auch immer.

53:22.260 --> 53:23.260
Mein Endpoint.

53:24.760 --> 53:25.260
Ne, wenn...

53:25.260 --> 53:25.760
Wenn...

53:25.760 --> 53:27.760
Ist doch wurscht, wie das heißt.

53:29.760 --> 53:30.260
So.

53:30.260 --> 53:30.760
Target.

53:31.760 --> 53:33.760
Also das, wo wir dann im Endeffekt...

53:34.760 --> 53:36.260
Was wir ausgewählt haben.

53:36.760 --> 53:38.260
Dann brauchen wir das gleiche nochmal.

53:38.260 --> 53:39.260
Und das nennen wir...

53:39.260 --> 53:39.760
Die...

53:39.760 --> 53:40.260
Ist die Block I...

53:40.260 --> 53:41.260
Ne, falsch rum.

53:41.760 --> 53:42.760
Das ist das Target.

53:42.760 --> 53:43.260
Das ist die Block...

53:43.760 --> 53:44.260
Oder?

53:44.760 --> 53:45.260
Ja.

53:45.760 --> 53:46.260
So.

53:47.760 --> 53:48.760
Block ID.

53:51.390 --> 53:51.890
Target.

53:51.890 --> 53:52.390
Gut.

53:52.390 --> 53:53.890
Gucken wir mal, ob das bis hierhin funzt.

53:55.390 --> 53:55.890
Okay.

53:55.890 --> 53:56.890
Block ist der höchste.

53:57.890 --> 53:59.390
7, 8 ist der höchste.

53:59.390 --> 53:59.890
Lass mal...

53:59.890 --> 54:00.390
Mach mal...

54:00.390 --> 54:00.890
Ich mach...

54:00.890 --> 54:01.390
Ich mach mal kurz aus.

54:01.390 --> 54:01.890
Ich mach mal kurz aus.

54:02.390 --> 54:02.890
7, 6.

54:02.890 --> 54:04.390
Guck mal, wie gut das funktioniert.

54:10.620 --> 54:11.620
Guck mal, wie gut das funktioniert.

54:13.120 --> 54:16.620
Erst Rest und Endpoint in Selected kombinieren und dann wieder splitten.

54:19.060 --> 54:19.560
Aber geht das denn...

54:19.560 --> 54:21.060
Geht das denn anders irgendwie?

54:23.130 --> 54:25.130
Ne, das muss ich kombinieren, damit ich es...

54:25.630 --> 54:27.130
Damit ich es sortieren kann.

54:27.630 --> 54:30.130
Und danach, wenn ich das Ergebnis hab, will ich es wieder splitten.

54:30.630 --> 54:31.130
Ja, Bash...

54:31.130 --> 54:36.130
Bash ist halt ein bisschen pepeger in der Richtung, aber muss ich halt dran gewöhnen mal.

54:36.630 --> 54:42.630
Wenn man ne Zeit lang mit Linux unterwegs ist, denkt man so ein bisschen in Bash-Logik schon.

54:50.390 --> 54:50.890
Okay.

54:54.360 --> 54:54.860
Dann...

54:57.880 --> 54:59.380
Wollen wir das so überhaupt ausgeben?

55:02.660 --> 55:03.160
Ich hab ne Idee.

55:03.160 --> 55:04.660
Wir machen nochmal nen If.

55:05.660 --> 55:06.660
Wir machen nochmal nen If.

55:07.160 --> 55:08.660
Und gucken jetzt, ob Target...

55:09.660 --> 55:10.660
Ob Target leer ist.

55:11.660 --> 55:12.660
Weil Target ist...

55:12.660 --> 55:13.660
Wobei, ja...

55:14.160 --> 55:14.660
Ist...

55:14.660 --> 55:15.160
Ja, doch.

55:15.660 --> 55:16.660
Target ist leer.

55:17.660 --> 55:18.660
Klar, muss ja leer sein.

55:19.160 --> 55:19.660
Wenn er nix...

55:19.660 --> 55:20.160
Wenn er nix...

55:20.160 --> 55:20.660
Wenn...

55:20.660 --> 55:21.160
Wenn die Backends...

55:21.660 --> 55:23.660
Wenn die Backends down sind, dann ist es leer.

55:24.160 --> 55:24.660
Ja?

55:25.160 --> 55:25.660
Dann...

55:25.660 --> 55:26.160
Dann...

55:26.160 --> 55:26.660
Dann machen wir das so.

55:26.660 --> 55:27.160
Wir gucken...

55:27.160 --> 55:28.160
Wir gucken, ob Target leer ist.

55:28.660 --> 55:31.160
Wenn Target leer ist, dann geben wir aus...

55:31.660 --> 55:32.160
Ähm...

55:32.660 --> 55:34.660
No valid backend found.

55:37.930 --> 55:40.930
Und wenn es...

55:41.430 --> 55:42.930
Nicht leer ist...

55:43.930 --> 55:44.930
Dann...

55:47.830 --> 55:48.830
Geben wir aus...

55:49.330 --> 55:50.330
Block...

55:50.330 --> 55:50.830
Und...

55:52.330 --> 55:52.830
Backend.

55:52.830 --> 55:53.330
So...

55:55.590 --> 55:58.090
Nenn das einfach jetzt nicht Target, sondern Backend.

56:04.320 --> 56:05.820
Ja, weil ansonsten...

56:08.400 --> 56:08.900
So...

56:11.410 --> 56:11.910
So, funzt...

56:11.910 --> 56:12.910
Funzt das jetzt schon mal.

56:12.910 --> 56:13.910
Lasst uns mal checken.

56:15.410 --> 56:15.910
Backend...

56:15.910 --> 56:16.910
Backend 80...

56:16.910 --> 56:17.410
80...

56:17.410 --> 56:17.910
80...

56:17.910 --> 56:18.410
Okay.

56:18.410 --> 56:18.910
Aus.

56:19.910 --> 56:20.410
81...

56:20.410 --> 56:20.910
Ah...

56:20.910 --> 56:21.910
8001 wird select.

56:21.910 --> 56:22.410
Und jetzt...

56:22.410 --> 56:23.910
Pass auf, jetzt mach ich mal beides aus.

56:26.480 --> 56:30.480
Wie gehen denn eigentlich die Clients damit um, wenn die Session gekillt wird, weil das Backend sich wechselt?

56:30.480 --> 56:30.980
Äh...

56:30.980 --> 56:31.480
Die werden wahrscheinlich...

56:31.480 --> 56:31.980
Äh...

56:31.980 --> 56:32.480
Timeouten.

56:34.790 --> 56:35.290
Vermutlich.

56:38.820 --> 56:39.320
Wenn das...

56:39.320 --> 56:39.820
Wenn das Stick...

56:40.320 --> 56:41.320
Wobei, ich weiß es gar nicht.

56:42.320 --> 56:43.320
Eine gute Frage.

56:45.890 --> 56:47.390
Weil, werden die Timeouten?

56:51.560 --> 56:53.060
Die machen ja immer neue Requests.

56:53.560 --> 56:56.140
Ach...

56:56.140 --> 56:56.640
Da...

56:56.640 --> 56:57.140
Muss man mal gucken.

57:01.050 --> 57:02.050
Ja, die machen neue Requests.

57:02.050 --> 57:04.050
Der nächste Request geht dann halt dahin.

57:04.550 --> 57:06.050
HTTP ist zustandslos.

57:07.550 --> 57:12.550
Ich meine, die könnten natürlich eine bestehende TCP-Verbindung benutzen, um irgendwie über Websocket oder sowas.

57:12.550 --> 57:15.550
Dann wird es wahrscheinlich abkacken.

57:15.550 --> 57:16.050
Ja.

57:16.050 --> 57:16.550
Oh ja.

57:16.550 --> 57:17.050
Gut.

57:17.050 --> 57:18.550
Dann Timeout und das Bauen neu auf.

57:18.550 --> 57:19.550
Gut ist.

57:19.550 --> 57:25.590
Aber ich meine, wenn das Backend ausgeschaltet wird, dann ist es halt...

57:25.590 --> 57:26.590
Ist halt weg.

57:26.590 --> 57:31.080
In dem Fall...

57:31.080 --> 57:32.080
In dem Fall wird es halt...

57:32.080 --> 57:33.080
Wird es halt aus...

57:33.080 --> 57:34.080
Ausgeschaltet.

57:35.080 --> 57:36.080
Müssen wir mal gucken.

57:36.080 --> 57:40.080
Das ist ja nur so eine rudimentäre so Implementierung jetzt.

57:40.080 --> 57:43.080
Kann man bestimmt noch verfeinern, wenn man das möchte.

57:43.080 --> 57:44.080
Ja.

57:44.080 --> 57:47.030
Das ist ein Backend.

57:47.030 --> 57:48.030
So, jetzt schalten wir mal aus.

57:48.030 --> 57:49.030
Mal gucken, was dann passiert.

57:49.030 --> 57:50.030
So.

57:50.030 --> 57:52.030
No valid Backend Found.

57:52.030 --> 57:53.030
Guck mal.

57:53.030 --> 57:55.030
Unser Custom Health Check.

57:55.030 --> 57:57.030
Der ist gar nicht mal so kacke.

57:57.030 --> 57:59.030
Schalten wir mal wieder eins ein.

57:59.030 --> 58:01.030
Schalten wir mal das hier ein.

58:01.030 --> 58:02.030
Ups.

58:02.030 --> 58:06.130
Ja.

58:06.130 --> 58:08.130
Und schalten wir mal das hier ein.

58:08.130 --> 58:10.130
Jetzt hatten wir den anderen.

58:10.130 --> 58:11.130
Zack.

58:11.130 --> 58:12.130
Okay.

58:12.130 --> 58:13.130
Ich muss sagen, Leute.

58:13.130 --> 58:15.130
Das funktioniert wirklich erstaunlich gut.

58:15.130 --> 58:17.130
Das hätte ich jetzt gar nicht so gedacht.

58:19.130 --> 58:21.130
Das funktioniert gar nicht mal so schlecht.

58:22.130 --> 58:23.130
So.

58:23.130 --> 58:24.130
Und jetzt?

58:24.130 --> 58:25.130
Jetzt ist die Frage.

58:25.130 --> 58:26.130
Moment.

58:26.130 --> 58:27.130
Moment.

58:27.130 --> 58:30.130
Wir haben, glaube ich, eine wichtige Sache noch vergessen.

58:30.130 --> 58:35.130
Das ist ja alles nur Textausgabe bisher.

58:35.130 --> 58:47.790
Wir müssen jetzt noch gucken, ob das ausgewählte Backend das Backend ist, was von HAproxy gerade

58:47.790 --> 58:48.790
gecheckt wird.

58:48.790 --> 58:52.790
Wenn es das ist, dann soll es aktiv sein.

58:52.790 --> 58:54.790
Wenn es das nicht ist, dann nicht.

58:54.790 --> 59:04.790
Ich glaube, anhand des Return Codes kann man sagen, ob HAproxy das anschalten soll oder nicht.

59:04.790 --> 59:05.790
Hier.

59:05.790 --> 59:06.790
Guck mal.

59:06.790 --> 59:07.790
Hier.

59:07.790 --> 59:08.790
Hier.

59:08.790 --> 59:09.790
Hier steht irgendwas.

59:09.790 --> 59:10.790
Exit Code 0 for a healthy Server.

59:10.790 --> 59:11.790
Okay.

59:11.790 --> 59:12.790
Also, machen wir mal irgendwie.

59:12.790 --> 59:15.790
Ich weiß noch nicht, was ich für eine Bedingung brauche.

59:15.790 --> 59:16.790
If true.

59:16.790 --> 59:19.790
Also, if was auch immer dann da reinkommt.

59:19.790 --> 59:20.790
So.

59:20.790 --> 59:22.790
Und dann sagen wir so was wie hier Exit 0.

59:22.790 --> 59:23.790
Und dann so beides.

59:23.790 --> 59:24.790
Und dann so beides.

59:24.790 --> 59:25.790
Können wir doch eigentlich viel.

59:25.790 --> 59:26.790
Warte mal.

59:26.790 --> 59:29.790
Wie macht man das in Bash jetzt schön?

59:29.790 --> 59:33.480
Wie würde man das?

59:33.480 --> 59:42.400
Also, ich meine, wir könnten so schreiben.

59:42.400 --> 59:43.400
Oder 255.

59:43.400 --> 59:46.400
Aber das kann man doch in Bash bestimmt.

59:46.400 --> 59:50.400
Das kann man doch in Bash bestimmt kurzer und knackiger schreiben, oder?

59:50.400 --> 59:55.400
In irgendeiner anderen Programmiersprache würde ich jetzt so was machen.

59:55.400 --> 59:56.400
Hier irgendwie Exit.

59:56.400 --> 59:58.400
Und ja, hier keine Ahnung.

59:58.400 --> 59:59.400
Bedingungen.

59:59.400 --> 01:00:01.910
Bedingungen.

01:00:01.910 --> 01:00:02.910
So irgendwie.

01:00:02.910 --> 01:00:03.910
Null.

01:00:03.910 --> 01:00:06.910
Aber ich glaube, das geht in Bash nicht.

01:00:06.910 --> 01:00:07.910
Bash.

01:00:07.910 --> 01:00:08.910
Ternary Operator.

01:00:08.910 --> 01:00:09.910
Hat Bash so was?

01:00:09.910 --> 01:00:13.500
Ja, Andreas.

01:00:13.500 --> 01:00:14.500
Das ist gar nicht schlecht.

01:00:14.500 --> 01:00:15.500
Dieses Short.

01:00:15.500 --> 01:00:16.500
Diese.

01:00:16.500 --> 01:00:25.850
If.

01:00:25.850 --> 01:00:26.850
If.

01:00:26.850 --> 01:00:27.850
Kurz.

01:00:27.850 --> 01:00:28.850
Moment.

01:00:28.850 --> 01:00:29.850
Bash hat so was?

01:00:29.850 --> 01:00:30.850
Wirklich?

01:00:30.850 --> 01:00:31.850
Wait a minute.

01:00:31.850 --> 01:00:39.160
Bash hat so was?

01:00:39.160 --> 01:00:40.160
Ach.

01:00:40.160 --> 01:00:41.160
Only with numbers.

01:00:41.160 --> 01:00:44.880
Okay.

01:00:44.880 --> 01:00:45.880
Okay.

01:00:45.880 --> 01:00:46.880
Okay.

01:00:46.880 --> 01:00:47.880
Okay.

01:00:47.880 --> 01:00:57.360
Okay.

01:00:57.360 --> 01:00:58.360
Okay.

01:00:58.360 --> 01:00:59.360
Das, Haus.

01:00:59.360 --> 01:01:00.360
Okay.

01:01:00.360 --> 01:01:01.360
Das.

01:01:01.360 --> 01:01:02.360
Okay.

01:01:02.360 --> 01:01:09.920
Okay.

01:01:09.920 --> 01:01:10.920
Okay.

01:01:10.920 --> 01:01:11.920
Okay.

01:01:11.920 --> 01:01:12.920
Ja.

01:01:12.920 --> 01:01:13.920
Ja, das, da wäre ich auch drauf gekommen.

01:01:13.920 --> 01:01:26.570
Wir können auch einfach ein If da stehen lassen und gut ist.

01:01:26.570 --> 01:01:29.880
Jetzt ist die Frage, was wir eigentlich checken wollen.

01:01:29.880 --> 01:01:30.880
Wir wollen checken, ob.

01:01:30.880 --> 01:01:32.880
Lasst uns das mal doch in If schreiben.

01:01:32.880 --> 01:01:35.880
Wir wollen checken, ob Dollar Backend, gleich, gleich, ich weiß, dass das so in Bash nicht

01:01:35.880 --> 01:01:36.880
geht.

01:01:36.880 --> 01:01:38.880
Checkhost und Checkport.

01:01:41.140 --> 01:01:42.060
Checkhost.

01:01:44.000 --> 01:01:44.920
Checkport.

01:01:51.020 --> 01:01:51.440
Warte mal.

01:01:51.880 --> 01:01:53.020
Bash String

01:01:53.020 --> 01:01:54.560
Compare.

01:01:55.780 --> 01:01:57.440
Auto Compare Strings in Bash.

01:01:59.800 --> 01:02:01.780
Das ist nämlich, glaube ich, ein einfaches

01:02:01.780 --> 01:02:02.200
Gleich.

01:02:06.220 --> 01:02:08.040
Ach, mit Bash Magic.

01:02:08.200 --> 01:02:09.540
Doppelten, doppelten Klammern.

01:02:09.980 --> 01:02:11.880
Ja, Bash ist auch nicht die schönste Sprache, ne?

01:02:12.240 --> 01:02:14.100
Chat, was sagt ihr? Was findet ihr

01:02:14.100 --> 01:02:14.880
optisch hübscher?

01:02:15.720 --> 01:02:16.480
Bash oder Rust?

01:02:17.860 --> 01:02:19.480
Ich weiß, es ist eine schwierige Wahl.

01:02:19.740 --> 01:02:21.620
Ist beides ziemlich hässlich.

01:02:22.240 --> 01:02:23.840
So, wie geht das jetzt weiter?

01:02:25.300 --> 01:02:25.880
Check if...

01:02:25.880 --> 01:02:27.440
Ach, ne. Doch nur ein...

01:02:27.440 --> 01:02:27.820
Moment.

01:02:29.480 --> 01:02:30.620
Ey, zweifach mit

01:02:30.620 --> 01:02:32.940
Bash, aber uff, ja.

01:02:33.260 --> 01:02:33.940
Finde ich auch.

01:02:35.180 --> 01:02:36.980
Okay, dann stimmt das sogar, was ich hier

01:02:36.980 --> 01:02:38.120
fabriziert hab.

01:02:39.960 --> 01:02:40.340
Okay.

01:02:43.380 --> 01:02:44.900
Und was sagt ihr? Wir müssen das

01:02:44.900 --> 01:02:45.600
eindampfen.

01:02:45.740 --> 01:02:51.840
Wir müssen das eindampfen

01:02:51.840 --> 01:02:53.100
in One-Liner, weil

01:02:53.100 --> 01:02:59.220
Bash...

01:02:59.220 --> 01:03:07.820
Äh...

01:03:07.820 --> 01:03:11.190
Ähm...

01:03:11.190 --> 01:03:13.090
Observer 2 ist down?

01:03:14.070 --> 01:03:14.570
Warum?

01:03:21.300 --> 01:03:23.280
Ich bin verwirrt, Leute.

01:03:24.660 --> 01:03:24.880
Ja.

01:03:32.910 --> 01:03:34.210
Ach, weil der niedriger ist.

01:03:34.530 --> 01:03:35.430
Ja, das ist ja auch korrekt.

01:03:36.370 --> 01:03:37.390
Das ist ja auch richtig so.

01:03:38.750 --> 01:03:40.010
Das ist ja auch richtig so.

01:03:40.990 --> 01:03:42.090
Das ist ja der Held.

01:03:42.090 --> 01:03:43.870
Genau deswegen mach ich das ja auch.

01:03:44.310 --> 01:03:45.250
Haha, lol.

01:03:46.070 --> 01:03:48.710
Wunderbar. Weißt du, der ganze Sinn

01:03:48.710 --> 01:03:50.230
der Geschichte ist, dass ein Server

01:03:50.230 --> 01:03:52.790
down ist, aber nein, das ist verwundert sein.

01:03:53.850 --> 01:03:53.970
Ja.

01:03:54.250 --> 01:03:56.170
Das ist genau das, was ich haben wollte, ja.

01:03:57.270 --> 01:03:57.510
Ja.

01:03:58.110 --> 01:04:00.290
Ja, das funktioniert. Das funktioniert tatsächlich.

01:04:00.410 --> 01:04:01.830
Guck mal. Jetzt machen wir den aus.

01:04:03.530 --> 01:04:04.770
Moment, ich hab den falschen...

01:04:04.770 --> 01:04:06.250
falschen ausgeschaltet.

01:04:06.870 --> 01:04:08.570
Jetzt, jetzt, jetzt, jetzt machen wir

01:04:08.570 --> 01:04:09.330
den hier aus.

01:04:10.830 --> 01:04:11.470
Und jetzt

01:04:11.470 --> 01:04:13.070
switcht das rüber. So.

01:04:14.310 --> 01:04:16.210
Guck, jetzt kommen meine Requests

01:04:16.210 --> 01:04:18.090
hier raus. Oder auch nicht.

01:04:18.490 --> 01:04:20.110
Oh. Ach, Moment. Ich muss

01:04:20.110 --> 01:04:22.070
auf 80, 80 gehen. Ist ja auch falsch.

01:04:23.050 --> 01:04:24.110
Jetzt kommen meine Requests

01:04:24.110 --> 01:04:25.850
hier raus. Jetzt

01:04:25.850 --> 01:04:28.130
kommen meine Requests nirgendwo raus.

01:04:28.690 --> 01:04:30.070
Und jetzt kommen meine Requests

01:04:30.070 --> 01:04:31.330
auf 8000 raus.

01:04:32.270 --> 01:04:34.210
Naja. So, jetzt kommen wir auf Request 8000.

01:04:34.650 --> 01:04:36.410
So. Und wenn ich den hier anmache,

01:04:37.790 --> 01:04:38.070
dann kommen

01:04:38.070 --> 01:04:39.410
meine Requests oben raus.

01:04:39.950 --> 01:04:42.230
Nachdem der wieder gecheckt hat, dass der Server wieder da ist.

01:04:42.810 --> 01:04:43.210
So.

01:04:44.310 --> 01:04:46.270
Jetzt mach ich den unteren an

01:04:46.270 --> 01:04:48.170
und dann sollten sie wieder auf die

01:04:48.170 --> 01:04:49.310
8000 switchen.

01:04:51.390 --> 01:04:51.870
Ups.

01:04:53.470 --> 01:04:54.370
Ja, guck.

01:04:54.930 --> 01:04:55.190
Und?

01:04:56.390 --> 01:04:58.330
Ja, das funktioniert doch eigentlich erstaunlich

01:04:58.330 --> 01:04:58.710
gut, oder?

01:04:59.790 --> 01:05:02.170
Das einzige Ding, wo ich mir nicht ganz sicher bin, ist,

01:05:02.290 --> 01:05:04.230
wie es mit bestehenden

01:05:04.230 --> 01:05:06.390
TCP-Verbindungen aussieht, wie ihr gefragt habt.

01:05:06.570 --> 01:05:08.310
Beispielsweise WebSockets oder sowas.

01:05:10.570 --> 01:05:12.230
Das wird halt nicht funktionieren.

01:05:13.790 --> 01:05:14.290
Dann

01:05:14.290 --> 01:05:16.290
wird das Backend down genommen und

01:05:16.290 --> 01:05:17.990
ist halt

01:05:17.990 --> 01:05:19.210
weg.

01:05:20.430 --> 01:05:22.250
Die fliegen weg im Endeffekt.

01:05:25.110 --> 01:05:25.750
Da muss halt neu

01:05:25.750 --> 01:05:26.690
aufgebaut werden.

01:05:28.030 --> 01:05:29.790
Was ich okay finde.

01:05:29.790 --> 01:05:38.630
Du könntest über

01:05:38.630 --> 01:05:40.310
irgendwelche Skript-Sachen das

01:05:40.310 --> 01:05:42.150
also über Sokka die Befehle

01:05:42.150 --> 01:05:43.490
das Wait anpassen.

01:05:45.290 --> 01:05:45.890
Ja.

01:05:46.530 --> 01:05:50.850
Ja. Warum?

01:05:53.100 --> 01:05:54.520
Du meinst, dass nicht dasteht, dass

01:05:54.520 --> 01:05:56.280
der down ist, sondern dass der

01:05:56.280 --> 01:05:56.540
quasi

01:05:56.900 --> 01:05:58.560
einer kriegt Wait

01:05:58.560 --> 01:06:00.880
200 und der andere 0 oder sowas.

01:06:04.180 --> 01:06:05.360
Ja, das ist, das ist,

01:06:05.500 --> 01:06:09.210
das wäre, das wäre

01:06:09.210 --> 01:06:09.850
eine Idee.

01:06:11.670 --> 01:06:13.150
Wobei ich sagen muss,

01:06:15.570 --> 01:06:16.390
das funktioniert

01:06:16.390 --> 01:06:18.730
jetzt ja eigentlich auch relativ gut.

01:06:18.890 --> 01:06:19.010
Ja.

01:06:20.670 --> 01:06:21.990
Also insofern,

01:06:25.160 --> 01:06:27.000
ich tendiere, ich meine,

01:06:27.000 --> 01:06:28.400
es ist doof, dass in der Ausgabe

01:06:28.400 --> 01:06:30.820
drin steht, einer ist down, obwohl der noch

01:06:30.820 --> 01:06:31.580
da ist, ja.

01:06:36.750 --> 01:06:37.770
Aber was willst du machen?

01:06:48.020 --> 01:06:50.060
Ich glaube, Wait anpassen über den Health-Check

01:06:50.060 --> 01:06:50.820
ist nicht drinne.

01:06:55.650 --> 01:06:57.250
Dann werden die Connections nicht

01:06:57.250 --> 01:06:59.430
gekillt und die neuen Verbindungen gehen auf dein

01:06:59.430 --> 01:07:00.850
gewünschtes Backend, ja.

01:07:05.520 --> 01:07:10.210
Warte mal. Ja, das ist

01:07:10.210 --> 01:07:11.910
eine gute Idee, das kriege ich heute, aber

01:07:11.910 --> 01:07:14.110
das nehme ich auf die Reihe. Das ist eine gute

01:07:14.110 --> 01:07:19.640
Idee. Ich kriege dafür

01:07:19.640 --> 01:07:20.920
bestimmt keine 50k.

01:07:21.540 --> 01:07:23.660
Bei mir auf der Arbeit wollen sie sich eine super teure

01:07:23.660 --> 01:07:25.520
Loadbalancer-Appliance für sowas kaufen.

01:07:25.940 --> 01:07:27.400
Und ich habe gesagt, das kann man auch mit

01:07:27.400 --> 01:07:29.540
HA-Proxy machen und 3-Zeilen-Bash-Skript.

01:07:30.600 --> 01:07:31.180
Was ich

01:07:31.180 --> 01:07:33.180
was im Endeffekt, ja,

01:07:35.000 --> 01:07:35.220
so

01:07:35.220 --> 01:07:37.440
Proof-of-Concept-mäßig bewiesen ist,

01:07:37.440 --> 01:07:38.680
dass das funktioniert, ne.

01:07:40.830 --> 01:07:42.870
Ihr seht, der geht immer nur auf unten

01:07:42.870 --> 01:07:44.270
rechts, meine Requests.

01:07:52.250 --> 01:07:52.530
Okay.

01:07:54.430 --> 01:07:56.270
Ja, dann würde ich das aber nicht als Health-Check

01:07:56.270 --> 01:07:58.070
oder? Dann würde ich das nicht als

01:07:58.070 --> 01:07:59.930
Health-Check machen, sondern als

01:07:59.930 --> 01:08:00.430
irgendwas,

01:08:01.730 --> 01:08:04.130
was außerhalb vom HA-Proxy

01:08:04.130 --> 01:08:12.700
läuft. Was programmierst

01:08:12.700 --> 01:08:14.780
du gerade? Ein Custom

01:08:14.780 --> 01:08:16.000
Health-Check für HA-Proxy.

01:08:16.440 --> 01:08:21.200
Der auch besser funktioniert, als ich es mir vorgestellt

01:08:21.200 --> 01:08:25.430
habe, ehrlich gesagt. Das ist wichtig für

01:08:25.430 --> 01:08:27.330
Stonks, da gebe ich dir recht. So muss das, so muss

01:08:27.330 --> 01:08:31.860
das sein. So, jetzt müssen wir noch mal was anpassen an der

01:08:31.860 --> 01:08:35.400
HA-Proxy-Content. Und zwar, wie kann man denn den

01:08:35.400 --> 01:08:37.180
Intervall hochstellen?

01:08:39.020 --> 01:08:46.380
HA-Proxy Check-Intervall, HA-Proxy Aloha.

01:08:47.760 --> 01:08:58.480
Was? Moment, hatten wir nicht die HA-Proxy-Docs?

01:08:58.860 --> 01:08:59.460
Okay.

01:09:00.400 --> 01:09:03.850
Server. Server and

01:09:03.850 --> 01:09:05.630
Default-Server-Options. Server.

01:09:10.780 --> 01:09:11.800
Ja, wie, wie, Moment.

01:09:12.040 --> 01:09:19.410
Check. Server.

01:09:24.400 --> 01:09:24.840
Check.

01:09:26.320 --> 01:09:32.780
Health-Check. Oh, ich bin zu dumm

01:09:32.780 --> 01:09:33.520
in die HA-Proxy.

01:09:35.100 --> 01:09:36.600
Wie macht man denn, wie macht man denn

01:09:36.600 --> 01:09:39.680
Health-Check?

01:09:40.880 --> 01:09:41.800
HA-Proxy

01:09:41.800 --> 01:09:43.940
Check-Intervall. Da muss man

01:09:43.940 --> 01:09:45.060
doch setzen können.

01:09:46.420 --> 01:09:48.200
Stack. Stack-Overflow.

01:09:48.200 --> 01:09:48.380
Ja.

01:09:59.960 --> 01:10:05.240
Default-HA-Proxy-Option. Fallback ist 3.

01:10:05.240 --> 01:10:06.440
Error-Limit.

01:10:07.660 --> 01:10:09.960
Tune Health-Check-Intervall.

01:10:10.440 --> 01:10:13.600
Was? Inter, Faster-Inter, Down-Inter.

01:10:13.920 --> 01:10:14.400
What?

01:10:16.320 --> 01:10:20.620
Inter-Parameter. Setze Intervall between two Health-Checks.

01:10:23.440 --> 01:10:28.900
Milliseconds. Das übertreibt man nicht, Alter.

01:10:29.800 --> 01:10:36.040
In Milliseconds, also eine Sekunde, eine Sekunde reicht

01:10:36.040 --> 01:10:38.180
mir, da muss ich halt 1000 Milliseconds machen.

01:10:48.100 --> 01:10:50.660
Was? Just as with every time-based parameter,

01:10:50.780 --> 01:10:53.800
they can be answered in any other explicit

01:10:53.800 --> 01:10:55.580
you immer. Ah, man kann auch Sekunden

01:10:55.580 --> 01:10:57.720
hinschreiben, okay. Also sprich,

01:10:57.840 --> 01:10:59.360
ich schreibe jetzt da hinten, was denn?

01:10:59.600 --> 01:11:01.920
Inter, was haben wir, 5 Sekunden

01:11:01.920 --> 01:11:02.940
oder wie? Inter.

01:11:09.540 --> 01:11:11.400
Ja, viel besser, viel besser.

01:11:16.770 --> 01:11:17.770
Ja, gut.

01:11:17.990 --> 01:11:23.690
Gefällt mir. Das finde ich

01:11:23.690 --> 01:11:25.510
äußerst nice, wie gut das

01:11:25.510 --> 01:11:34.750
funktioniert. Ne, das ist, das ist

01:11:34.750 --> 01:11:35.870
nicht, das ist ein anderer Hersteller.

01:11:44.740 --> 01:11:46.900
Ist doch jetzt höher als Default, ja.

01:11:47.060 --> 01:11:48.620
Ist es. Will ich auch.

01:11:49.180 --> 01:11:50.660
Ich will es ja auch höher als Default.

01:11:51.260 --> 01:11:52.780
5 Sekunden reicht dicker aus.

01:11:53.520 --> 01:11:54.680
So schnell synchronisieren

01:11:54.680 --> 01:11:55.200
die sich nicht.

01:11:56.500 --> 01:11:57.780
Muss ja nicht so rumspammen.

01:12:00.050 --> 01:12:02.610
Guck mal, das Log ist auch, es eskaliert

01:12:02.610 --> 01:12:03.570
auch komplett, Alter.

01:12:03.570 --> 01:12:03.970
Ähm.

01:12:06.390 --> 01:12:07.550
Guck mal, HA-Proxy

01:12:07.550 --> 01:12:10.980
Log, Log

01:12:10.980 --> 01:12:12.300
Directory, wie kann man,

01:12:15.180 --> 01:12:22.440
ja, was?

01:12:23.600 --> 01:12:25.360
HA-Proxy

01:12:25.360 --> 01:12:27.320
doesn't support

01:12:27.320 --> 01:12:29.320
Logging to Files?

01:12:29.320 --> 01:12:37.490
What? Ach, der kann nur

01:12:37.490 --> 01:12:45.990
syslog. Der kann echt nur

01:12:45.990 --> 01:12:52.950
syslog? Ja, ich mein, ich kann

01:12:52.950 --> 01:12:54.950
den Output in eine Logdatei pipen.

01:12:54.950 --> 01:12:58.710
Ja, das ist mir auch klar.

01:12:58.710 --> 01:13:00.710
Aber schön ist was anderes.

01:13:00.710 --> 01:13:25.680
Also, also

01:13:25.680 --> 01:13:27.680
mein, das, ich mein,

01:13:27.680 --> 01:13:29.680
so schlau, ups, so schlau wär ich

01:13:29.680 --> 01:13:31.680
jetzt auch gewesen.

01:13:31.680 --> 01:13:33.680
Ja.

01:13:33.680 --> 01:13:37.000
So was machen können.

01:13:37.000 --> 01:13:39.000
Guck, jetzt haben wir, haben wir ein Logfile.

01:13:39.000 --> 01:13:43.480
Ganz schön spammiges Logfile.

01:13:43.480 --> 01:13:50.760
Das gefällt mir aber gut.

01:13:50.760 --> 01:13:52.760
Also, Leute, mal ganz im Ernst,

01:13:52.760 --> 01:13:54.760
für so übers Knie gebrochene

01:13:54.760 --> 01:13:56.760
Lösung, ist das doch gar

01:13:56.760 --> 01:13:58.760
net übel. Ich glaub,

01:13:58.760 --> 01:14:00.760
das zeigt doch

01:14:00.760 --> 01:14:02.760
erstmal, dass man keine

01:14:02.760 --> 01:14:04.760
50.000 Euro teure Loadbalancer braucht,

01:14:04.760 --> 01:14:12.750
um sowas zu machen, oder?

01:14:12.750 --> 01:14:14.750
Weil, also ich mein,

01:14:14.750 --> 01:14:16.750
was haben die eigentlich auf ihrer

01:14:16.750 --> 01:14:18.750
krassen Loadbalancer Appliance laufen?

01:14:18.750 --> 01:14:20.750
Dann 60 Zeilen

01:14:20.750 --> 01:14:22.750
Bash-Skript oder was?

01:14:22.750 --> 01:14:24.750
Ein bisschen mehr muss das ja schon sein.

01:14:24.750 --> 01:14:26.750
Ja, okay, sie haben ein schönes

01:14:26.750 --> 01:14:28.750
React-Webinterface gebaut.

01:14:28.750 --> 01:14:30.750
Drumherum.

01:14:30.750 --> 01:14:32.750
Um 30 Zeilen Bash-Skript.

01:14:32.750 --> 01:14:34.750
Ein bisschen advancer wird's

01:14:34.750 --> 01:14:36.750
schon sein. Ja, okay.

01:14:36.750 --> 01:14:38.750
So schön ist es nicht,

01:14:38.750 --> 01:14:40.750
hier, dass man die HAProxy-Konf-Sicht

01:14:40.750 --> 01:14:42.750
rausgribbt und sowas. Aber trotzdem,

01:14:42.750 --> 01:14:44.750
mein, es funktioniert.

01:14:44.750 --> 01:14:48.250
Warum nicht Caddy ohne Nginx?

01:14:48.250 --> 01:14:50.250
Weil man mit HAProxy schön

01:14:50.250 --> 01:14:52.250
rumbasteln kann, was Custom-Checks

01:14:52.250 --> 01:14:59.600
und sowas angeht.

01:14:59.600 --> 01:15:01.600
Loadbalancer is written in Rust blazingly fast.

01:15:01.600 --> 01:15:11.630
Bestimmt, bestimmt.

01:15:11.630 --> 01:15:13.630
Du hast recht, du hast recht.

01:15:13.630 --> 01:15:15.630
Aber die Frage, die ich mir stelle,

01:15:15.630 --> 01:15:20.600
warum?

01:15:20.600 --> 01:15:22.600
Ich mein, das läuft ja auf dem normalen Lino.

01:15:22.600 --> 01:15:24.600
Und selbst, wenn du es im Docker-Container laufen lässt,

01:15:24.600 --> 01:15:26.600
installierst du dir halt Curl.

01:15:26.600 --> 01:15:28.600
Ich mein, und?

01:15:28.600 --> 01:15:30.600
Also,

01:15:30.600 --> 01:15:32.600
ich verstehe, was du meinst.

01:15:32.600 --> 01:15:34.600
Man könnte es super minimalistisch

01:15:34.600 --> 01:15:36.600
machen.

01:15:36.600 --> 01:15:38.600
Man könnte auch, man könnte sich da auch

01:15:38.600 --> 01:15:40.600
irgendwas in Go basteln oder

01:15:40.600 --> 01:15:42.600
in Rust oder in .NET

01:15:42.600 --> 01:15:44.600
oder in Java oder so, was das

01:15:44.600 --> 01:15:46.600
wahrscheinlich

01:15:46.600 --> 01:15:48.600
ähnlich macht.

01:15:48.600 --> 01:15:50.600
Pusht du das? Hab so viel

01:15:50.600 --> 01:15:52.600
verpasst. Ähm, es gibt

01:15:52.600 --> 01:15:54.600
nicht viel zu pushen. Ich hab nen Custom-Health-Check

01:15:54.600 --> 01:15:56.600
für HAProxy gebaut. Das war's.

01:15:56.600 --> 01:15:58.600
Mehr hat er nicht.

01:15:58.600 --> 01:16:00.600
Und ich, also,

01:16:00.600 --> 01:16:02.600
das, was

01:16:02.600 --> 01:16:04.600
der Strafo,

01:16:04.600 --> 01:16:06.600
was Strafo vorhin geschrieben hat,

01:16:06.600 --> 01:16:08.600
das würde ich auch gern nochmal ausprobieren.

01:16:08.600 --> 01:16:10.600
Dass man

01:16:10.600 --> 01:16:12.600
ein Programm nebenbei laufen lässt

01:16:12.600 --> 01:16:14.600
und die,

01:16:14.600 --> 01:16:16.600
das Wait, also was er,

01:16:16.600 --> 01:16:18.600
was er, wann er, welches

01:16:18.600 --> 01:16:20.600
Backend bevorzugt.

01:16:20.600 --> 01:16:22.600
Auf der anderen Seite, ich glaube

01:16:22.600 --> 01:16:24.600
fast, dass es besser wäre,

01:16:24.600 --> 01:16:26.600
so, also, dass es besser

01:16:26.600 --> 01:16:28.600
ist, wie

01:16:28.600 --> 01:16:32.490
ich das mache, weil

01:16:32.490 --> 01:16:34.490
der soll ruhig

01:16:34.490 --> 01:16:36.490
die Verbindung abbrechen.

01:16:36.490 --> 01:16:38.490
Wenn er nämlich ne langlaufende TCP-Verbindung

01:16:38.490 --> 01:16:40.490
hat und auf

01:16:40.490 --> 01:16:42.490
alten outdateden Server gelandet

01:16:42.490 --> 01:16:44.490
ist, dann wird die ja quasi nie

01:16:44.490 --> 01:16:46.490
abgebaut. Dann ist besser,

01:16:46.490 --> 01:16:48.490
die wird gekappt und die

01:16:48.490 --> 01:16:50.490
andere Seite verbindet sich neu.

01:16:50.490 --> 01:16:57.000
Aber eine Sache, die man

01:16:57.000 --> 01:16:59.000
noch einbauen müsste hier,

01:16:59.000 --> 01:17:01.000
ja, eine Sache sollte man noch einbauen,

01:17:01.000 --> 01:17:03.000
nicht,

01:17:03.000 --> 01:17:05.000
sag ich oft, nicht zu oft

01:17:05.000 --> 01:17:07.000
switchen.

01:17:07.000 --> 01:17:09.000
Ja, das wäre tatsächlich ne Sache, die man

01:17:09.000 --> 01:17:11.000
noch einbauen müsste, weil

01:17:11.000 --> 01:17:13.000
stellt euch mal vor,

01:17:13.000 --> 01:17:15.000
beide Server sind ganz

01:17:15.000 --> 01:17:20.750
knapp, sind ganz

01:17:20.750 --> 01:17:22.750
knapp, gleich auf

01:17:22.750 --> 01:17:24.750
und switchen

01:17:24.750 --> 01:17:26.750
quasi im Sekundentakt,

01:17:26.750 --> 01:17:28.750
dann würde der Health-Check

01:17:28.750 --> 01:17:30.750
permanent die Verbindung, das wäre dann

01:17:30.750 --> 01:17:36.300
eher nicht so geil, ja.

01:17:36.300 --> 01:17:38.300
Das ist ja gerade das tolle an der Blockchain,

01:17:38.300 --> 01:17:40.300
da geht nichts verloren. Im Zweifelsfall

01:17:40.300 --> 01:17:45.080
synchst du und dann ist er da.

01:17:45.080 --> 01:17:47.080
Alle anderen Nodes,

01:17:47.080 --> 01:17:49.080
von denen du synchst, haben die ja.

01:17:49.080 --> 01:17:51.080
Also, nicht zu oft

01:17:51.080 --> 01:17:53.080
switchen ist auf jeden Fall, wäre

01:17:53.080 --> 01:17:55.080
auf jeden Fall nicht verkehrt. Also, man

01:17:55.080 --> 01:17:57.080
könnte, man könnte zum Beispiel sich noch

01:17:57.080 --> 01:17:59.080
merken, wann das letzte Mal

01:17:59.080 --> 01:18:03.610
geswitcht wurde und

01:18:03.610 --> 01:18:05.610
für fünf Minuten nicht mal

01:18:05.610 --> 01:18:07.610
switchen so. Das, das, das könnte

01:18:07.610 --> 01:18:09.610
man machen, wobei er dann auch nicht

01:18:09.610 --> 01:18:11.610
erkennt, ob das down ist. Da muss

01:18:11.610 --> 01:18:13.610
ich mir nochmal Gedanken drüber machen,

01:18:13.610 --> 01:18:19.040
aber, ja, sagen wir mal so, als

01:18:19.040 --> 01:18:21.040
Proof of Concept finde ich das eigentlich ganz gut.

01:18:21.040 --> 01:18:26.330
Du kannst ja einen zweistufigen

01:18:26.330 --> 01:18:28.330
Check einbauen, ist Port offen? Ja, nein.

01:18:28.330 --> 01:18:34.270
Ach so, du meinst, dass ich

01:18:34.270 --> 01:18:36.270
prinzipiell abfackeln kann,

01:18:36.270 --> 01:18:38.270
falls der, falls

01:18:38.270 --> 01:18:40.270
ich unter fünf Minuten bin

01:18:40.270 --> 01:18:42.270
und der wirklich ausfällt, dass er

01:18:42.270 --> 01:18:44.270
dann doch auf den geht, der noch da ist.

01:18:44.270 --> 01:18:56.800
Ja. Ja,

01:18:56.800 --> 01:19:02.990
das, das könnte man machen.

01:19:02.990 --> 01:19:04.990
Das muss ich mir nochmal durch den Kopf gehen lassen,

01:19:04.990 --> 01:19:11.560
wie ich das am besten mache. Aber

01:19:11.560 --> 01:19:20.960
das, das gefällt mir erstmal.

01:19:20.960 --> 01:19:22.960
Und wisst ihr, was das coole ist? Wenn man jetzt,

01:19:22.960 --> 01:19:24.960
wenn man irgendwie

01:19:24.960 --> 01:19:26.960
fünf Server hat oder so,

01:19:26.960 --> 01:19:28.960
könnte man, könnte man theoretisch auch sagen,

01:19:28.960 --> 01:19:34.510
aber wie gesagt, mit dem Lua,

01:19:34.510 --> 01:19:36.510
das finde ich richtig cool mit dem

01:19:36.510 --> 01:19:38.510
Lua Plugin, ja, ja, ja.

01:19:38.510 --> 01:19:42.200
Ich würde das wahrscheinlich in Lua auch

01:19:42.200 --> 01:19:44.200
hinkriegen. Ich meine, meine Terminal

01:19:44.200 --> 01:19:46.200
Config ist in Lua, ja.

01:19:46.200 --> 01:19:48.200
Ist zwar nicht, ist zwar nicht die,

01:19:48.200 --> 01:19:50.200
ist zwar nicht das schönste Lua, aber

01:19:50.200 --> 01:19:52.200
meine Terminal Config ist in Lua.

01:19:52.200 --> 01:19:54.200
So, so,

01:19:54.200 --> 01:19:56.200
so ein bisschen was in Lua kriege ich zur Not hin.

01:19:56.200 --> 01:20:01.500
Selbst, selbst

01:20:01.500 --> 01:20:03.500
irgendein Lua Plugin gebaut.

01:20:03.500 --> 01:20:10.720
Ja, da hatten wir hier den,

01:20:10.720 --> 01:20:12.720
hier das, hier das Beispiel.

01:20:12.720 --> 01:20:14.720
Also das Beispiel hier von denen ist ziemlich

01:20:14.720 --> 01:20:16.720
gut. Hier, Backend with

01:20:16.720 --> 01:20:18.720
Least, Least Connection. Hier müsste ich halt

01:20:18.720 --> 01:20:20.720
in Lua den,

01:20:20.720 --> 01:20:26.140
genau, hier kriegst du auch alle

01:20:26.140 --> 01:20:28.140
Backend, Backend Namen und Server Namen.

01:20:28.140 --> 01:20:30.140
Und hier müsste ich dann den

01:20:30.140 --> 01:20:32.140
AP, die, die, die AP Abfrage

01:20:32.140 --> 01:20:34.140
drin machen.

01:20:34.140 --> 01:20:36.140
AProxy Lua.

01:20:36.140 --> 01:20:58.970
Kann man da Curl benutzen drin?

01:20:58.970 --> 01:21:00.970
Dynamic Backend Selection

01:21:00.970 --> 01:21:02.970
with Lua Script. Oh, jetzt,

01:21:02.970 --> 01:21:04.970
jetzt aber advanced

01:21:04.970 --> 01:21:23.070
hier. Local

01:21:23.070 --> 01:21:25.070
Function Pick Backend.

01:21:25.070 --> 01:21:27.070
Ja,

01:21:27.070 --> 01:21:32.940
genau, sowas.

01:21:32.940 --> 01:21:34.940
If Backend Name Master, then

01:21:34.940 --> 01:21:36.940
Filter out, Build in Backend

01:21:36.940 --> 01:21:41.600
Name. Ja.

01:21:41.600 --> 01:21:47.850
Ja, das ist natürlich cool. Dann hast

01:21:47.850 --> 01:21:49.850
du, dann hast du Zugriff auf den

01:21:49.850 --> 01:21:51.850
internen Status halt von, von

01:21:51.850 --> 01:22:01.690
HA-Proxy. Ja, das

01:22:01.690 --> 01:22:03.690
gefällt mir. Das, das, das bookmarke ich

01:22:03.690 --> 01:22:05.690
mir mal.

01:22:05.690 --> 01:22:15.920
Das finde ich nice.

01:22:15.920 --> 01:22:17.920
Und, wo, ach hier.

01:22:17.920 --> 01:22:19.920
TCP Connect.

01:22:19.920 --> 01:22:21.920
Moment, Moment.

01:22:21.920 --> 01:22:23.920
Der macht, der macht HTTP

01:22:23.920 --> 01:22:25.920
von Hand, sehe ich das richtig

01:22:25.920 --> 01:22:31.280
in seinem, oje.

01:22:31.280 --> 01:22:33.280
Und

01:22:33.280 --> 01:22:35.280
JSON Parser dann auch von Hand, oder wie?

01:22:37.280 --> 01:22:39.280
Kann man da irgendwelche Lua Libs laden

01:22:39.280 --> 01:22:43.480
vielleicht?

01:22:43.480 --> 01:22:45.480
Lua HA-Proxy

01:22:45.480 --> 01:23:11.520
JSON Parser. Da kann man

01:23:11.520 --> 01:23:13.520
wahrscheinlich auch Curl aufrufen, ja.

01:23:13.520 --> 01:23:23.740
Was?

01:23:23.740 --> 01:23:25.740
Lua HTTP Client

01:23:25.740 --> 01:23:27.740
Library for HA-Proxy. Alter,

01:23:27.740 --> 01:23:29.740
was es nicht alles gibt.

01:23:29.740 --> 01:23:33.310
Mann. Ich geb dir Header,

01:23:33.310 --> 01:23:35.310
Alter. Was es

01:23:35.310 --> 01:23:37.310
nicht alles gibt, Alter. Lua, Lua

01:23:37.310 --> 01:23:39.310
HA-Proxy

01:23:39.310 --> 01:23:43.580
Libraries. Meine Güte.

01:23:43.580 --> 01:23:45.580
Ja, also das ist, das ist ne gute

01:23:45.580 --> 01:23:47.580
Idee, das da drüber

01:23:47.580 --> 01:23:49.580
zu machen. Das wäre äußerst

01:23:49.580 --> 01:23:51.580
Business Enterprise.

01:23:51.580 --> 01:23:56.620
Macht er das hier mit Wait?

01:23:56.620 --> 01:23:58.620
Oder wie macht er das eigentlich?

01:23:58.620 --> 01:24:00.620
Nee, der setzt nicht die, der

01:24:00.620 --> 01:24:02.620
macht das, was ich mache.

01:24:02.620 --> 01:24:04.620
Nur mit Lua.

01:24:04.620 --> 01:24:19.070
Ja, weil wenn er das gleich mit Lua macht, kann ich's auch nicht machen.

01:24:19.070 --> 01:24:24.360
Wenn er mit dem Bash-Script macht.

01:24:24.360 --> 01:24:26.360
Also, ich werd mir nochmal Gedanken drüber machen.

01:24:28.360 --> 01:24:30.360
Wie ich das, wie ich das am besten bauen kann.

01:24:30.360 --> 01:24:32.360
Noch, dass der nicht, dass der

01:24:32.360 --> 01:24:34.360
nicht zu oft, zu oft

01:24:34.360 --> 01:24:47.850
switcht. Und dann

01:24:47.850 --> 01:24:49.850
würde ich sagen, Chat,

01:24:49.850 --> 01:24:51.850
das war heute kurz und knackig,

01:24:51.850 --> 01:24:53.850
aber wir haben was auf die Reihe gekriegt.

01:24:53.850 --> 01:24:55.850
Ich muss jeden 20 Minuten pennen.

01:24:55.850 --> 01:25:00.700
Dann geh ich jetzt schon auf.

01:25:00.700 --> 01:25:02.700
Und wir sehen uns morgen oder die Tage.

01:25:02.700 --> 01:25:04.700
Macht's gut, bis denn. See you.
